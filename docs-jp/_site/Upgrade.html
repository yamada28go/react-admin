<!DOCTYPE html>
<html lang="en-US">
    <head>
        <title>React-admin - Upgrading to v4</title>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <meta name="description" content="" />
        <meta name="HandheldFriendly" content="true" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <link
            rel="canonical"
            href="/Upgrade.html"
        />
        <link
            rel="stylesheet"
            href="/css/materialize.min.css"
        />
        <link
            rel="stylesheet"
            href="/css/style-v19.css"
        />
        <link rel="stylesheet" href="/css/syntax.css" />
        <link rel="stylesheet" href="/css/prism.css" />
        <link rel="stylesheet" href="/css/tocbot.css" />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/icon?family=Material+Icons"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.css"
            integrity="sha512-2kqK5bWDwdrluTn6Wkj+jgiwyzvAHLirVp08Kz7kN5I8PWQ0tUtEMxfhyWDCrnws91BJ9PfrUy6ImfA7Qb22TA=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <link
            rel="stylesheet"
            href="/css/docsearch.css"
        />
        <!-- Newsletter form -->
        <style>
            @font-face {
                font-display: block;
                font-family: Roboto;
                src: url(https://assets.brevo.com/font/Roboto/Latin/normal/normal/7529907e9eaf8ebb5220c5f9850e3811.woff2)
                        format('woff2'),
                    url(https://assets.brevo.com/font/Roboto/Latin/normal/normal/25c678feafdc175a70922a116c9be3e7.woff)
                        format('woff');
            }

            @font-face {
                font-display: fallback;
                font-family: Roboto;
                font-weight: 600;
                src: url(https://assets.brevo.com/font/Roboto/Latin/medium/normal/6e9caeeafb1f3491be3e32744bc30440.woff2)
                        format('woff2'),
                    url(https://assets.brevo.com/font/Roboto/Latin/medium/normal/71501f0d8d5aa95960f6475d5487d4c2.woff)
                        format('woff');
            }

            @font-face {
                font-display: fallback;
                font-family: Roboto;
                font-weight: 700;
                src: url(https://assets.brevo.com/font/Roboto/Latin/bold/normal/3ef7cf158f310cf752d5ad08cd0e7e60.woff2)
                        format('woff2'),
                    url(https://assets.brevo.com/font/Roboto/Latin/bold/normal/ece3a1d82f18b60bcce0211725c476aa.woff)
                        format('woff');
            }

            #sib-container input:-ms-input-placeholder {
                text-align: left;
                font-family: 'Helvetica', sans-serif;
                color: #c0ccda;
            }

            #sib-container input::placeholder {
                text-align: left;
                font-family: 'Helvetica', sans-serif;
                color: #c0ccda;
            }

            #sib-container textarea::placeholder {
                text-align: left;
                font-family: 'Helvetica', sans-serif;
                color: #c0ccda;
            }
        </style>
        <link
            rel="stylesheet"
            href="/css/newsletter.css"
        />
    </head>

    <body>
        <header>
            <nav>
    <a href="#" data-target="slide-out" class="sidenav-trigger">
        <i class="material-icons">&#xe5d2;</i>
    </a>
    <div class="nav-wrapper">
        <div class="left react-admin-logo">
            <a href=""> <svg version="1.0" x="0px" y="0px" preserveAspectRatio="xMidYMid meet" viewBox="0 0 130 130" >
<style type="text/css">
	:root{
		--color: #ffffff;
	}
	.st0{opacity:0.3;}
	.st2{opacity:0.6;}
	.st1{fill: var(--color);}
</style>
<g id="layer3Fill" class="st0">
	<polygon class="st1" points="67.4,117.7 81.3,125.7 88.7,112.9 75.7,112.9 	"/>
	<polygon class="st1" points="12.3,67.5 4.4,81.2 17.2,88.6 17.2,76 	"/>
	<polygon class="st1" points="62.6,12.3 48.8,4.3 41.4,17.1 54.2,17.1 	"/>
	<polygon class="st1" points="117.7,62.6 125.7,48.8 112.8,41.3 112.8,54.1 	"/>
</g>
<g id="layer3Border" class="st2">
	<path class="st1" d="M39.2,17.1c0.5,0,1.7,0,2.2,0l7.4-12.8l13.8,8l1.9-1.1L48.1,1.7L39.2,17.1z"/>
	<path class="st1" d="M112.8,39.1c0,0.5,0,1.7,0,2.2l12.9,7.5l-8,13.8c0.3,0.5,0.8,1.5,1.1,2l9.5-16.5L112.8,39.1z"/>
	<path class="st1" d="M88.7,112.9l-7.4,12.8l-13.9-8l-1.9,1.1l16.5,9.5l8.9-15.4C90.4,112.9,89.2,112.9,88.7,112.9z"/>
	<path class="st1" d="M12.3,67.5c-0.3-0.5-0.8-1.4-1.1-1.9L1.8,82l15.4,8.9c0-0.6,0-1.7,0-2.3L4.4,81.2L12.3,67.5z"/>
</g>
<g id="layer2Fill" class="st2">
	<polygon class="st1" points="41.9,112.9 48.9,125.1 70.1,112.9 	"/>
	<polygon class="st1" points="17.2,70.1 17.2,41.9 5,49 	"/>
	<polygon class="st1" points="60.1,17.1 88.1,17.1 81.1,5 	"/>
	<polygon class="st1" points="112.8,60 112.8,88.2 125,81.1 	"/>
</g>
<g id="layer2Border">
	<polygon class="st1" points="17.2,76 17.2,70.1 5,49 17.2,41.9 17.2,38.5 1,47.9 	"/>
	<path class="st1" d="M54.2,17.1h5.9c0,0,19.9-11.5,21-12.1l7,12.1c0.8,0,2.5,0,3.3,0L82.1,1L54.2,17.1z"/>
	<polygon class="st1" points="112.8,54.1 112.8,60 125,81.1 112.8,88.2 112.8,91.5 129,82.2 	"/>
	<path class="st1" d="M48.9,125.1l-7-12.2c-0.8,0-2.6,0-3.4,0l9.3,16.1c6.7-3.9,21.4-12.3,27.9-16.1c-1.4,0-5.6,0-5.6,0L48.9,125.1z
		"/>
</g>
<path id="raBorder" class="st1" d="M17,17v96h96V17H17z M108,108H22V22h86V108z"/>
<g id="ra">
	<path id="aLetter" class="st1" d="M96.1,55.4c-0.7-1.9-2-3.2-3.7-4c-1.9-0.8-4.6-1.2-8.2-1.2c-4.2,0-7.9,0.3-11.1,1v4.2
		c1.2-0.2,2.7-0.4,4.7-0.5c1.9-0.1,3.5-0.2,4.8-0.2c2.9,0,5,0.2,6.2,0.5c1.3,0.4,2.1,1.2,2.5,2.3c0.5,1.2,0.7,3.2,0.7,6.1V66
		c-6.2-0.2-9.9-0.3-11.1-0.3c-2.5,0-4.5,0.3-5.9,1c-1.4,0.7-2.3,1.8-2.9,3.2c-0.6,1.4-0.9,3.5-0.9,6.2c0,3.9,0.9,6.5,2.4,8
		c1.7,1.5,4.2,2.1,7.8,2.1c2.4,0,4.6-0.4,6.4-1.1c1.9-0.7,3.2-2.1,4-4.3h0.3l0.3,4.9h4.7v-22C97.1,60,96.8,57.3,96.1,55.4z M92,71.6
		c0,2.9-0.4,5.4-1.3,7.1c-0.6,1.2-1.6,2-2.7,2.3c-1.3,0.4-2.8,0.6-4.7,0.8c-2,0-3.4-0.2-4.4-0.5c-0.9-0.4-1.6-1-2-1.8
		c-0.4-0.8-0.6-2.1-0.6-3.8s0.2-3,0.5-3.9c0.3-0.9,0.9-1.5,1.7-1.8s2.1-0.5,3.7-0.5H92V71.6z"/>
	<path id="rLetter" class="st1" d="M62.4,61.2c0.9-2.2,1.3-5.1,1.3-8.5c0-3.1-0.3-5.7-0.8-7.6c-0.5-2-1.7-3.5-3.4-4.7
		c-1.8-1.2-4.4-1.8-7.9-1.8H33.5v47.1H39V67h11.9h1.2l6.5,18.8h5.9L57.3,66C59.9,65,61.6,63.4,62.4,61.2z M55.4,61.2
		c-1.3,0.7-3.1,1-5.6,1H39V43.5h11.2c2.4,0,4.2,0.3,5.4,1c1.2,0.7,2,1.6,2.2,2.8c0.3,1.3,0.5,3,0.5,5.5c0,2.3-0.2,4.2-0.6,5.5
		C57.3,59.5,56.6,60.5,55.4,61.2z"/>
</g>
</svg>
 </a>
        </div>
        <div class="left">
            <div id="docsearch" class="center"></div>
        </div>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li class="active">
                <a href="/documentation.html">Documentation</a>
            </li>
            <li>
                <a href="/Demos.html">Demos</a>
            </li>
            <li>
                <a href="https://marmelab.com/en/blog/#react-admin">Blog</a>
            </li>
            <li>
                <a
                    href="https://marmelab.com/ra-enterprise/"
                    style="color: #f0c070"
                    >Enterprise Edition</a
                >
            </li>
            <li>
                <a
                    href="https://github.com/marmelab/react-admin"
                    title="GitHub"
                >
                    <svg
                        viewBox="0 0 256 250"
                        preserveAspectRatio="xMidYMid"
                        style="
                            height: 20px;
                            vertical-align: middle;
                            fill: #ffffff;
                        "
                    >
                        <path
                            d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403z"
                        ></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://discord.gg/GeZF9sqh3N" title="Discord">
                    <svg
                        height="25px"
                        width="25px"
                        viewBox="0 -28.5 256 256"
                        preserveAspectRatio="xMidYMid"
                        style="
                            height: 20px;
                            vertical-align: middle;
                            margin-right: 10px;
                            fill: #ffffff;
                        "
                    >
                        <path
                            d="M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z"
                        ></path>
                    </svg>
                </a>
            </li>
        </ul>
    </div>
</nav>

            <ul id="slide-out" class="sidenav sidenav-fixed">
                <li class="logo">
                    <a href=""
                        ><img src="/assets/logo_white.png"
                    /></a>
                </li>
                <li class="version">
<a class="dropdown-trigger" href="#" data-target="versions">
    
    
    
    <svg class="caret" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
        <path d="M7 10l5 5 5-5z"></path>
        <path d="M0 0h24v24H0z" fill="none"></path>
    </svg>
</a>
<ul id="versions" class="dropdown-content">
    
</ul>
</li>
                <a class="center-align switch" style="display:block;margin-bottom: 1em" name="beginner-mode" title="Hide the sections concerning advanced usage to navigate more easily in the documentation">
<label>
  <input type="checkbox" name="beginner-mode-trigger" id="beginner-mode-trigger" />
  <span class="lever"></span>
  Beginner Mode
</label>
</a>

<ul><div>Getting Started</div>
  <li  class="beginner" ><a class="nav-link" href="./Tutorial.html">Tutorial</a></li>
  <li  class="beginner" ><a class="nav-link" href="./Features.html">Features</a></li>
  <li ><a class="nav-link" href="./Architecture.html">Key concepts</a></li>
  <li><a class="nav-link external" href="https://github.com/marmelab/react-admin/releases" target="_blank">What's new?</a></li>
  <li  class="beginner" ><a class="nav-link" href="./CreateReactAdmin.html">Create React Admin</a></li>
  <li  class="beginner" ><a class="nav-link" href="./Vite.html">Vite</a></li>
  <li ><a class="nav-link" href="./NextJs.html">Next.js</a></li>
  <li ><a class="nav-link" href="./Remix.html">Remix</a></li>
  <li ><a class="nav-link" href="./CreateReactApp.html">Create React App</a></li>
  <li  class="beginner" ><a class="nav-link" href="./Community.html">Community</a></li>
  <li  class="active" ><a class="nav-link" href="./Upgrade.html">Upgrading to v4</a></li>
</ul>

<ul><div>App Configuration</div>
  <li  class="beginner" ><a class="nav-link" href="./Admin.html"><code>&lt;Admin&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./Resource.html"><code>&lt;Resource&gt;</code></a></li>
  <li ><a class="nav-link" href="./CustomRoutes.html"><code>&lt;CustomRoutes&gt;</code></a></li>
</ul>

<ul><div>Data Fetching</div>
  <li  class="beginner" ><a class="nav-link" href="./DataProviders.html">Introduction</a></li>
  <li  class="beginner" ><a class="nav-link" href="./DataProviderList.html">Supported backends</a></li>
  <li ><a class="nav-link" href="./DataProviderWriting.html">Writing A Data Provider</a></li>
  <li  class="beginner" ><a class="nav-link" href="./Actions.html">Querying the API</a></li>
  <li ><a class="nav-link" href="./DataProviderLive.html">Real-time Updates &amp; Locks<img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useDataProvider.html"><code>useDataProvider</code></a></li>
  <li ><a class="nav-link" href="./useGetList.html"><code>useGetList</code></a></li>
  <li ><a class="nav-link" href="./useInfiniteGetList.html"><code>useInfiniteGetList</code></a></li>
  <li ><a class="nav-link" href="./useGetOne.html"><code>useGetOne</code></a></li>
  <li ><a class="nav-link" href="./useGetMany.html"><code>useGetMany</code></a></li>
  <li ><a class="nav-link" href="./useGetManyReference.html"><code>useGetManyReference</code></a></li>
  <li ><a class="nav-link" href="./useCreate.html"><code>useCreate</code></a></li>
  <li ><a class="nav-link" href="./useUpdate.html"><code>useUpdate</code></a></li>
  <li ><a class="nav-link" href="./useUpdateMany.html"><code>useUpdateMany</code></a></li>
  <li ><a class="nav-link" href="./useDelete.html"><code>useDelete</code></a></li>
  <li ><a class="nav-link" href="./useDeleteMany.html"><code>useDeleteMany</code></a></li>
  <li ><a class="nav-link" href="./useGetTree.html"><code>useGetTree</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./withLifecycleCallbacks.html"><code>withLifecycleCallbacks</code></a></li>
  <li ><a class="nav-link" href="./fetchJson.html"><code>fetchJson</code></a></li>
</ul>

<ul><div>Security</div>
  <li  class="beginner" ><a class="nav-link" href="./Authentication.html">Introduction</a></li>
  <li  class="beginner" ><a class="nav-link" href="./AuthProviderList.html">Supported backends</a></li>
  <li  class="beginner" ><a class="nav-link" href="./AuthProviderWriting.html">Writing An Auth Provider</a></li>
  <li ><a class="nav-link" href="./Permissions.html">Permissions</a></li>
  <li ><a class="nav-link" href="./AuthRBAC.html">RBAC<img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./Authenticated.html"><code>&lt;Authenticated&gt;</code></a></li>
  <li ><a class="nav-link" href="./IfCanAccess.html"><code>&lt;IfCanAccess&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./WithPermissions.html"><code>&lt;WithPermissions&gt;</code></a></li>
  <li ><a class="nav-link" href="./useAuthProvider.html"><code>useAuthProvider</code></a></li>
  <li ><a class="nav-link" href="./useAuthenticated.html"><code>useAuthenticated</code></a></li>
  <li ><a class="nav-link" href="./useAuthState.html"><code>useAuthState</code></a></li>
  <li ><a class="nav-link" href="./useGetIdentity.html"><code>useGetIdentity</code></a></li>
  <li ><a class="nav-link" href="./useLogin.html"><code>useLogin</code></a></li>
  <li ><a class="nav-link" href="./useLogout.html"><code>useLogout</code></a></li>
  <li ><a class="nav-link" href="./usePermissions.html"><code>usePermissions</code></a></li>
  <li ><a class="nav-link" href="./useCanAccess.html"><code>useCanAccess</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./canAccess.html"><code>canAccess</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./addRefreshAuthToAuthProvider.html"><code>addRefreshAuthToAuthProvider</code></a></li>
  <li ><a class="nav-link" href="./addRefreshAuthToDataProvider.html"><code>addRefreshAuthToDataProvider</code></a></li>
</ul>

<ul><div>List Page</div>
  <li  class="beginner" ><a class="nav-link" href="./ListTutorial.html">Introduction</a></li>
  <li  class="beginner" ><a class="nav-link" href="./FilteringTutorial.html">Filtering The List</a></li>
  <li  class="beginner" ><a class="nav-link" href="./List.html"><code>&lt;List&gt;</code></a></li>
  <li ><a class="nav-link" href="./ListBase.html"><code>&lt;ListBase&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./ListGuesser.html"><code>&lt;ListGuesser&gt;</code></a></li>
  <li ><a class="nav-link" href="./InfiniteList.html"><code>&lt;InfiniteList&gt;</code></a></li>
  <li ><a class="nav-link" href="./TreeWithDetails.html"><code>&lt;TreeWithDetails&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li  class="beginner" ><a class="nav-link" href="./Datagrid.html"><code>&lt;Datagrid&gt;</code></a></li>
  <li ><a class="nav-link" href="./DatagridAG.html"><code>&lt;DatagridAG&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SimpleList.html"><code>&lt;SimpleList&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SingleFieldList.html"><code>&lt;SingleFieldList&gt;</code></a></li>
  <li ><a class="nav-link" href="./EditableDatagrid.html"><code>&lt;EditableDatagrid&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./Calendar.html"><code>&lt;Calendar&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./FilterButton.html"><code>&lt;FilterButton&gt;</code></a></li>
  <li ><a class="nav-link" href="./FilterList.html"><code>&lt;FilterList&gt;</code></a></li>
  <li ><a class="nav-link" href="./FilterLiveSearch.html"><code>&lt;FilterLiveSearch&gt;</code></a></li>
  <li ><a class="nav-link" href="./SavedQueriesList.html"><code>&lt;SavedQueriesList&gt;</code></a></li>
  <li ><a class="nav-link" href="./StackedFilters.html"><code>&lt;StackedFilters&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./Pagination.html"><code>&lt;Pagination&gt;</code></a></li>
  <li ><a class="nav-link" href="./SortButton.html"><code>&lt;SortButton&gt;</code></a></li>
  <li ><a class="nav-link" href="./SelectColumnsButton.html"><code>&lt;SelectColumnsButton&gt;</code></a></li>
  <li ><a class="nav-link" href="./Count.html"><code>&lt;Count&gt;</code></a></li>
  <li ><a class="nav-link" href="./WithListContext.html"><code>&lt;WithListContext&gt;</code></a></li>
  <li ><a class="nav-link" href="./useListContext.html"><code>useListContext</code></a></li>
  <li ><a class="nav-link" href="./useList.html"><code>useList</code></a></li>
  <li ><a class="nav-link" href="./useListController.html"><code>useListController</code></a></li>
  <li ><a class="nav-link" href="./useUnselect.html"><code>useUnselect</code></a></li>
  <li ><a class="nav-link" href="./useUnselectAll.html"><code>useUnselectAll</code></a></li>
</ul>

<ul><div>Creation & Edition Pages</div>
  <li  class="beginner" ><a class="nav-link" href="./EditTutorial.html">Introduction</a></li>
  <li  class="beginner" ><a class="nav-link" href="./Validation.html">Form Validation</a></li>
  <li  class="beginner" ><a class="nav-link" href="./Create.html"><code>&lt;Create&gt;</code></a></li>
  <li ><a class="nav-link" href="./CreateBase.html"><code>&lt;CreateBase&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./Edit.html"><code>&lt;Edit&gt;</code></a></li>
  <li ><a class="nav-link" href="./EditBase.html"><code>&lt;EditBase&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./EditGuesser.html"><code>&lt;EditGuesser&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SimpleForm.html"><code>&lt;SimpleForm&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./TabbedForm.html"><code>&lt;TabbedForm&gt;</code></a></li>
  <li ><a class="nav-link" href="./Form.html"><code>&lt;Form&gt;</code></a></li>
  <li ><a class="nav-link" href="./LongForm.html"><code>&lt;LongForm&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./AccordionForm.html"><code>&lt;AccordionForm&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./WizardForm.html"><code>&lt;WizardForm&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./EditDialog.html"><code>&lt;EditDialog&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./EditInDialogButton.html"><code>&lt;EditInDialogButton&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./CreateDialog.html"><code>&lt;CreateDialog&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./CreateInDialogButton.html"><code>&lt;CreateInDialogButton&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./JsonSchemaForm.html"><code>&lt;JsonSchemaForm&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./Toolbar.html"><code>&lt;Toolbar&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SaveButton.html"><code>&lt;SaveButton&gt;</code></a></li>
  <li ><a class="nav-link" href="./AutoSave.html"><code>&lt;AutoSave&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useCreateContext.html"><code>useCreateContext</code></a></li>
  <li ><a class="nav-link" href="./useCreateController.html"><code>useCreateController</code></a></li>
  <li ><a class="nav-link" href="./useEditContext.html"><code>useEditContext</code></a></li>
  <li ><a class="nav-link" href="./useEditController.html"><code>useEditController</code></a></li>
  <li ><a class="nav-link" href="./useSaveContext.html"><code>useSaveContext</code></a></li>
  <li ><a class="nav-link" href="./useRegisterMutationMiddleware.html"><code>useRegisterMutationMiddleware</code></a></li>
  <li ><a class="nav-link" href="./useUnique.html"><code>useUnique</code></a></li>
</ul>

<ul><div>Show Page</div>
  <li  class="beginner" ><a class="nav-link" href="./ShowTutorial.html">Introduction</a></li>
  <li  class="beginner" ><a class="nav-link" href="./Show.html"><code>&lt;Show&gt;</code></a></li>
  <li ><a class="nav-link" href="./ShowBase.html"><code>&lt;ShowBase&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./ShowGuesser.html"><code>&lt;ShowGuesser&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SimpleShowLayout.html"><code>&lt;SimpleShowLayout&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./TabbedShowLayout.html"><code>&lt;TabbedShowLayout&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./Labeled.html"><code>&lt;Labeled&gt;</code></a></li>
  <li ><a class="nav-link" href="./ShowInDialogButton.html"><code>&lt;ShowInDialogButton&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useShowContext.html"><code>useShowContext</code></a></li>
  <li ><a class="nav-link" href="./useShowController.html"><code>useShowController</code></a></li>
</ul>

<ul><div>Common</div>
  <li  class="beginner" ><a class="nav-link" href="./WithRecord.html"><code>&lt;WithRecord&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./useRecordContext.html"><code>useRecordContext</code></a></li>
  <li ><a class="nav-link" href="./useGetRecordId.html"><code>useGetRecordId</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./useNotify.html"><code>useNotify</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./useRedirect.html"><code>useRedirect</code></a></li>
  <li ><a class="nav-link" href="./useRefresh.html"><code>useRefresh</code></a></li>
</ul>

<ul><div>Fields</div>
  <li  class="beginner" ><a class="nav-link" href="./Fields.html">Introduction</a></li>
  <li ><a class="nav-link" href="./FieldsForRelationships.html">Fields for Relationships</a></li>
  <li  class="beginner" ><a class="nav-link" href="./ArrayField.html"><code>&lt;ArrayField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./BooleanField.html"><code>&lt;BooleanField&gt;</code></a></li>
  <li ><a class="nav-link" href="./ChipField.html"><code>&lt;ChipField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./DateField.html"><code>&lt;DateField&gt;</code></a></li>
  <li ><a class="nav-link" href="./EmailField.html"><code>&lt;EmailField&gt;</code></a></li>
  <li ><a class="nav-link" href="./FileField.html"><code>&lt;FileField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./FunctionField.html"><code>&lt;FunctionField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./ImageField.html"><code>&lt;ImageField&gt;</code></a></li>
  <li ><a class="nav-link" href="./MarkdownField.html"><code>&lt;MarkdownField&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li  class="beginner" ><a class="nav-link" href="./NumberField.html"><code>&lt;NumberField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./ReferenceField.html"><code>&lt;ReferenceField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./ReferenceArrayField.html"><code>&lt;ReferenceArrayField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./ReferenceManyField.html"><code>&lt;ReferenceManyField&gt;</code></a></li>
  <li ><a class="nav-link" href="./ReferenceManyCount.html"><code>&lt;ReferenceManyCount&gt;</code></a></li>
  <li ><a class="nav-link" href="./ReferenceManyToManyField.html"><code>&lt;ReferenceManyToManyField&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./ReferenceOneField.html"><code>&lt;ReferenceOneField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./RichTextField.html"><code>&lt;RichTextField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SelectField.html"><code>&lt;SelectField&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./TextField.html"><code>&lt;TextField&gt;</code></a></li>
  <li ><a class="nav-link" href="./TranslatableFields.html"><code>&lt;TranslatableFields&gt;</code></a></li>
  <li ><a class="nav-link" href="./UrlField.html"><code>&lt;UrlField&gt;</code></a></li>
  <li ><a class="nav-link" href="./WrapperField.html"><code>&lt;WrapperField&gt;</code></a></li>
</ul>

<ul><div>Inputs</div>
  <li  class="beginner" ><a class="nav-link" href="./Inputs.html">Introduction</a></li>
  <li  class="beginner" ><a class="nav-link" href="./ArrayInput.html"><code>&lt;ArrayInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./AutocompleteInput.html"><code>&lt;AutocompleteInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./AutocompleteArrayInput.html"><code>&lt;AutocompleteArrayInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./BooleanInput.html"><code>&lt;BooleanInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./CheckboxGroupInput.html"><code>&lt;CheckboxGroupInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./DateInput.html"><code>&lt;DateInput></code></a></li>
  <li ><a class="nav-link" href="./DateTimeInput.html"><code>&lt;DateTimeInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./DualListInput.html"><code>&lt;DualListInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./FileInput.html"><code>&lt;FileInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./ImageInput.html"><code>&lt;ImageInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./MarkdownInput.html"><code>&lt;MarkdownInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./NullableBooleanInput.html"><code>&lt;NullableBooleanInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./NumberInput.html"><code>&lt;NumberInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./PasswordInput.html"><code>&lt;PasswordInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./PredictiveTextInput.html"><code>&lt;PredictiveTextInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li  class="beginner" ><a class="nav-link" href="./RadioButtonGroupInput.html"><code>&lt;RadioButtonGroupInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./ReferenceInput.html"><code>&lt;ReferenceInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./ReferenceArrayInput.html"><code>&lt;ReferenceArrayInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./ReferenceManyInput.html"><code>&lt;ReferenceManyInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./ReferenceManyToManyInput.html"><code>&lt;ReferenceManyToManyInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./ReferenceNodeInput.html"><code>&lt;ReferenceNodeInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./ReferenceOneInput.html"><code>&lt;ReferenceOneInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li  class="beginner" ><a class="nav-link" href="./RichTextInput.html"><code>&lt;RichTextInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SearchInput.html"><code>&lt;SearchInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SelectInput.html"><code>&lt;SelectInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SelectArrayInput.html"><code>&lt;SelectArrayInput&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./SimpleFormIterator.html"><code>&lt;SimpleFormIterator&gt;</code></a></li>
  <li ><a class="nav-link" href="./SmartRichTextInput.html"><code>&lt;SmartRichTextInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li  class="beginner" ><a class="nav-link" href="./TextInput.html"><code>&lt;TextInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./TimeInput.html"><code>&lt;TimeInput&gt;</code></a></li>
  <li ><a class="nav-link" href="./TranslatableInputs.html"><code>&lt;TranslatableInputs&gt;</code></a></li>
  <li ><a class="nav-link" href="./TreeInput.html"><code>&lt;TreeInput&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useInput.html"><code>useInput</code></a></li>
</ul>

<ul><div>Preferences</div>
  <li ><a class="nav-link" href="./Store.html">Introduction</a></li>
  <li ><a class="nav-link" href="./useStore.html"><code>useStore</code></a></li>
  <li ><a class="nav-link" href="./useRemoveFromStore.html"><code>useRemoveFromStore</code></a></li>
  <li ><a class="nav-link" href="./useResetStore.html"><code>useResetStore</code></a></li>
  <li ><a class="nav-link" href="./useStoreContext.html"><code>useStoreContext</code></a></li>
  <li ><a class="nav-link" href="./Configurable.html"><code>&lt;Configurable&gt;</code></a></li>
</ul>

<ul><div>I18N Provider and Translations</div>
  <li ><a class="nav-link" href="./Translation.html">Introduction</a></li>
  <li ><a class="nav-link" href="./TranslationSetup.html">Setting Up</a></li>
  <li ><a class="nav-link" href="./TranslationLocales.html">Supported Locales</a></li>
  <li ><a class="nav-link" href="./TranslationTranslating.html">Translating UI Components</a></li>
  <li ><a class="nav-link" href="./TranslationWriting.html">Writing an i18nProvider</a></li>
  <li ><a class="nav-link" href="./useTranslate.html"><code>useTranslate</code></a></li>
  <li ><a class="nav-link" href="./useLocaleState.html"><code>useLocaleState</code></a></li>
  <li ><a class="nav-link" href="./LocalesMenuButton.html"><code>&lt;LocalesMenuButton&gt;</code></a></li>
</ul>

<ul><div>Other UI components</div>
  <li  class="beginner" ><a class="nav-link" href="./Layout.html"><code>&lt;Layout&gt;</code></a></li>
  <li ><a class="nav-link" href="./ContainerLayout.html"><code>&lt;ContainerLayout&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./SolarLayout.html"><code>&lt;SolarLayout&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li  class="beginner" ><a class="nav-link" href="./AppBar.html"><code>&lt;AppBar&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./Menu.html"><code>&lt;Menu&gt;</code></a></li>
  <li ><a class="nav-link" href="./MultiLevelMenu.html"><code>&lt;MultiLevelMenu&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./IconMenu.html"><code>&lt;IconMenu&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./Title.html"><code>&lt;Title&gt;</code></a></li>
  <li ><a class="nav-link" href="./Breadcrumb.html"><code>&lt;Breadcrumb&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./Search.html"><code>&lt;Search&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./SearchWithResult.html"><code>&lt;SearchWithResult&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./Confirm.html"><code>&lt;Confirm&gt;</code></a></li>
  <li  class="beginner" ><a class="nav-link" href="./Buttons.html">Buttons</a></li>
  <li ><a class="nav-link" href="./RevisionsButton.html"><code>&lt;RevisionsButton&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./CheckForApplicationUpdate.html"><code>&lt;CheckForApplicationUpdate&gt;</code></a></li>
  <li ><a class="nav-link" href="./UpdateButton.html"><code>&lt;UpdateButton&gt;</code></a></li>
  <li ><a class="nav-link" href="./RecordRepresentation.html"><code>&lt;RecordRepresentation&gt;</code></a></li>
  <li ><a class="nav-link" href="./PrevNextButtons.html"><code>&lt;PrevNextButtons&gt;</code></a></li>
  <li ><a class="nav-link" href="./useDefineAppLocation.html"><code>useDefineAppLocation</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useGetRecordRepresentation.html"><code>useGetRecordRepresentation</code></a></li>
</ul>

<ul><div>Theming</div>
  <li  class="beginner" ><a class="nav-link" href="./Theming.html">Introduction</a></li>
  <li  class="beginner" ><a class="nav-link" href="./SX.html">The <code>sx</code> prop</a></li>
  <li  class="beginner" ><a class="nav-link" href="./AppTheme.html">Application Theme</a></li>
  <li ><a class="nav-link" href="./BoxStackGrid.html"><code>&lt;Box&gt;</code>, <code>&lt;Stack&gt;</code> and <code>&lt;Grid&gt;</code></a></li>
  <li ><a class="nav-link" href="./ToggleThemeButton.html"><code>&lt;ToggleThemeButton&gt;</code></a></li>
  <li ><a class="nav-link" href="./useMediaQuery.html"><code>useMediaQuery</code></a></li>
  <li ><a class="nav-link" href="./useTheme.html"><code>useTheme</code></a></li>
</ul>

<ul><div>Realtime</div>
  <li ><a class="nav-link" href="./Realtime.html">Introduction</a></li>
  <li ><a class="nav-link" href="./RealtimeDataProvider.html">Data Provider Requirements</a></li>
  <li ><a class="nav-link" href="./usePublish.html"><code>usePublish</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useSubscribe.html"><code>useSubscribe</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useSubscribeCallback.html"><code>useSubscribeCallback</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useSubscribeToRecord.html"><code>useSubscribeToRecord</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useSubscribeToRecordList.html"><code>useSubscribeToRecordList</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useLock.html"><code>useLock</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useUnlock.html"><code>useUnlock</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useGetLock.html"><code>useGetLock</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useGetLockLive.html"><code>useGetLockLive</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useGetLocks.html"><code>useGetLocks</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useGetLocksLive.html"><code>useGetLocksLive</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useLockOnMount.html"><code>useLockOnMount</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useLockOnCall.html"><code>useLockOnCall</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useGetListLive.html"><code>useGetListLive</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./useGetOneLive.html"><code>useGetOneLive</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./ListLive.html"><code>&lt;ListLive&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./EditLive.html"><code>&lt;EditLive&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./ShowLive.html"><code>&lt;ShowLive&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
  <li ><a class="nav-link" href="./MenuLive.html"><code>&lt;MenuLive&gt;</code><img class="premium" src="./img/premium.svg" /></a></li>
</ul>

<ul><div>Recipes</div>
  <li ><a class="nav-link" href="./Caching.html">Caching</a></li>
  <li ><a class="nav-link" href="./Routing.html">Routing</a></li>
  <li ><a class="nav-link" href="./UnitTesting.html">Unit Testing</a></li>
  <li ><a class="nav-link" href="./AdvancedTutorials.html">Advanced tutorials</a></li>
</ul>

<li ><a class="nav-link" href="./Ecosystem.html">Ecosystem</a></li>
<li ><a class="nav-link" href="./FAQ.html">FAQ</a></li>
<li  class="beginner" ><a class="nav-link" href="./Reference.html">Index</a></li>

<div class="beginner-mode-on" style="margin:1em;padding:1em;background:#ffffca;border-radius:4px;display:none;font-size:0.8em;opacity:0.8;text-align:center;">
  <a href="#beginner-mode">Beginner mode is on</a>. Turn it off to reveal more documentation for advanced components.
</div>

            </ul>
        </header>

        <main>
            <div class="container sticker-container">
                <div class="row">
                    <div class="col s12 m9">
                        <div
                            class="markdown-section DocSearch-content toc-content"
                        >
                            <h1 id="upgrading-to-v4">Upgrading to v4</h1>

<p>React-admin v4 has upgraded all its dependencies to their latest major version. Some major dependencies were swapped (<code class="language-plaintext highlighter-rouge">react-query</code> instead of <code class="language-plaintext highlighter-rouge">redux</code>, <code class="language-plaintext highlighter-rouge">react-hook-form</code> instead of <code class="language-plaintext highlighter-rouge">react-final-form</code>). In addition, the lower layers of the react-admin code have been rewritten for better extensibility.</p>

<p>We’ve done our best to keep the general API of react-admin v4 similar with the v3 API. But the changes mentioned above result in many small compatibility breaks. An application built with react-admin v3 will need some work to run with react-admin v4.</p>

<p>Depending on the size of your v3 application, the upgrade will take between a few hours to a few days. If you use TypeScript, the migration will be much faster.</p>

<h2 id="material-ui-v5">Material UI v5</h2>

<p>React-admin v4 uses Material UI (Material-UI) v5. The Material UI team has written an upgrade guide, which you should read to upgrade your material-ui code.</p>

<p><a href="https://mui.com/material-ui/migration/migration-v4/">https://mui.com/material-ui/migration/migration-v4/</a></p>

<h2 id="redux-is-gone">Redux Is Gone</h2>

<p>React-admin no longer relies on Redux. Instead, it relies on <a href="https://react.dev/learn/passing-data-deeply-with-context">React context</a> and third-party libraries (e.g. <a href="https://react-query-v3.tanstack.com/">react-query</a>).</p>

<p>You will need to update your code if it contains any of the following keywords:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">createAdminStore</code></li>
  <li><code class="language-plaintext highlighter-rouge">customReducers</code></li>
  <li><code class="language-plaintext highlighter-rouge">customSagas</code></li>
  <li><code class="language-plaintext highlighter-rouge">initialState</code></li>
  <li><code class="language-plaintext highlighter-rouge">useSelector</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDispatch</code></li>
</ul>

<h3 id="running-inside-a-redux-app">Running Inside A Redux App</h3>

<p>You could run a react-admin app inside an existing Redux app, provided that you initialized the react-admin reducers. This is no longer necessary, so you can directly put your custom reducers in your Redux store:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { createAdminStore, Admin } from 'react-admin';
</span><span class="gi">+import { Admin } from 'react-admin';
+import { createStore, combineReducers } from 'redux';
</span><span class="p">import { Provider } from 'react-redux';
</span>
const App = () =&gt; (
    &lt;Provider
<span class="gd">-       store={createAdminStore({
-           authProvider,
-           dataProvider,
-           history,
-           customReducers,
-       })}
</span><span class="gi">+       store={createStore(combineReducers(customReducers))}
</span>    &gt;
        &lt;Admin
            authProvider={authProvider}
            dataProvider={dataProvider}
            history={history}
            title="My Admin"
        &gt;
            ...
        &lt;/Admin&gt;
    &lt;/Provider&gt;
<span class="err">);</span>
</code></pre></div></div>

<h3 id="using-custom-reducers">Using Custom Reducers</h3>

<p>If your app used custom reducers, then you need to create a store manually, and wrap the app with a <code class="language-plaintext highlighter-rouge">Provider</code> component.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import customReducers from './customReducers';
</span><span class="gi">+import { createStore, combineReducers } from 'redux';
+import { Provider } from 'react-redux';
</span>
const App = () =&gt; (
<span class="gi">+   &lt;Provider store={createStore(combineReducers(customReducers))}&gt;
</span>        &lt;Admin
            dataProvider={dataProvider}
<span class="gd">-           customReducers={customReducers}
</span>        &gt;
            ...
        &lt;/Admin&gt;
<span class="gi">+   &lt;/Provider&gt;
</span><span class="err">);</span>
</code></pre></div></div>

<h3 id="admin-initialstate-is-gone"><code class="language-plaintext highlighter-rouge">&lt;Admin initialState&gt;</code> Is Gone</h3>

<p>The <code class="language-plaintext highlighter-rouge">&lt;Admin initialState&gt;</code> prop used to be used to initialize the store. As there is no Redux store anymore, you cannot set the react-admin defaults this way.</p>

<p>Apart from initializing the Redux store for unit tests (which is no longer necessary, as react-admin components don’t use Redux anymore), the only use case for <code class="language-plaintext highlighter-rouge">initialState</code> was to initialize the sidebar <code class="language-plaintext highlighter-rouge">open</code> state to <code class="language-plaintext highlighter-rouge">false</code>. To achieve the same in v4, initialize the store and set the <code class="language-plaintext highlighter-rouge">sidebar.open</code> state to <code class="language-plaintext highlighter-rouge">false</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Admin } from 'react-admin';
</span><span class="gi">+import { Admin, localStorageStore } from 'react-admin';
</span>
+const store = localStorageStore();
<span class="gi">+store.setItem('sidebar.open', false);
</span>
const App = () =&gt; (
    &lt;Admin
        dataProvider={dataProvider}
<span class="gd">-       initialState={{ admin : { ui: { sidebarOpen: false } } }}
</span><span class="gi">+       store={store}
</span>    &gt;
        ...
    &lt;/Admin&gt;
<span class="err">);</span>
</code></pre></div></div>

<h3 id="useselector-wont-return-anything"><code class="language-plaintext highlighter-rouge">useSelector</code> Won’t Return Anything</h3>

<p>If your code used <code class="language-plaintext highlighter-rouge">useSelector</code> to read the react-admin application state, it will break. React-admin v4 doesn’t use Redux anymore.</p>

<p>React-admin no longer uses Redux for <strong>data fetching</strong>. Instead, it uses react-query. If you used to read data from the Redux store (which was a bad practice by the way), you’ll have to use specialized data provider hooks instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import * as React from "react";
</span><span class="gd">-import { useSelector } from 'react-redux';
</span><span class="gi">+import { useGetOne } from 'react-admin';
</span><span class="p">import { Loading, Error } from '../ui';
</span>
const UserProfile = ({ record }) =&gt; {
<span class="gd">-   const data = useSelector(state =&gt; state.resources.users.data[record.id]);
</span><span class="gi">+   const { data, isLoading, error } = useGetOne(
+       'users',
+       { id: record.id }
+   );
+   if (isLoading) { return &lt;Loading /&gt;; }
+   if (error) { return &lt;Error /&gt;; }
</span>    return &lt;div&gt;User {data.username}&lt;/div&gt;;
<span class="err">};</span>
</code></pre></div></div>

<p>Besides, the <code class="language-plaintext highlighter-rouge">loadedOnce</code> reducer, used internally for the previous version of the List page logic, is no longer necessary and has been removed.</p>

<p>A non-documented hack allowed to <strong>read records directly from the Redux store</strong>. You now have to use the dataProvider hooks to get them.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useSelector } from 'react-redux';
</span><span class="gi">+import { useGetOne } from 'react-admin';
</span>
const BookAuthor = ({ record }) =&gt; {
<span class="gd">-   const author = useSelector(state =&gt;
-       state.admin.resources.users.data[record.authorId]
-   );
</span><span class="gi">+   const { data: author, isLoading, error } = useGetOne(
+       'users',
+       { id: record.authorId }
+   );
+   if (isLoading) { return &lt;Loading /&gt;; }
+   if (error) { return &lt;Error /&gt;; }
</span>    return &lt;div&gt;Author {data.username}&lt;/div&gt;;
<span class="err">};</span>
</code></pre></div></div>

<p>React-admin no longer relies on Redux to fetch <strong>relationships</strong>. Instead, the cache of previously fetched relationships is managed by react-query.</p>

<p>If you need to get the records related to the current one via a one-to-many relationship (e.g. to fetch all the books of a given author), you can use the <code class="language-plaintext highlighter-rouge">useGetManyReference</code> hook instead of the <code class="language-plaintext highlighter-rouge">oneToMany</code> reducer.</p>

<p>If you need to get possible values for a relationship, use the <code class="language-plaintext highlighter-rouge">useGetList</code> hook instead of the <code class="language-plaintext highlighter-rouge">possibleValues</code> reducer.</p>

<p>React-admin no longer uses Redux for <strong>resource definitions</strong>. Instead, it uses a custom context. If you used the <code class="language-plaintext highlighter-rouge">useResourceDefinition</code> hook, this change is backwards compatible. But if you used to read the Redux state directly, you’ll have to upgrade your code. This often happens for custom menus, using the <code class="language-plaintext highlighter-rouge">getResources</code> selector:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">//</span> in src/Menu.js
<span class="p">import * as React from 'react';
import { createElement } from 'react';
</span><span class="gd">-import { useSelector } from 'react-redux';
</span><span class="p">import { useMediaQuery } from '@mui/material';
</span><span class="gd">-import { DashboardMenuItem, Menu, MenuItemLink, getResources } from 'react-admin';
</span><span class="gi">+import { DashboardMenuItem, Menu, MenuItemLink, useResourceDefinitions } from 'react-admin';
</span><span class="p">import DefaultIcon from '@mui/icons-material/ViewList';
import LabelIcon from '@mui/icons-material/Label';
</span>
export const Menu = (props) =&gt; {
<span class="gd">-   const resources = useSelector(getResources);
</span><span class="gi">+   const resourcesDefinitions = useResourceDefinitions();
+   const resources = Object.keys(resourcesDefinitions).map(name =&gt; resourcesDefinitions[name]);
</span>    const open = useSelector(state =&gt; state.admin.ui.sidebarOpen);
    return (
        &lt;Menu {...props}&gt;
            &lt;DashboardMenuItem /&gt;
            {resources.map(resource =&gt; (
                &lt;MenuItemLink
                    key={resource.name}
                    to={`/${resource.name}`}
                    primaryText={
                        (resource.options &amp;&amp; resource.options.label) ||
                        resource.name
                    }
                    leftIcon={
                        resource.icon ? &lt;resource.icon /&gt; : &lt;DefaultIcon /&gt;
                    }
                    onClick={props.onMenuClick}
                    sidebarIsOpen={open}
                /&gt;
            ))}
            {/* add your custom menus here */}
        &lt;/Menu&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>React-admin no longer uses Redux for storing the <strong>list parameters</strong> (current sort &amp; filters, selected ids, expanded rows). This shouldn’t impact you if you used the react-admin hooks (<code class="language-plaintext highlighter-rouge">useListParams</code>, <code class="language-plaintext highlighter-rouge">useRecordSelection</code>, <code class="language-plaintext highlighter-rouge">useExpanded</code>) to read the state.</p>

<p>React-admin no longer uses Redux to store the <strong>sidebar state</strong>. The introduction of a custom hook, <code class="language-plaintext highlighter-rouge">useSidebarState</code>, facilitates the migration.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import * as React from 'react';
import { createElement } from 'react';
</span><span class="gd">-import { useSelector } from 'react-redux';
</span><span class="p">import { useMediaQuery } from '@mui/material';
</span><span class="gd">-import { MenuItemLink, useResourceDefinitions } from 'react-admin';
</span><span class="gi">+import { MenuItemLink, useResourceDefinitions, useSidebarState } from 'react-admin';
</span><span class="p">import LabelIcon from '@mui/icons-material/Label';
</span>
const Menu = ({ onMenuClick, logout }) =&gt; {
    const isXSmall = useMediaQuery(theme =&gt; theme.breakpoints.down('xs'));
<span class="gd">-   const open = useSelector(state =&gt; state.admin.ui.sidebarOpen);
</span><span class="gi">+   const [open] = useSidebarState();
</span>    const resources = useResourceDefinitions();
    
    return (
        &lt;div&gt;
            {Object.keys(resources).map(name =&gt; (
                &lt;MenuItemLink
                    key={name}
                    to={`/${name}`}
                    primaryText={resources[name].options &amp;&amp; resources[name].options.label || name}
                    leftIcon={createElement(resources[name].icon)}
                    onClick={onMenuClick}
                    sidebarIsOpen={open}
                /&gt;
            ))}
            {isXSmall &amp;&amp; logout}
        &lt;/div&gt;
    );
<span class="err">}</span>
export default Menu;
</code></pre></div></div>

<p>React-admin no longer uses Redux for <strong>notifications</strong>. Instead, it uses a custom context. This change is backwards compatible, as the APIs for the <code class="language-plaintext highlighter-rouge">useNotify</code> and the <code class="language-plaintext highlighter-rouge">&lt;Notification&gt;</code> component are the same. If you used to <code class="language-plaintext highlighter-rouge">dispatch</code> a <code class="language-plaintext highlighter-rouge">showNotification</code> action, you’ll have to use the <code class="language-plaintext highlighter-rouge">useNotify</code> hook instead:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useDispatch } from 'react-redux';
-import { showNotification } from 'react-admin';
</span><span class="gi">+import { useNotify } from 'react-admin';
</span>
const NotifyButton = () =&gt; {
<span class="gd">-   const dispatch = useDispatch();
</span><span class="gi">+   const notify = useNotify();
</span>    const handleClick = () =&gt; {
<span class="gd">-       dispatch(showNotification('Comment approved', 'success'));
</span><span class="gi">+       notify('Comment approved', { type: 'success' });
</span>    }
    return &lt;button onClick={handleClick}&gt;Notify&lt;/button&gt;;
<span class="err">};</span>
</code></pre></div></div>

<h3 id="action-creators-are-gone">Action Creators Are Gone</h3>

<p>As React-admin no longer uses Redux, each time your code used react-redux’s <code class="language-plaintext highlighter-rouge">dispatch</code> with an action creator, you’ll have to replace it with a hook.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">dispatch(fetchStart())</code> and <code class="language-plaintext highlighter-rouge">dispatch(fetchEnd())</code> must be replaced by <code class="language-plaintext highlighter-rouge">useQuery()</code> and <code class="language-plaintext highlighter-rouge">useMutation()</code></li>
  <li><code class="language-plaintext highlighter-rouge">dispatch(setSidebarVisibility(true))</code> must be replaced by <code class="language-plaintext highlighter-rouge">useSidebarState()</code></li>
  <li><code class="language-plaintext highlighter-rouge">dispatch(showNotification('Comment approved', 'success'))</code> must be replaced by <code class="language-plaintext highlighter-rouge">useNotify()</code></li>
  <li><code class="language-plaintext highlighter-rouge">dispatch(push('/comments'))</code> must be replaced by <code class="language-plaintext highlighter-rouge">useNavigate()</code></li>
</ul>

<p>React-admin used <code class="language-plaintext highlighter-rouge">dispatch</code> in many other places, but they were already behind a hook (<code class="language-plaintext highlighter-rouge">useRecordSelection</code>, <code class="language-plaintext highlighter-rouge">useListParams</code>, <code class="language-plaintext highlighter-rouge">useExpanded</code>, <code class="language-plaintext highlighter-rouge">useNotify</code>, <code class="language-plaintext highlighter-rouge">useSidebarState</code>), and not documented. If you dispatched react-admin actions manually, you’ll have to look for the hook alternatives.</p>

<h3 id="redux-saga-was-removed">Redux-Saga Was Removed</h3>

<p>The use of sagas has been deprecated for a while. React-admin v4 will no longer uses sagas.</p>

<p>This means that the <code class="language-plaintext highlighter-rouge">&lt;Admin customSagas&gt;</code> prop is no longer supported.</p>

<p>If you still relied on sagas, you have to port your saga code to react <code class="language-plaintext highlighter-rouge">useEffect</code>, which is the standard way to write side effects in modern react.</p>

<h3 id="no-more-data-actions">No More Data Actions</h3>

<p>React-admin doesn’t dispatch Redux actions like <code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ONE_SUCCESS</code> and <code class="language-plaintext highlighter-rouge">RA/FETCH_END</code>. If you relied on these actions for your custom reducers, you must now use react-query <code class="language-plaintext highlighter-rouge">onSuccess</code> callback or React’s <code class="language-plaintext highlighter-rouge">useEffect</code> instead.</p>

<p>The following actions no longer exist:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ONE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ONE_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ONE_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ONE_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_LIST</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_LIST_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_LIST_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_LIST_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ALL</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ALL_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ALL_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_ALL_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_MANY</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_MANY_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_MANY_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_MANY_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_MANY_REFERENCE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_MANY_REFERENCE_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_MANY_REFERENCE_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_GET_MANY_REFERENCE_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_CREATE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_CREATE_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_CREATE_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_CREATE_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_UPDATE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_UPDATE_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_UPDATE_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_UPDATE_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_UPDATE_MANY</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_UPDATE_MANY_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_UPDATE_MANY_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_UPDATE_MANY_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_DELETE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_DELETE_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_DELETE_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_DELETE_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_DELETE_MANY</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_DELETE_MANY_LOADING</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_DELETE_MANY_FAILURE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/CRUD_DELETE_MANY_SUCCESS</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/FETCH_START</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/FETCH_END</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/FETCH_ERROR</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/FETCH_CANCEL</code></li>
</ul>

<p>Other actions related to data fetching were also removed:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">RA/REFRESH_VIEW</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/SET_AUTOMATIC_REFRESH</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/START_OPTIMISTIC_MODE</code></li>
  <li><code class="language-plaintext highlighter-rouge">RA/STOP_OPTIMISTIC_MODE</code></li>
</ul>

<h3 id="removed-connected-react-router">Removed connected-react-router</h3>

<p>If you were dispatching <code class="language-plaintext highlighter-rouge">connected-react-router</code> actions to navigate, you’ll now have to use <code class="language-plaintext highlighter-rouge">react-router</code> hooks:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useDispatch } from 'react-redux';
-import { push } from 'connected-react-router';
</span><span class="gi">+import { useNavigate } from 'react-router-dom';
</span>
const MyComponent = () =&gt; {
<span class="gd">-    const dispatch = useDispatch();
</span><span class="gi">+    const navigate = useNavigate();
</span>
    const myHandler = () =&gt; {
<span class="gd">-        dispatch(push('/my-url'));
</span><span class="gi">+        navigate('/my-url');
</span>    }
<span class="err">}</span>
</code></pre></div></div>

<h2 id="react-router-v6">React-router V6</h2>

<p>React-admin v4 uses react-router v6, which changes quite a few things internally.</p>

<p>This should be mostly transparent for you unless your code contains any of the following keywords:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">history</code></li>
  <li><code class="language-plaintext highlighter-rouge">customRoutes</code></li>
  <li><code class="language-plaintext highlighter-rouge">useHistory</code></li>
  <li><code class="language-plaintext highlighter-rouge">push</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Route&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;RouteWithoutLayout&gt;</code></li>
</ul>

<h3 id="the-way-to-define-custom-routes-has-changed">The Way To Define Custom Routes Has Changed</h3>

<p>Custom routes used to be provided to the <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code> component through the <code class="language-plaintext highlighter-rouge">customRoutes</code> prop. This was awkward to use as you had to provide an array of <code class="language-plaintext highlighter-rouge">&lt;Route&gt;</code> elements. Besides, we had to provide the <code class="language-plaintext highlighter-rouge">&lt;RouteWithoutLayout&gt;</code> component to support custom routes rendered without the <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code> and keep TypeScript happy.</p>

<p>As we upgraded to react-router v6, we had to come up with another way to support custom routes.</p>

<p>Meet the <code class="language-plaintext highlighter-rouge">&lt;CustomRoutes&gt;</code> component. You can pass it as a child of <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code>, just like a <code class="language-plaintext highlighter-rouge">&lt;Resource&gt;</code>. It accepts react-router <code class="language-plaintext highlighter-rouge">&lt;Route&gt;</code> as its children (and only that). You can specify whether the custom routes it contains should be rendered with the <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code> or not by setting the <code class="language-plaintext highlighter-rouge">noLayout</code> prop. It’s <code class="language-plaintext highlighter-rouge">false</code> by default.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Admin, Resource, RouteWithoutLayout } from 'react-admin';
</span><span class="gi">+import { Admin, CustomRoutes, Resource } from 'react-admin';
</span>
const MyAdmin = () =&gt; (
    &lt;Admin
<span class="gd">-       customRoutes={[
-           &lt;Route path="/custom" component={MyCustomRoute} /&gt;,
-           &lt;RouteWithoutLayout path="/custom2" component={MyCustomRoute2} /&gt;,
-       ]}
</span>    &gt;
<span class="gi">+       &lt;CustomRoutes&gt;
+           &lt;Route path="/custom" element={&lt;MyCustomRoute /&gt;} /&gt;
+       &lt;/CustomRoutes&gt;
+       &lt;CustomRoutes noLayout&gt;
+           &lt;Route path="/custom2" element={&lt;MyCustomRoute2 /&gt;} /&gt;
+       &lt;/CustomRoutes&gt;
</span>        &lt;Resource name="posts" /&gt;
    &lt;/Admin&gt;
<span class="err">)</span>
</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">&lt;CustomRoutes&gt;</code> handles <code class="language-plaintext highlighter-rouge">null</code> elements and fragments correctly, so you can check for any condition before returning one of its children:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">const</span> <span class="nx">MyAdmin</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">condition</span> <span class="o">=</span> <span class="nx">useGetConditionFromSomewhere</span><span class="p">();</span>
    
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">&lt;</span><span class="nc">Admin</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nc">CustomRoutes</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nc">Route</span> <span class="na">path</span><span class="p">=</span><span class="s">"/custom"</span> <span class="na">element</span><span class="p">=</span><span class="si">{</span><span class="p">&lt;</span><span class="nc">MyCustomRoute</span> <span class="p">/&gt;</span><span class="si">}</span> <span class="p">/&gt;</span>
                    <span class="si">{</span><span class="nx">condition</span>
                        <span class="p">?</span> <span class="p">(</span>
                              <span class="p">&lt;&gt;</span>
                                  <span class="p">&lt;</span><span class="nc">Route</span> <span class="na">path</span><span class="p">=</span><span class="s">"/a_path"</span> <span class="na">element</span><span class="p">=</span><span class="si">{</span><span class="p">&lt;</span><span class="nc">ARoute</span> <span class="p">/&gt;</span><span class="si">}</span> <span class="p">/&gt;</span>
                                  <span class="p">&lt;</span><span class="nc">Route</span> <span class="na">path</span><span class="p">=</span><span class="s">"/another_path"</span> <span class="na">element</span><span class="p">=</span><span class="si">{</span><span class="p">&lt;</span><span class="nc">AnotherRoute</span> <span class="p">/&gt;</span><span class="si">}</span> <span class="p">/&gt;</span>
                              <span class="p">&lt;/&gt;</span>
                          <span class="p">)</span>
                        <span class="p">:</span> <span class="kc">null</span><span class="si">}</span>
                <span class="p">&lt;/</span><span class="nc">CustomRoutes</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nc">Admin</span><span class="p">&gt;</span>
        <span class="p">);</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>See <a href="https://reactrouter.com/en/6.6.2/upgrading/v5#advantages-of-route-element">https://reactrouter.com/en/6.6.2/upgrading/v5#advantages-of-route-element</a> for more details about the new <code class="language-plaintext highlighter-rouge">&lt;Route&gt;</code> element</p>

<h3 id="use-usenavigate-instead-of-usehistory">Use <code class="language-plaintext highlighter-rouge">useNavigate</code> instead of <code class="language-plaintext highlighter-rouge">useHistory</code></h3>

<p>See <a href="https://reactrouter.com/en/v6/upgrading/v5#use-usenavigate-instead-of-usehistory">https://reactrouter.com/en/v6/upgrading/v5#use-usenavigate-instead-of-usehistory</a> to upgrade.</p>

<h3 id="change-the-route-syntax">Change The <code class="language-plaintext highlighter-rouge">&lt;Route&gt;</code> Syntax</h3>

<p>If your admin contains components that add new sub routes (like react-admin’s <code class="language-plaintext highlighter-rouge">&lt;TabbedForm&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;TabbedShowLayout&gt;</code>), you’ll need to update the <code class="language-plaintext highlighter-rouge">&lt;Route&gt;</code> syntax.</p>

<p>See <a href="https://reactrouter.com/en/v6/upgrading/v5">https://reactrouter.com/en/v6/upgrading/v5</a> for details.</p>

<h3 id="using-a-custom-history">Using A Custom History</h3>

<p>To use a <code class="language-plaintext highlighter-rouge">BrowserHistory</code> instead of the default <code class="language-plaintext highlighter-rouge">HashHistory</code>, you previously had to pass a custom <code class="language-plaintext highlighter-rouge">&lt;Admin history&gt;</code> prop. You can now wrap your app with the history component you need:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { createBrowserHistory } from 'react-router';
</span><span class="gi">+import { BrowserRouter } from 'react-router-dom';
</span><span class="p">import { Admin, Resource } from 'react-admin';
</span>
const App = () =&gt; (
<span class="gi">+   &lt;BrowserRouter&gt;
</span>        &lt;Admin 
            dataProvider={...}
<span class="gd">-           history={createBrowserHistory()}
</span>        &gt;    
            &lt;Resource name="posts" /&gt;
        &lt;/Admin&gt;
<span class="gi">+   &lt;/BrowserRouter&gt;
</span><span class="err">);</span>
</code></pre></div></div>

<h3 id="mounting-react-admin-in-a-sub-path">Mounting React-Admin In A Sub Path</h3>

<p>If you were using react-admin in a sub path (e.g. <code class="language-plaintext highlighter-rouge">/admin</code>), and if you were using <code class="language-plaintext highlighter-rouge">BrowserHistory</code>, you’ll have to update your code to set this base path as the <code class="language-plaintext highlighter-rouge">&lt;Admin basename&gt;</code> prop:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { Admin, Resource } from 'react-admin';
</span>
const App = () =&gt; (
<span class="gi">+   &lt;BrowserRouter&gt;
</span>        &lt;Admin
            dataProvider={dataProvider}
            authProvider={authProvider}
<span class="gd">-           history={createBrowserHistory()}
</span><span class="gi">+           basename="/admin"
</span>        &gt;
            &lt;Resource name="posts" /&gt;
        &lt;/Admin&gt;
<span class="gi">+   &lt;/BrowserRouter&gt;
</span><span class="err">);</span>
</code></pre></div></div>

<p>You don’t need to make that change if you were using <code class="language-plaintext highlighter-rouge">HashHistory</code> or <code class="language-plaintext highlighter-rouge">MemoryHistory</code>.</p>

<h2 id="data-provider">Data Provider</h2>

<p>React-admin v3 used Redux to communicate with the data provider ; react-admin v4 uses react-query. This leads to a few necessary changes in your code if you used one of the following keywords:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">useQuery</code></li>
  <li><code class="language-plaintext highlighter-rouge">useQueryWithStore</code></li>
  <li><code class="language-plaintext highlighter-rouge">useMutation</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Query&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Mutation&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDataProvider</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetOne</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetList</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetMany</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetReference</code></li>
  <li><code class="language-plaintext highlighter-rouge">useCreate</code></li>
  <li><code class="language-plaintext highlighter-rouge">useUpdate</code></li>
  <li><code class="language-plaintext highlighter-rouge">useUpdateMany</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDelete</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDeleteMany</code></li>
  <li><code class="language-plaintext highlighter-rouge">validUntil</code></li>
</ul>

<h3 id="changed-signature-of-data-provider-hooks">Changed Signature Of Data Provider Hooks</h3>

<p>Specialized data provider hooks (like <code class="language-plaintext highlighter-rouge">useGetOne</code>, <code class="language-plaintext highlighter-rouge">useGetList</code>, <code class="language-plaintext highlighter-rouge">useGetMany</code> and <code class="language-plaintext highlighter-rouge">useUpdate</code>) have a new signature. There are 2 changes:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">loading</code> is renamed to <code class="language-plaintext highlighter-rouge">isLoading</code></li>
  <li>the hook signature now reflects the dataProvider signature (so every hook now takes 2 arguments, <code class="language-plaintext highlighter-rouge">resource</code> and <code class="language-plaintext highlighter-rouge">params</code>).</li>
</ul>

<p>For queries:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">//</span> useGetOne
<span class="gd">-const { data, loading } = useGetOne(
-   'posts',
-   123,
-);
</span><span class="gi">+const { data, isLoading } = useGetOne(
+   'posts',
+   { id: 123 }
+);
</span>
// useGetList
<span class="gd">-const { data, ids, loading } = useGetList(
-   'posts',
-   { page: 1, perPage: 10 },
-   { field: 'published_at', order: 'DESC' },
-);
-return &lt;&gt;{ids.map(id =&gt; &lt;span key={id}&gt;{data[id].title}&lt;/span&gt;)}&lt;/&gt;;
</span><span class="gi">+const { data, isLoading } = useGetList(
+   'posts',
+   {
+      pagination: { page: 1, perPage: 10 },
+      sort: { field: 'published_at', order: 'DESC' },
+   }
+);
+return &lt;&gt;{data.map(record =&gt; &lt;span key={record.id}&gt;{record.title}&lt;/span&gt;)}&lt;/&gt;;
</span>
// useGetMany
<span class="gd">-const { data, loading } = useGetMany(
-   'posts',
-   [123, 456],
-);
</span><span class="gi">+const { data, isLoading } = useGetMany(
+   'posts',
+   { ids: [123, 456] }
+);
</span>
// useGetManyReference
<span class="gd">-const { data, ids, loading } = useGetManyReference(
-   'comments',
-   'post_id',
-   123,
-   { page: 1, perPage: 10 },
-   { field: 'published_at', order: 'DESC' }
-   'posts'
-);
-return &lt;&gt;{ids.map(id =&gt; &lt;span key={id}&gt;{data[id].title}&lt;/span&gt;)}&lt;/&gt;;
</span><span class="gi">+const { data, isLoading } = useGetManyReference(
+   'comments',
+   {
+       target: 'post_id',
+       id: 123,
+       pagination: { page: 1, perPage: 10 },
+       sort: { field: 'published_at', order: 'DESC' }
+   }
+);
+return &lt;&gt;{data.map(record =&gt; &lt;span key={record.id}&gt;{record.title}&lt;/span&gt;)}&lt;/&gt;;
</span></code></pre></div></div>

<p>For mutations:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">//</span> useCreate
<span class="gd">-const [create, { loading }] = useCreate(
-   'posts',
-   { title: 'hello, world!' },
-);
-create(resource, data, options);
</span><span class="gi">+const [create, { isLoading }] = useCreate(
+   'posts',
+   { data: { title: 'hello, world!' } }
+);
+create(resource, { data }, options);
</span>
// useUpdate
<span class="gd">-const [update, { loading }] = useUpdate(
-   'posts',
-   123,
-   { likes: 12 },
-   { id: 123, title: "hello, world", likes: 122 }
-);
-update(resource, id, data, previousData, options);
</span><span class="gi">+const [update, { isLoading }] = useUpdate(
+   'posts',
+   {
+       id: 123,
+       data: { likes: 12 },
+       previousData: { id: 123, title: "hello, world", likes: 122 }
+   }
+);
+update(resource, { id, data, previousData }, options);
</span>
// useUpdateMany
<span class="gd">-const [updateMany, { loading }] = useUpdateMany(
-   'posts',
-   [123, 456],
-   { likes: 12 },
-);
-updateMany(resource, ids, data, options);
</span><span class="gi">+const [updateMany, { isLoading }] = useUpdateMany(
+   'posts',
+   {
+       ids: [123, 456],
+       data: { likes: 12 },
+   }
+);
+updateMany(resource, { ids, data }, options);
</span>
// useDelete
<span class="gd">-const [deleteOne, { loading }] = useDelete(
-   'posts',
-   123,
-   { id: 123, title: "hello, world", likes: 122 }
-);
-deleteOne(resource, id, previousData, options);
</span><span class="gi">+const [deleteOne, { isLoading }] = useDelete(
+   'posts',
+   {
+       id: 123,
+       previousData: { id: 123, title: "hello, world", likes: 122 }
+   }
+);
+deleteOne(resource, { id, previousData }, options);
</span>
// useDeleteMany
<span class="gd">-const [deleteMany, { loading }] = useDeleteMany(
-   'posts',
-   [123, 456],
-);
-deleteMany(resource, ids, options);
</span><span class="gi">+const [deleteMany, { isLoading }] = useDeleteMany(
+   'posts',
+   {
+       ids: [123, 456],
+   }
+);
+deleteMany(resource, { ids }, options);
</span>
</code></pre></div></div>

<p>This new signature should be easier to learn and use.</p>

<p>To upgrade, check every instance of your code of the following hooks:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">useGetOne</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetList</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetMany</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetManyReference</code></li>
  <li><code class="language-plaintext highlighter-rouge">useCreate</code></li>
  <li><code class="language-plaintext highlighter-rouge">useUpdate</code></li>
  <li><code class="language-plaintext highlighter-rouge">useUpdateMany</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDelete</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDeleteMany</code></li>
</ul>

<p>And update the calls. If you’re using TypeScript, your code won’t compile until you properly upgrade the calls.</p>

<p>These hooks are now powered by react-query, so the state argument contains way more than just <code class="language-plaintext highlighter-rouge">isLoading</code> (<code class="language-plaintext highlighter-rouge">reset</code>, <code class="language-plaintext highlighter-rouge">status</code>, <code class="language-plaintext highlighter-rouge">refetch</code>, etc.). Check the <a href="https://tanstack.com/query/v3/docs/react/reference/useQuery"><code class="language-plaintext highlighter-rouge">useQuery</code></a> and the <a href="https://tanstack.com/query/v3/docs/react/reference/useMutation"><code class="language-plaintext highlighter-rouge">useMutation</code></a> documentation on the react-query website for more details.</p>

<h3 id="usequery-usemutation-and-usequerywithstore-have-been-removed"><code class="language-plaintext highlighter-rouge">useQuery</code>, <code class="language-plaintext highlighter-rouge">useMutation</code>, and <code class="language-plaintext highlighter-rouge">useQueryWithStore</code> Have Been Removed</h3>

<p>React-admin v4 uses react-query rather than Redux for data fetching. The base react-query data fetching hooks (<code class="language-plaintext highlighter-rouge">useQuery</code>, <code class="language-plaintext highlighter-rouge">useMutation</code>, and <code class="language-plaintext highlighter-rouge">useQueryWithStore</code>) are no longer necessary as their functionality is provided by react-query.</p>

<p>If your application code uses these hooks, you have 2 ways to upgrade.</p>

<p>If you’re using <code class="language-plaintext highlighter-rouge">useQuery</code> to call a regular dataProvider method (like <code class="language-plaintext highlighter-rouge">dataProvider.getOne</code>), then you can use the specialized dataProvider hooks instead:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import * as React from "react";
</span><span class="gd">-import { useQuery } from 'react-admin';
</span><span class="gi">+import { useGetOne } from 'react-admin';
</span><span class="p">import { Loading, Error } from '../ui';
const UserProfile = ({ record }) =&gt; {
</span><span class="gd">-   const { loaded, error, data } = useQuery({
-       type: 'getOne',
-       resource: 'users',
-       payload: { id: record.id }
-   });
</span><span class="gi">+   const { data, isLoading, error } = useGetOne(
+       'users',
+       { id: record.id }
+   );
</span><span class="gd">-   if (!loaded) { return &lt;Loading /&gt;; }
</span><span class="gi">+   if (isLoading) { return &lt;Loading /&gt;; }
</span>    if (error) { return &lt;Error /&gt;; }
    return &lt;div&gt;User {data.username}&lt;/div&gt;;
<span class="err">};</span>
</code></pre></div></div>

<p>If you’re using <code class="language-plaintext highlighter-rouge">useMutation</code> to call a regular dataProvider method (like <code class="language-plaintext highlighter-rouge">dataProvider.update</code>), then you can use the specialized dataProvider hooks instead:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useMutation } from 'react-admin';
</span><span class="gi">+import { useUpdate } from 'react-admin';
</span>
const BanUserButton = ({ userId }) =&gt; {
<span class="gd">-   const [update, { loading, error }] = useMutation({
-       type: 'update',
-       resource: 'users',
-       payload: { id: userId, data: { isBanned: true } }
-   });
</span><span class="gi">+   const [update, { isLoading, error }] = useUpdate(
+       'users',
+       { id: userId, data: { isBanned: true } }
+   );
</span><span class="gd">-   return &lt;Button label="Ban" onClick={() =&gt; update()} disabled={loading} /&gt;;
</span><span class="gi">+   return &lt;Button label="Ban" onClick={() =&gt; update()} disabled={isLoading} /&gt;;
</span><span class="err">};</span>
</code></pre></div></div>

<p>If you’re calling a custom dataProvider method, or if you’re calling an PI route directly, then you can use react-query’s <code class="language-plaintext highlighter-rouge">useQuery</code> or <code class="language-plaintext highlighter-rouge">useMutation</code> instead:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useMutation } from 'react-admin';
</span><span class="gi">+import { useDataProvider } from 'react-admin';
+import { useMutation } from 'react-query';
</span><span class="p">const BanUserButton = ({ userId }) =&gt; {
</span><span class="gd">-   const [mutate, { loading, error, data }] = useMutation({
-       type: 'banUser',
-       payload: userId
-   });
</span><span class="gi">+   const dataProvider = useDataProvider();
+   const { mutate, isLoading } = useMutation(
+       () =&gt; dataProvider.banUser(userId)
+   );
</span><span class="gd">-   return &lt;Button label="Ban" onClick={() =&gt; mutate()} disabled={loading} /&gt;;
</span><span class="gi">+   return &lt;Button label="Ban" onClick={() =&gt; mutate()} disabled={isLoading} /&gt;;
</span><span class="err">};</span>
</code></pre></div></div>

<p>Refer to <a href="https://react-query-v3.tanstack.com/overview">the react-query documentation</a> for more information.</p>

<h3 id="query-and-mutation-have-been-removed"><code class="language-plaintext highlighter-rouge">&lt;Query&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;Mutation&gt;</code> Have Been Removed</h3>

<p>The component version of <code class="language-plaintext highlighter-rouge">useQuery</code> and <code class="language-plaintext highlighter-rouge">useMutation</code> have been removed. Use the related hook in your components instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Query } from 'react-admin';
</span><span class="gi">+import { useGetOne } from 'react-admin';
</span>
const UserProfile = ({ record }) =&gt; {
<span class="gd">-   return (
-       &lt;Query type="getOne" resource="users" payload={{ id: record.id }}&gt;
-           {({ loaded, error, data }) =&gt; {
-               if (!loaded) { return &lt;Loading /&gt;; }
-               if (error) { return &lt;Error /&gt;; }
-               return &lt;div&gt;User {data.username}&lt;/div&gt;;
-           }}
-       &lt;/Query&gt;
-   );
</span><span class="gi">+   const { data, isLoading, error } = useGetOne(
+       'users',
+       { id: record.id }
+   );
+   if (isLoading) { return &lt;Loading /&gt;; }
+   if (error) { return &lt;Error /&gt;; }
+   return &lt;div&gt;User {data.username}&lt;/div&gt;;
</span><span class="err">}</span>
</code></pre></div></div>

<h3 id="usedataprovider-no-longer-accepts-side-effects"><code class="language-plaintext highlighter-rouge">useDataProvider</code> No Longer Accepts Side Effects</h3>

<p><code class="language-plaintext highlighter-rouge">useDataProvider</code> returns a wrapper around the application <code class="language-plaintext highlighter-rouge">dataProvider</code> instance. In previous react-admin versions, the wrapper methods used to accept an <code class="language-plaintext highlighter-rouge">options</code> object, allowing to pass <code class="language-plaintext highlighter-rouge">onSuccess</code> and <code class="language-plaintext highlighter-rouge">onFailure</code> callbacks. This is no longer the case - the wrapper returns an object with the same method signatures as the original <code class="language-plaintext highlighter-rouge">dataProvider</code>.</p>

<p>If you need to call the <code class="language-plaintext highlighter-rouge">dataProvider</code> and apply side effects, use react-query’s <code class="language-plaintext highlighter-rouge">useQuery</code> or <code class="language-plaintext highlighter-rouge">useMutation</code> hooks instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useState } from 'react';
</span><span class="p">import { useDataProvider } from 'react-admin';
</span><span class="gi">+import { useMutation } from 'react-query';
</span>
const BanUserButton = ({ userId }) =&gt; {
    const dataProvider = useDataProvider();
<span class="gi">+   const { mutate, isLoading } = useMutation();
</span><span class="gd">-   const [loading, setLoading] = useState(false);
</span>    const handleClick = () =&gt; {
<span class="gd">-       setLoading(true);
-       dataProvider.banUser(userId, {
-           onSuccess: () =&gt; {
-               setLoading(false);
-               console.log('User banned');
-           },
-       });
</span><span class="gi">+       mutate(
+           ['banUser', userId],
+           () =&gt; dataProvider.banUser(userId),
+           { onSuccess: () =&gt; console.log('User banned') }
+       );
</span>    }
<span class="gd">-   return &lt;Button label="Ban" onClick={handleClick} disabled={loading} /&gt;;
</span><span class="gi">+   return &lt;Button label="Ban" onClick={handleClick} disabled={isLoading} /&gt;;
</span><span class="err">};</span>
</code></pre></div></div>

<p>Refer to <a href="https://react-query-v3.tanstack.com/overview">the react-query documentation</a> for more information.</p>

<h3 id="application-cache-no-longer-uses-validuntil">Application Cache No Longer Uses <code class="language-plaintext highlighter-rouge">validUntil</code></h3>

<p>React-admin’s <em>application cache</em> used to rely on the dataProvider returning a <code class="language-plaintext highlighter-rouge">validUntil</code> property in the response. This is no longer the case, as the cache functionality is handled by react-query. Therefore, you can safely remove the <code class="language-plaintext highlighter-rouge">validUntil</code> property from your dataProvider response.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const dataProvider = {
</span>    getOne: (resource, { id }) =&gt; {
        return fetch(`/api/${resource}/${id}`)
            .then(r =&gt; r.json())
            .then(data =&gt; {
<span class="gd">-               const validUntil = new Date();
-               validUntil.setTime(validUntil.getTime() + 5 * 60 * 1000);
</span>                return { 
                    data,
<span class="gd">-                   validUntil
</span>                };
            }));
    }
<span class="err">};</span>
</code></pre></div></div>

<p>This also implies that the <code class="language-plaintext highlighter-rouge">cacheDataProviderProxy</code> function was removed.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">//</span> in src/dataProvider.js
<span class="p">import simpleRestProvider from 'ra-data-simple-rest';
</span><span class="gd">-import { cacheDataProviderProxy } from 'react-admin'; 
</span>
const dataProvider = simpleRestProvider('http://path.to.my.api/');

-export default cacheDataProviderProxy(dataProvider);
<span class="gi">+export default dataProvider;
</span></code></pre></div></div>

<p>Instead, you must set up the cache duration at the react-query QueryClient level:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">QueryClient</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-query</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Admin</span><span class="p">,</span> <span class="nx">Resource</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">queryClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">QueryClient</span><span class="p">({</span>
        <span class="na">defaultOptions</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">queries</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">staleTime</span><span class="p">:</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="c1">// 5 minutes</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">Admin</span> <span class="na">dataProvider</span><span class="p">=</span><span class="si">{</span><span class="nx">dataProvider</span><span class="si">}</span> <span class="na">queryClient</span><span class="p">=</span><span class="si">{</span><span class="nx">queryClient</span><span class="si">}</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nc">Resource</span> <span class="na">name</span><span class="p">=</span><span class="s">"posts"</span> <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nc">Admin</span><span class="p">&gt;</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="mutation-callbacks-can-no-longer-be-used-as-event-handlers">Mutation Callbacks Can No Longer Be Used As Event Handlers</h3>

<p>In 3.0, you could use a mutation callback in an event handler, e.g. a click handler on a button. This is no longer possible, so you’ll have to call the callback manually inside a handler function:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const IncreaseLikeButton = ({ record }) =&gt; {
</span>    const diff = { likes: record.likes + 1 };
    const [update, { isLoading, error }] = useUpdate('likes', { id: record.id, data: diff, previousData: record });
    if (error) { return &lt;p&gt;ERROR&lt;/p&gt;; }
<span class="gd">-   return &lt;button disabled={isLoading} onClick={update}&gt;Like&lt;/button&gt;;
</span><span class="gi">+   return &lt;button disabled={isLoading} onClick={() =&gt; update()}&gt;Like&lt;/button&gt;;
</span><span class="err">};</span>
</code></pre></div></div>

<p>TypeScript will complain if you don’t.</p>

<p>To upgrade, check every instance of your code of the following hooks:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">useCreate</code></li>
  <li><code class="language-plaintext highlighter-rouge">useUpdate</code></li>
  <li><code class="language-plaintext highlighter-rouge">useUpdateMany</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDelete</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDeleteMany</code></li>
</ul>

<p>Note that your code will be more readable if you pass the mutation parameters to the mutation callback instead of the mutation hook, e.g.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const IncreaseLikeButton = ({ record }) =&gt; {
</span>    const diff = { likes: record.likes + 1 };
<span class="gd">-   const [update, { isLoading, error }] = useUpdate('likes', { id: record.id, data: diff, previousData: record });
</span><span class="gi">+   const [update, { isLoading, error }] = useUpdate();
+   const handleClick = () =&gt; {
+       update('likes', { id: record.id, data: diff, previousData: record });
+   };
</span>    if (error) { return &lt;p&gt;ERROR&lt;/p&gt;; }
<span class="gd">-   return &lt;button disabled={isLoading} onClick={update}&gt;Like&lt;/button&gt;;
</span><span class="gi">+   return &lt;button disabled={isLoading} onClick={handleClick}&gt;Like&lt;/button&gt;;
</span><span class="err">};</span>
</code></pre></div></div>

<h3 id="removed-the-undoable-prop-in-favor-of-mutationmode">Removed the undoable prop in Favor of mutationMode</h3>

<p>We removed the <code class="language-plaintext highlighter-rouge">undoable</code> prop as we introduced the <code class="language-plaintext highlighter-rouge">mutationMode</code> in v3. This impact the following hooks and components:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">useDeleteWithConfirmController</code></li>
  <li><code class="language-plaintext highlighter-rouge">useEditController</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDataProvider</code></li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">useMutation</code></p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">BulkDeleteButton</code></li>
  <li><code class="language-plaintext highlighter-rouge">BulkDeleteWithConfirmButton</code></li>
  <li><code class="language-plaintext highlighter-rouge">DeleteButton</code></li>
  <li><code class="language-plaintext highlighter-rouge">DeleteWithConfirmButton</code></li>
  <li><code class="language-plaintext highlighter-rouge">Edit</code></li>
</ul>

<p>Wherever you were using <code class="language-plaintext highlighter-rouge">undoable</code>, replace it with <code class="language-plaintext highlighter-rouge">mutationMode</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const {
</span>    open,
    loading,
    handleDialogOpen,
    handleDialogClose,
    handleDelete,
<span class="err">}</span> = useDeleteWithConfirmController({
    resource,
    record,
    redirect,
    onClick,
<span class="gd">-    undoable: true
</span><span class="gi">+    mutationMode: 'undoable'
</span><span class="err">});</span>
</code></pre></div></div>

<p>Or in a component:</p>
<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">export const PostEdit = (props) =&gt; (
</span><span class="gd">-    &lt;Edit {...props} undoable&gt;
</span><span class="gi">+    &lt;Edit {...props} mutationMode="undoable"&gt;
</span>        &lt;SimpleForm&gt;
            &lt;TextInput source="title" /&gt;
        &lt;/SimpleForm&gt;
    &lt;/Edit&gt;
<span class="err">);</span>
</code></pre></div></div>

<h3 id="removed-loading-and-loaded-data-provider-state-variables">Removed <code class="language-plaintext highlighter-rouge">loading</code> and <code class="language-plaintext highlighter-rouge">loaded</code> Data Provider State Variables</h3>

<p>The dataProvider hooks (<code class="language-plaintext highlighter-rouge">useGetOne</code>, etc.) return the request state. The <code class="language-plaintext highlighter-rouge">loading</code> and <code class="language-plaintext highlighter-rouge">loaded</code> state variables were changed to <code class="language-plaintext highlighter-rouge">isLoading</code> and <code class="language-plaintext highlighter-rouge">isFetching</code> respectively. The meaning has changed, too:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">loading</code> is now <code class="language-plaintext highlighter-rouge">isFetching</code></li>
  <li><code class="language-plaintext highlighter-rouge">loaded</code> is now <code class="language-plaintext highlighter-rouge">!isLoading</code></li>
</ul>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const BookDetail = ({ id }) =&gt; {
</span><span class="gd">-   const { data, error, loaded } = useGetOne('books', id);
</span><span class="gi">+   const { data, error, isLoading } = useGetOne('books', { id });
</span><span class="gd">-   if (!loaded) {
</span><span class="gi">+   if (isLoading) {
</span>        return &lt;Loading /&gt;;
    }
    if (error) {
        return &lt;Error error={error} /&gt;;
    }
    if (!data) {
        return null;
    }
    return (
        &lt;div&gt;
            &lt;h1&gt;{data.book.title}&lt;/h1&gt;
            &lt;p&gt;{data.book.author.name}&lt;/p&gt;
        &lt;/div&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>In general, you should use <code class="language-plaintext highlighter-rouge">isLoading</code>. It’s false as long as the data has never been loaded (whether from the dataProvider or from the cache).</p>

<p>The new props are actually returned by react-query’s <code class="language-plaintext highlighter-rouge">useQuery</code> hook. Check <a href="https://tanstack.com/query/v3/docs/react/reference/useQuery">their documentation</a> for more information.</p>

<h2 id="auth-provider">Auth Provider</h2>

<h3 id="renamed-loading-to-isloading">Renamed <code class="language-plaintext highlighter-rouge">loading</code> to <code class="language-plaintext highlighter-rouge">isLoading</code></h3>

<p>Some of the hooks allowing to call the <code class="language-plaintext highlighter-rouge">authProvider</code> methods are asynchronous: they return their result only when the <code class="language-plaintext highlighter-rouge">authProvider</code> promise resolves, and set the <code class="language-plaintext highlighter-rouge">loading</code> property to <code class="language-plaintext highlighter-rouge">true</code> until then.</p>

<p>In react-admin v4, this <code class="language-plaintext highlighter-rouge">loading</code> field is now renamed to <code class="language-plaintext highlighter-rouge">isLoading</code>. The <code class="language-plaintext highlighter-rouge">loaded</code> field has been removed.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { useAuthState, Loading } from 'react-admin';
</span>
const MyPage = () =&gt; {
<span class="gd">-   const { loading, authenticated } = useAuthState();
</span><span class="gi">+   const { isLoading, authenticated } = useAuthState();
</span><span class="gd">-   if (loading) {
</span><span class="gi">+   if (isLoading) {
</span>        return &lt;Loading /&gt;;
    }
    if (authenticated) {
        return &lt;AuthenticatedContent /&gt;;
    } 
    return &lt;AnonymousContent /&gt;;
<span class="err">};</span>
</code></pre></div></div>

<p>To upgrade, check every instance of your code of the following hooks:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">useAuthState</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetIdentity</code></li>
  <li><code class="language-plaintext highlighter-rouge">usePermissions</code></li>
</ul>

<h3 id="useauthenticated-signature-has-changed"><code class="language-plaintext highlighter-rouge">useAuthenticated</code> Signature has Changed</h3>

<p><code class="language-plaintext highlighter-rouge">useAuthenticated</code> uses to accept only the parameters passed to the <code class="language-plaintext highlighter-rouge">authProvider.checkAuth</code> function. It now accepts an option object with two properties:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">enabled</code>: whether it should check for an authenticated user</li>
  <li><code class="language-plaintext highlighter-rouge">params</code>: the parameters to pass to <code class="language-plaintext highlighter-rouge">checkAuth</code></li>
</ul>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- useAuthenticated('permissions.posts.can_create');
</span><span class="gi">+ useAuthenticated({ params: 'permissions.posts.can_create' })
</span></code></pre></div></div>

<h2 id="admin">Admin</h2>

<h3 id="admin-child-function-result-has-changed">Admin Child Function Result Has Changed</h3>

<p>In order to define the resources and their views according to users permissions, we used to support a function as a child of <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code>. Just like the <code class="language-plaintext highlighter-rouge">customRoutes</code>, this function had to return an array of elements.</p>

<p>You can now return a fragment and this fragment may contain <code class="language-plaintext highlighter-rouge">null</code> elements. Besides, if you don’t need to check the permissions for a resource, you may even include it as a direct child of <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">&lt;Admin&gt;
-    {permissions =&gt; [
-       &lt;Resource name="posts" {...posts} /&gt;,
-       &lt;Resource name="comments" {...comments} /&gt;,
-       permissions ? &lt;Resource name="users" {...users} /&gt; : null,
-       &lt;Resource name="tags" {...tags} /&gt;,
-   ]}
</span><span class="gi">+   &lt;Resource name="posts" {...posts} /&gt;
+   &lt;Resource name="comments" {...comments} /&gt;
+   &lt;Resource name="tags" {...tags} /&gt;
+   {permissions =&gt; (
+       &lt;&gt;
+           {permissions ? &lt;Resource name="users" {...users} /&gt; : null}
+       &lt;/&gt; 
+   )}
</span><span class="gd">&lt;/Admin&gt;
</span></code></pre></div></div>

<p>Last thing, you can return any element supported by <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code>, including the new <code class="language-plaintext highlighter-rouge">&lt;CustomRoutes&gt;</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Admin</span><span class="p">,</span> <span class="nx">Resource</span><span class="p">,</span> <span class="nx">CustomRoutes</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">MyAdmin</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Admin</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">Resource</span> <span class="na">name</span><span class="p">=</span><span class="s">"posts"</span> <span class="si">{</span><span class="p">...</span><span class="nx">posts</span><span class="si">}</span> <span class="p">/&gt;</span>
        <span class="si">{</span><span class="nx">permissions</span> <span class="o">=&gt;</span> <span class="p">(</span>
            <span class="p">&lt;&gt;</span>
                <span class="si">{</span><span class="nx">permissions</span> <span class="p">?</span> <span class="p">&lt;</span><span class="nc">Resource</span> <span class="na">name</span><span class="p">=</span><span class="s">"users"</span> <span class="si">{</span><span class="p">...</span><span class="nx">posts</span><span class="si">}</span> <span class="p">/&gt;</span> <span class="p">:</span> <span class="kc">null</span><span class="si">}</span>
                <span class="p">&lt;</span><span class="nc">CustomRoutes</span><span class="p">&gt;</span>
                    <span class="si">{</span><span class="nx">permissions</span> <span class="p">?</span> <span class="p">&lt;</span><span class="nc">Route</span> <span class="na">path</span><span class="p">=</span><span class="s">"/a_path"</span> <span class="na">element</span><span class="p">=</span><span class="si">{</span><span class="p">&lt;</span><span class="nc">ARoute</span> <span class="p">/&gt;</span><span class="si">}</span> <span class="p">/&gt;</span> <span class="p">:</span> <span class="kc">null</span><span class="si">}</span>
                    <span class="p">&lt;</span><span class="nc">Route</span> <span class="na">path</span><span class="p">=</span><span class="s">"/another_path"</span> <span class="na">element</span><span class="p">=</span><span class="si">{</span><span class="p">&lt;</span><span class="nc">AnotherRoute</span> <span class="p">/&gt;</span><span class="si">}</span> <span class="p">/&gt;</span>
                <span class="p">&lt;/</span><span class="nc">CustomRoutes</span><span class="p">&gt;</span>
            <span class="p">&lt;/&gt;</span>
        <span class="p">)</span><span class="si">}</span>
    <span class="p">&lt;/</span><span class="nc">Admin</span><span class="p">&gt;</span>
<span class="p">)</span>
</code></pre></div></div>

<h2 id="all-crud-views">All CRUD Views</h2>

<h3 id="no-more-prop-injection-in-page-components">No More Prop Injection In Page Components</h3>

<p>Page components (<code class="language-plaintext highlighter-rouge">&lt;List&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;Show&gt;</code>, etc.) used to expect to receive props (route parameters, permissions, resource name). These components don’t receive any props anymore by default. They use hooks to get the props they need from contexts or route state.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-const PostShow = (props) =&gt; (
</span><span class="gi">+const PostShow = () =&gt; (
</span><span class="gd">-   &lt;Show {...props}&gt;
</span><span class="gi">+   &lt;Show&gt;
</span>        &lt;SimpleShowLayout&gt;
            &lt;TextField source="title" /&gt;
        &lt;/SimpleShowLayout&gt;
    &lt;/Show&gt;
<span class="err">);</span>
</code></pre></div></div>

<p>If you need to access the permissions previously passed as props, you need to call the <code class="language-plaintext highlighter-rouge">usePermissions</code> hook instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gi">+import { usePermissions } from 'react-admin';
</span>
-const PostShow = ({ permissions, ...props }) =&gt; {
<span class="gi">+const PostShow = () =&gt; {
+   const permissions = usePermissions();
</span>    return (
<span class="gd">-       &lt;Show {...props}&gt;
</span><span class="gi">+       &lt;Show&gt;
</span>            &lt;SimpleShowLayout&gt;
                &lt;TextField source="title" /&gt;
                {permissions === 'admin' &amp;&amp;
                    &lt;NumberField source="nb_views" /&gt;
                }
            &lt;/SimpleShowLayout&gt;
        &lt;/Show&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>If you need to access the <code class="language-plaintext highlighter-rouge">hasList</code> and other flags related to resource configuration, use the <code class="language-plaintext highlighter-rouge">useResourceConfiguration</code> hook instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gi">+const { useResourceDefinition } from 'react-admin';
</span>
-const PostShow = ({ hasEdit, ...props }) =&gt; {
<span class="gi">+const PostShow = () =&gt; {
+   const { hasEdit } = useResourceDefinition();
</span>    return (
        &lt;Show actions={hasEdit ? &lt;ShowActions /&gt; : null}&gt;
            &lt;SimpleShowLayout&gt;
                &lt;TextField source="title" /&gt;
            &lt;/SimpleShowLayout&gt;
        &lt;/Show&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>If you need to access a route parameter, use react-router’s <code class="language-plaintext highlighter-rouge">useParams</code> hook instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gi">+import { useParams } from 'react-router-dom';
</span>
-const PostShow = ({ id, ...props }) =&gt; {
<span class="gi">+const PostShow = () =&gt; {
+   const { id } = useParams();
</span>    return (
        &lt;Show title={`Post #${id}`}&gt;
            &lt;SimpleShowLayout&gt;
                &lt;TextField source="title" /&gt;
            &lt;/SimpleShowLayout&gt;
        &lt;/Show&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>We used to inject a <code class="language-plaintext highlighter-rouge">syncWithLocation</code> prop set to <code class="language-plaintext highlighter-rouge">true</code> to the <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code> components used in a <code class="language-plaintext highlighter-rouge">&lt;Resource&gt;</code>. This instructed the <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code> to synchronize its parameters (such as pagination, sorting and filters) with the browser location.</p>

<p>As we removed the props injection, we enabled this synchronization by default for all <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code>, used in a <code class="language-plaintext highlighter-rouge">&lt;Resource&gt;</code> or not. As a consequence, we also inverted this prop and renamed it <code class="language-plaintext highlighter-rouge">disableSyncWithLocation</code>. This doesn’t change anything if you only used <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code> components inside <code class="language-plaintext highlighter-rouge">&lt;Resource list&gt;</code>.</p>

<p>However, if you had multiple <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code> components inside used a single page, or if you used <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code> outside of a <code class="language-plaintext highlighter-rouge">&lt;Resource&gt;</code>, you now have to explicitly opt out the synchronization of the list parameters with the browser location:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyList = () =&gt; (
</span><span class="gd">-    &lt;List&gt;
</span><span class="gi">+    &lt;List disableSyncWithLocation&gt;
</span>        // ...
    &lt;/List&gt;
<span class="err">)</span>
</code></pre></div></div>

<h3 id="removed-the-basepath-prop">Removed The <code class="language-plaintext highlighter-rouge">basePath</code> Prop</h3>

<p>Many components received, or passed down, a prop named <code class="language-plaintext highlighter-rouge">basePath</code>. This was necessary to build internal routes that worked when react-admin was used under a sub-path.</p>

<p>React-admin v4 now uses a context to keep the app basePath, so the <code class="language-plaintext highlighter-rouge">basePath</code> prop is no longer necessary. Every component that received it doesn’t need it anymore. You can safely remove it from your code.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-const PostEditActions = ({ basePath }) =&gt; (
</span><span class="gi">+const PostEditActions = () =&gt; (
</span>    &lt;TopToolbar&gt;
<span class="gd">-       &lt;ShowButton basePath={basePath} /&gt;
</span><span class="gi">+       &lt;ShowButton /&gt;
</span>        {/* Add your custom actions */}
        &lt;Button color="primary" onClick={customAction}&gt;Custom Action&lt;/Button&gt;
    &lt;/TopToolbar&gt;
<span class="err">);</span>
</code></pre></div></div>

<p>Keeping the <code class="language-plaintext highlighter-rouge">basePath</code> prop may result in unrecognized DOM props warnings, but your app will still work flawlessly even if you don’t remove them. If you’re using TypeScript, your code will not compile unless you remove all the <code class="language-plaintext highlighter-rouge">basePath</code> props.</p>

<p>When a function (not a component) received the <code class="language-plaintext highlighter-rouge">basePath</code> as argument, it now receives the <code class="language-plaintext highlighter-rouge">resource</code> instead. For instance, the <code class="language-plaintext highlighter-rouge">&lt;Datagrid rowClick&gt;</code> prop used to accept a function:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-   &lt;Datagrid rowClick={(id, basePath, record) =&gt; {/* ... */}}&gt;
</span><span class="gi">+   &lt;Datagrid rowClick={(id, resource, record) =&gt; {/* ... */}}&gt;
</span></code></pre></div></div>

<p>In most cases, the injected <code class="language-plaintext highlighter-rouge">basePath</code> was the <code class="language-plaintext highlighter-rouge">resource</code> with a leading slash (e.g. basename: <code class="language-plaintext highlighter-rouge">/posts</code>, resource: <code class="language-plaintext highlighter-rouge">posts</code>).</p>

<h3 id="onsuccess-and-onfailure-props-have-moved"><code class="language-plaintext highlighter-rouge">onSuccess</code> And <code class="language-plaintext highlighter-rouge">onFailure</code> Props Have Moved</h3>

<p>If you need to override the success or failure side effects of a component, you now have to use the <code class="language-plaintext highlighter-rouge">queryOptions</code> (for query side effects) or <code class="language-plaintext highlighter-rouge">mutationOptions</code> (for mutation side effects).</p>

<p>For instance, here is how to override the side effects for the <code class="language-plaintext highlighter-rouge">getOne</code> query in a <code class="language-plaintext highlighter-rouge">&lt;Show&gt;</code> component:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostShow = () =&gt; {
</span>    const onSuccess = () =&gt; {
        // do something
    };
    const onFailure = () =&gt; {
        // do something
    };
    return (
        &lt;Show 
<span class="gd">-           onSuccess={onSuccess}
-           onFailure={onFailure}
</span><span class="gi">+           queryOptions={{
+               onSuccess: onSuccess,
+               onError: onFailure
+           }}
</span>        &gt;
            &lt;SimpleShowLayout&gt;
                &lt;TextField source="title" /&gt;
            &lt;/SimpleShowLayout&gt;
        &lt;/Show&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>Here is how to customize side effects on the <code class="language-plaintext highlighter-rouge">update</code> mutation in <code class="language-plaintext highlighter-rouge">&lt;Edit&gt;</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostEdit = () =&gt; {
</span>    const onSuccess = () =&gt; {
        // do something
    };
    const onFailure = () =&gt; {
        // do something
    };
    return (
        &lt;Edit 
<span class="gd">-           onSuccess={onSuccess}
-           onFailure={onFailure}
</span><span class="gi">+           mutationOptions={{
+               onSuccess: onSuccess,
+               onError: onFailure
+           }}
</span>        &gt;
            &lt;SimpleForm&gt;
                &lt;TextInput source="title" /&gt;
            &lt;/SimpleForm&gt;
        &lt;/Show&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>Here is how to customize side effects on the <code class="language-plaintext highlighter-rouge">create</code> mutation in <code class="language-plaintext highlighter-rouge">&lt;Create&gt;</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostCreate = () =&gt; {
</span>    const onSuccess = () =&gt; {
        // do something
    };
    const onFailure = () =&gt; {
        // do something
    };
    return (
        &lt;Create 
<span class="gd">-           onSuccess={onSuccess}
-           onFailure={onFailure}
</span><span class="gi">+           mutationOptions={{
+               onSuccess: onSuccess,
+               onError: onFailure
+           }}
</span>        &gt;
            &lt;SimpleForm&gt;
                &lt;TextInput source="title" /&gt;
            &lt;/SimpleForm&gt;
        &lt;/Create&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>Note that the <code class="language-plaintext highlighter-rouge">onFailure</code> prop was renamed to <code class="language-plaintext highlighter-rouge">onError</code> in the options, to match the react-query convention.</p>

<p><strong>Tip</strong>: <code class="language-plaintext highlighter-rouge">&lt;Edit&gt;</code> also has a <code class="language-plaintext highlighter-rouge">queryOption</code> prop allowing you to specify custom success and error side effects for the <code class="language-plaintext highlighter-rouge">getOne</code> query.</p>

<p>The change concerns the following components:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">useCreateController</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Create&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;CreateBase&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">useEditController</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Edit&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;EditBase&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">useShowController</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Show&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;ShowBase&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDeleteWithUndoController</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDeleteWithConfirmController</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;DeleteButton&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;BulkDeleteButton&gt;</code></li>
</ul>

<p>It also affects the <code class="language-plaintext highlighter-rouge">save</code> callback returned by the <code class="language-plaintext highlighter-rouge">useSaveContext</code> hook:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyButton = () =&gt; {
</span>    const { save, saving } = useSaveContext();
    const notify = useNotify();

    const handleClick = () =&gt; {
        save({ value: 123 }, {
<span class="gd">-            onFailure: (error) =&gt; {
</span><span class="gi">+            onError: (error) =&gt; {
</span>                notify(error.message, { type: 'error' });
            },
        });
    };

    return &lt;button onClick={handleClick}&gt;Save&lt;/button&gt;
<span class="err">}</span>
</code></pre></div></div>

<h3 id="onsuccess-callback-on-dataprovider-hooks-and-components-has-a-new-signature"><code class="language-plaintext highlighter-rouge">onSuccess</code> Callback On DataProvider Hooks And Components Has A New Signature</h3>

<p>The <code class="language-plaintext highlighter-rouge">onSuccess</code> callback used to receive the <em>response</em> from the dataProvider. On specialized hooks, it now receives the <code class="language-plaintext highlighter-rouge">data</code> property of the response instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const [update] = useUpdate();
const handleClick = () =&gt; {
</span>    update(
        'posts',
        { id: 123, data: { likes: 12 } },
        {
<span class="gd">-           onSuccess: ({ data }) =&gt; {
</span><span class="gi">+           onSuccess: (data) =&gt; {
</span>                // do something with data
            }
        }
    );
<span class="err">};</span>
</code></pre></div></div>

<p>The change concerns the following components:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">useCreate</code></li>
  <li><code class="language-plaintext highlighter-rouge">useCreateController</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Create&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;CreateBase&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">useUpdate</code></li>
  <li><code class="language-plaintext highlighter-rouge">useEditController</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Edit&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;EditBase&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">useGetOne</code></li>
  <li><code class="language-plaintext highlighter-rouge">useShowController</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Show&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;ShowBase&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDelete</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDeleteWithUndoController</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDeleteWithConfirmController</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;DeleteButton&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">useDeleteMany</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;BulkDeleteButton&gt;</code></li>
</ul>

<h2 id="list-views">List Views</h2>

<h3 id="list-ids-prop-and-recordmap-type-are-gone">List <code class="language-plaintext highlighter-rouge">ids</code> Prop And <code class="language-plaintext highlighter-rouge">RecordMap</code> Type Are Gone</h3>

<p>Contrary to <code class="language-plaintext highlighter-rouge">dataProvider.getList</code>, <code class="language-plaintext highlighter-rouge">useGetList</code> used to return data under the shape of a record map. This is no longer the case: <code class="language-plaintext highlighter-rouge">useGetList</code> returns an array of records.</p>

<p>So the <code class="language-plaintext highlighter-rouge">RecordMap</code> type is no longer necessary and was removed. TypeScript compilation will fail if you continue using it. You should update your code so that it works with an array of records instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useGetList, RecordMap } from 'react-admin';
</span><span class="gi">+import { useGetList, RaRecord } from 'react-admin';
</span>
const PostListContainer = () =&gt; {
<span class="gd">-   const { data, ids, loading } = useGetList(
-      'posts',
-      { page: 1, perPage: 10 },
-      { field: 'published_at', order: 'DESC' },
-   );
-   return loading ? null: &lt;PostListDetail data={data} ids={ids} /&gt;
</span><span class="gi">+   const { data, isLoading } = useGetList(
+      'posts',
+      {
+         pagination: { page: 1, perPage: 10 },
+         sort: { field: 'published_at', order: 'DESC' },
+      }
+   );
+   return isLoading ? null: &lt;PostListDetail data={data} /&gt;
</span><span class="err">};</span>

<span class="gd">-const PostListDetail = ({ ids, data }: { ids: string[], data: RecordMap }) =&gt; {
</span><span class="gi">+const PostListDetail = ({ data }: { data: RaRecord[] }) =&gt; {
</span><span class="gd">-   return &lt;&gt;{ids.map(id =&gt; &lt;span key={id}&gt;{data[id].title}&lt;/span&gt;)}&lt;/&gt;;
</span><span class="gi">+   return &lt;&gt;{data.map(record =&gt; &lt;span key={record.id}&gt;{record.title}&lt;/span&gt;)}&lt;/&gt;;
</span><span class="err">};</span>
</code></pre></div></div>

<h3 id="uselistcontext-no-longer-returns-an-ids-prop"><code class="language-plaintext highlighter-rouge">useListContext</code> No Longer Returns An <code class="language-plaintext highlighter-rouge">ids</code> Prop</h3>

<p>The <code class="language-plaintext highlighter-rouge">ListContext</code> used to return two props for the list data: <code class="language-plaintext highlighter-rouge">data</code> and <code class="language-plaintext highlighter-rouge">ids</code>. To render the list data, you had to iterate over the <code class="language-plaintext highlighter-rouge">ids</code>.</p>

<p>Starting with react-admin v4, <code class="language-plaintext highlighter-rouge">useListContext</code> only returns a <code class="language-plaintext highlighter-rouge">data</code> prop, and it is now an array. This means you have to update all your code that relies on <code class="language-plaintext highlighter-rouge">ids</code> from a <code class="language-plaintext highlighter-rouge">ListContext</code>. Here is an example for a custom list iterator using cards:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import * as React from 'react';
import { useListContext, List, TextField, DateField, ReferenceField, EditButton } from 'react-admin';
import { Card, CardActions, CardContent, CardHeader, Avatar } from '@mui/material';
import PersonIcon from '@mui/icons-material/Person';
</span>
const CommentGrid = () =&gt; {
<span class="gd">-   const { data, ids, loading } = useListContext();
</span><span class="gi">+   const { data, isLoading } = useListContext();
</span><span class="gd">-   if (loading) return null;
</span><span class="gi">+   if (isLoading) return null;
</span>    return (
        &lt;div style={{ margin: '1em' }}&gt;
<span class="gd">-       {ids.map(id =&gt;
</span><span class="gi">+       {data.map(record =&gt;
</span><span class="gd">-           &lt;Card key={id} style={cardStyle}&gt;
</span><span class="gi">+           &lt;Card key={record.id} style={cardStyle}&gt;
</span>                &lt;CardHeader
<span class="gd">-                   title={&lt;TextField record={data[id]} source="author.name" /&gt;}
</span><span class="gi">+                   title={&lt;TextField record={record} source="author.name" /&gt;}
</span><span class="gd">-                   subheader={&lt;DateField record={data[id]} source="created_at" /&gt;}
</span><span class="gi">+                   subheader={&lt;DateField record={record} source="created_at" /&gt;}
</span>                    avatar={&lt;Avatar icon={&lt;PersonIcon /&gt;} /&gt;}
                /&gt;
                &lt;CardContent&gt;
<span class="gd">-                   &lt;TextField record={data[id]} source="body" /&gt;
</span><span class="gi">+                   &lt;TextField record={record} source="body" /&gt;
</span>                &lt;/CardContent&gt;
                &lt;CardActions style={{ textAlign: 'right' }}&gt;
<span class="gd">-                   &lt;EditButton resource="posts" record={data[id]} /&gt;
</span><span class="gi">+                   &lt;EditButton resource="posts" record={record} /&gt;
</span>                &lt;/CardActions&gt;
            &lt;/Card&gt;
        )}
        &lt;/div&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<h3 id="list-bulkactionbuttons-prop-moved-to-datagrid">List <code class="language-plaintext highlighter-rouge">bulkActionButtons</code> Prop Moved To Datagrid</h3>

<p>The <code class="language-plaintext highlighter-rouge">Datagrid</code> is now responsible for managing the bulk actions component.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { List, Datagrid } from 'react-admin'; 
</span>
const PostList = () =&gt; (
<span class="gd">-    &lt;List bulkActionButtons={&lt;PostBulkActionButtons /&gt;}&gt;
</span><span class="gi">+    &lt;List&gt;
</span><span class="gd">-        &lt;Datagrid&gt;
</span><span class="gi">+        &lt;Datagrid bulkActionButtons={&lt;PostBulkActionButtons /&gt;}&gt;        
</span>            ...
        &lt;/Datagrid&gt;
    &lt;/List&gt;
<span class="err">);</span>
</code></pre></div></div>

<h3 id="datagrid-hasbulkactions-prop-has-been-removed">Datagrid <code class="language-plaintext highlighter-rouge">hasBulkActions</code> Prop Has Been Removed</h3>

<p>As a consequence of moving <code class="language-plaintext highlighter-rouge">bulkActionButtons</code> prop from <code class="language-plaintext highlighter-rouge">List</code> to <code class="language-plaintext highlighter-rouge">Datagrid</code>, <code class="language-plaintext highlighter-rouge">hasBulkActions</code> prop is now handled internaly by the <code class="language-plaintext highlighter-rouge">Datagrid</code> component, but it is still being passed down to its header and body components.
Just set <code class="language-plaintext highlighter-rouge">Datagrid</code>’s <code class="language-plaintext highlighter-rouge">bulkActionButtons</code> to <code class="language-plaintext highlighter-rouge">false</code> to have the same behavior.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { List, Datagrid } from 'react-admin'; 
</span>
const PostList = () =&gt; (
    &lt;List&gt;
<span class="gd">-        &lt;Datagrid hasBulkActions={false}&gt;
</span><span class="gi">+        &lt;Datagrid bulkActionButtons={false}&gt;        
</span>            ...
        &lt;/Datagrid&gt;
    &lt;/List&gt;
<span class="err">);</span>
</code></pre></div></div>

<h3 id="currentsort-renamed-to-sort"><code class="language-plaintext highlighter-rouge">currentSort</code> Renamed To <code class="language-plaintext highlighter-rouge">sort</code></h3>

<p>If one of your components displays the current sort order, it probably uses the injected <code class="language-plaintext highlighter-rouge">currentSort</code> prop (or reads it from the <code class="language-plaintext highlighter-rouge">ListContext</code>). This prop has been renamed to <code class="language-plaintext highlighter-rouge">sort</code> in v4.</p>

<p>Upgrade your code by replacing <code class="language-plaintext highlighter-rouge">currentSort</code> with <code class="language-plaintext highlighter-rouge">sort</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { useListContext } from 'react-admin';
</span>
const BookListIterator = () =&gt; {
<span class="gd">-    const { data, loading, currentSort } = useListContext();
</span><span class="gi">+    const { data, isLoading, sort } = useListContext();
</span>
    if (loading) return &lt;Loading /&gt;;
    if (data.length === 0) return &lt;p&gt;No data&lt;/p&gt;;

    return (&lt;&gt;
<span class="gd">-       &lt;div&gt;Books sorted by {currentSort.field}&lt;/div&gt;
</span><span class="gi">+       &lt;div&gt;Books sorted by {sort.field}&lt;/div&gt;
</span>        &lt;ul&gt;
            {data.map(book =&gt;
                &lt;li key={book.id}&gt;{book.title}&lt;/li&gt;
            )}
        &lt;/ul&gt;
    &lt;/&gt;);
<span class="err">};</span>
</code></pre></div></div>

<p>The same happens for <code class="language-plaintext highlighter-rouge">&lt;Datagrid&gt;</code>: when used in standalone, it used to accept a <code class="language-plaintext highlighter-rouge">currentSort</code> prop, but now it only accepts a <code class="language-plaintext highlighter-rouge">sort</code> prop.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-&lt;Datagrid data={data} currentSort={{ field: 'id', order: 'DESC' }}&gt;
</span><span class="gi">+&lt;Datagrid data={data} sort={{ field: 'id', order: 'DESC' }}&gt;
</span>    &lt;TextField source="id" /&gt;
    &lt;TextField source="title" /&gt;
    &lt;TextField source="author" /&gt;
    &lt;TextField source="year" /&gt;
<span class="gd">&lt;/Datagrid&gt;
</span></code></pre></div></div>

<h3 id="setsort-signature-changed"><code class="language-plaintext highlighter-rouge">setSort()</code> Signature Changed</h3>

<p>Some react-admin components have access to a <code class="language-plaintext highlighter-rouge">setSort()</code> callback to sort the current list of items. This callback is also present in the <code class="language-plaintext highlighter-rouge">ListContext</code>. Its signature has changed:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-setSort(field: string, order: 'ASC' | 'DESC');
</span><span class="gi">+setSort({ field: string, order: 'ASC' | 'DESC' });
</span></code></pre></div></div>

<p>This impacts your code if you built a custom sort component:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const SortButton = () =&gt; {
</span>    const { sort, setSort } = useListContext();
    const handleChangeSort = (event) =&gt; {
        const field = event.currentTarget.dataset.sort;
<span class="gd">-       setSort(
-           field,
-           field === sort.field ? inverseOrder(sort.order) : 'ASC',
-       });
</span><span class="gi">+       setSort({
+           field,
+           order: field === sort.field ? inverseOrder(sort.order) : 'ASC',
+       });
</span>        setAnchorEl(null);
    };

    // ...
<span class="err">};</span>
</code></pre></div></div>

<h3 id="no-more-props-injection-in-custom-pagination-and-empty-components">No More props injection in custom Pagination and Empty components</h3>

<p>The <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code> component renders a Pagination component when there are records to display, and an Empty component otherwise. You can customize these components by passing your own with the <code class="language-plaintext highlighter-rouge">pagination</code> and <code class="language-plaintext highlighter-rouge">empty</code>props.</p>

<p><code class="language-plaintext highlighter-rouge">&lt;List&gt;</code> used to inject <code class="language-plaintext highlighter-rouge">ListContext</code> props (<code class="language-plaintext highlighter-rouge">data</code>, <code class="language-plaintext highlighter-rouge">isLoaded</code>, etc.) to the Pagination component. In v4, the component rendered by <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code> no longer receive these props. They must grab them from the ListContext instead.</p>

<p>This means you’ll have to do a few changes if you use a custom Pagination component in a List:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { Button, Toolbar } from '@mui/material';
import ChevronLeft from '@mui/icons-material/ChevronLeft';
import ChevronRight from '@mui/icons-material/ChevronRight';
</span><span class="gi">+import { useListContext } from 'react-admin';
</span>
-const PostPagination = (props) =&gt; {
<span class="gi">+const PostPagination = () =&gt; {
</span><span class="gd">-   const { page, perPage, total, setPage } = props;
</span><span class="gi">+   const { page, perPage, total, setPage } = useListContext();
</span>    const nbPages = Math.ceil(total / perPage) || 1;
    return (
        nbPages &gt; 1 &amp;&amp;
            &lt;Toolbar&gt;
                {page &gt; 1 &amp;&amp;
                    &lt;Button color="primary" key="prev" onClick={() =&gt; setPage(page - 1)}&gt;
                        &lt;ChevronLeft /&gt;
                        Prev
                    &lt;/Button&gt;
                }
                {page !== nbPages &amp;&amp;
                    &lt;Button color="primary" key="next" onClick={() =&gt; setPage(page + 1)}&gt;
                        Next
                        &lt;ChevronRight /&gt;
                    &lt;/Button&gt;
                }
            &lt;/Toolbar&gt;
    );
<span class="err">}</span>

<span class="p">export const PostList = () =&gt; (
</span>    &lt;List pagination={&lt;PostPagination /&gt;}&gt;
        ...
    &lt;/List&gt;
<span class="err">);</span>
</code></pre></div></div>

<h3 id="usegetmainlist-was-removed"><code class="language-plaintext highlighter-rouge">useGetMainList</code> Was Removed</h3>

<p><code class="language-plaintext highlighter-rouge">useGetMainList</code> was a modified version of <code class="language-plaintext highlighter-rouge">useGetList</code> designed to keep previous data on screen upon navigation. As <a href="https://react-query-v3.tanstack.com/guides/paginated-queries#better-paginated-queries-with-keeppreviousdata">this is now supported natively by react-query</a>, this hook is no longer necessary and has been removed. Use <code class="language-plaintext highlighter-rouge">useGetList()</code> instead.</p>

<h3 id="useunselectall-syntax-changed"><code class="language-plaintext highlighter-rouge">useUnselectAll</code> Syntax Changed</h3>

<p>You must now pass the resource name when calling the hook:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { useUnselectAll } from 'react-admin';
</span>
const UnselectAllButton = () =&gt; {
<span class="gd">-   const unselectAll = useUnselectAll();
</span><span class="gi">+   const unselectAll = useUnselectAll('posts');
</span>    const handleClick = () =&gt; {
<span class="gd">-       unselectAll('posts');
</span><span class="gi">+       unselectAll();
</span>    }
    return &lt;button onClick={handleClick}&gt;Unselect all&lt;/button&gt;;
<span class="err">};</span>
</code></pre></div></div>

<h2 id="forms">Forms</h2>

<p><code class="language-plaintext highlighter-rouge">react-final-form</code> has been replaced by <code class="language-plaintext highlighter-rouge">react-hook-form</code>.</p>

<h3 id="initialvalues-is-now-defaultvalues"><code class="language-plaintext highlighter-rouge">initialValues</code> Is Now <code class="language-plaintext highlighter-rouge">defaultValues</code></h3>

<p><code class="language-plaintext highlighter-rouge">&lt;FormWithRedirect&gt;</code> used to accept <a href="https://final-form.org/docs/react-final-form/types/FormProps"><code class="language-plaintext highlighter-rouge">react-final-form</code> <code class="language-plaintext highlighter-rouge">&lt;Form&gt;</code> props</a>. It now accepts <a href="https://react-hook-form.com/docs/useform"><code class="language-plaintext highlighter-rouge">react-hook-form</code> <code class="language-plaintext highlighter-rouge">useForm</code> props</a>. This also affects the other form components (<code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;TabbedForm&gt;</code>, etc.)</p>

<p>The most commonly used prop is probably <code class="language-plaintext highlighter-rouge">initialValues</code>, which is now named <code class="language-plaintext highlighter-rouge">defaultValues</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostCreate = () =&gt; (
</span>    &lt;Create&gt;
        &lt;SimpleForm
<span class="gd">-            initialValues={{ title: 'A default title' }}
</span><span class="gi">+            defaultValues={{ title: 'A default title' }}
</span>        &gt;
            ...
        &lt;/SimpleForm&gt;
    &lt;/Create&gt;
<span class="err">)</span>
</code></pre></div></div>

<p>We kept the <code class="language-plaintext highlighter-rouge">validate</code> function prop, which we automatically translate to a custom <a href="https://react-hook-form.com/docs/useform#validationResolver"><code class="language-plaintext highlighter-rouge">react-hook-form</code> <code class="language-plaintext highlighter-rouge">resolver</code></a>. So even if it’s not technically a react-hook-form prop, you can still use <code class="language-plaintext highlighter-rouge">validate</code> as before.</p>

<p>This also means you can now use <a href="https://github.com/jquense/yup"><code class="language-plaintext highlighter-rouge">yup</code></a>, <a href="https://github.com/colinhacks/zod"><code class="language-plaintext highlighter-rouge">zod</code></a>, <a href="https://github.com/sideway/joi"><code class="language-plaintext highlighter-rouge">joi</code></a>, <a href="https://github.com/ianstormtaylor/superstruct">superstruct</a>, <a href="https://github.com/ealush/vest">vest</a> or any <a href="https://react-hook-form.com/docs/useform#validationResolver">resolver</a> supported by <code class="language-plaintext highlighter-rouge">react-hook-form</code> to apply schema validation.</p>

<h3 id="input-level-validation-now-triggers-on-submit">Input-Level Validation Now Triggers on Submit</h3>

<p>With <code class="language-plaintext highlighter-rouge">react-hook-form</code>, the default mode for form validation is ‘onSubmit’. This means the validation errors only appear once the user submits the form. If you want to have input level validation triggered before submission (e.g. on blur), you can try a different <a href="https://react-hook-form.com/docs/useform/">validation strategy</a> by passing a <code class="language-plaintext highlighter-rouge">mode</code> prop to the form:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// This will trigger input validation onBlur</span>
<span class="p">&lt;</span><span class="nc">SimpleForm</span> <span class="na">mode</span><span class="p">=</span><span class="s">"onBlur"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nc">TextInput</span> <span class="na">source</span><span class="p">=</span><span class="s">"name"</span> <span class="na">validate</span><span class="p">=</span><span class="si">{</span><span class="nx">maxLength</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span> <span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nc">SimpleForm</span><span class="p">&gt;</span>
</code></pre></div></div>

<h3 id="validation-form-level--input-level-are-mutually-exclusive">Validation: Form Level &amp; Input Level Are Mutually Exclusive</h3>

<p>With <code class="language-plaintext highlighter-rouge">react-hook-form</code>, you can’t have both form level validation and input level validation. This is because form level validation is meant to be used for <a href="https://react-hook-form.com/docs/useform#validationResolver">schema based validation</a>.</p>

<p>If you used form level validation to run complex checks for multiple input values combinations, you can use a schema library such as <a href="https://github.com/jquense/yup">yup</a>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { BooleanInput, NumberInput, SimpleForm } from 'react-admin';
</span><span class="gi">+import { yupResolver } from '@hookform/resolvers/yup';
</span><span class="gd">-const validateForm = values =&gt; {
-    if (values.isBig &amp;&amp; values.count &lt; 6) {
-        return {
-            count: 'Must be greater than 5'
-        }
-    }
-
-    if (values.count &lt; 0) {
-        return {
-            count: 'Must be greater than 0'
-        }
-    }
-}
</span><span class="gi">+const schema = object({
+  isBig: boolean(),
+  count: number().when('isBig', {
+    is: true,
+    then: (schema) =&gt; schema.min(5),
+    otherwise: (schema) =&gt; schema.min(0),
+  }),
+});
</span>
const MyForm = () =&gt; (
    &lt;SimpleForm
<span class="gd">-        validate={validateForm}
</span><span class="gi">+        resolver={yupResolver(schema)}
</span>    &gt;
        &lt;BooleanInput source="isBig" /&gt;
        &lt;NumberInput source="count" /&gt;
    &lt;/SimpleForm&gt;
<span class="err">)</span>
</code></pre></div></div>

<h3 id="simpleform-and-tabbedform-no-longer-accept-margin-and-variant"><code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;TabbedForm&gt;</code> No Longer Accept <code class="language-plaintext highlighter-rouge">margin</code> and <code class="language-plaintext highlighter-rouge">variant</code></h3>

<p>Just like Material UI, we don’t provide a way to specify those props at the form level. Instead, you can either set those props on the inputs or leverage the Material UI <a href="https://mui.com/material-ui/customization/theme-components/">component overrides through theme</a> if you need to change them globally:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostCreate = () =&gt; (
</span>    &lt;Create&gt;
<span class="gd">-        &lt;SimpleForm margin="normal" variant="outlined"&gt;
</span><span class="gi">+        &lt;SimpleForm&gt;
</span><span class="gd">-            &lt;TextInput source="title" /&gt;
</span><span class="gi">+            &lt;TextInput source="title" margin="normal" variant="outlined" /&gt;
</span>        &lt;/SimpleForm&gt;
    &lt;/Create&gt;
<span class="err">)</span>
</code></pre></div></div>

<p>You have several options when leveraging the <a href="https://mui.com/material-ui/customization/theme-components/">theme component overrides</a>:</p>

<ul>
  <li>Provide your own default props for Material UI components such as the <code class="language-plaintext highlighter-rouge">TextField</code>:
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">myTheme</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1">// Name of the component</span>
      <span class="na">MuiTextField</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">defaultProps</span><span class="p">:</span> <span class="p">{</span>
              <span class="na">margin</span><span class="p">:</span> <span class="dl">'</span><span class="s1">normal</span><span class="dl">'</span><span class="p">,</span>
              <span class="na">variant</span><span class="p">:</span> <span class="dl">'</span><span class="s1">outlined</span><span class="dl">'</span><span class="p">,</span>
          <span class="p">},</span>
      <span class="p">},</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>Provide your own default props for react-admin components such as the <code class="language-plaintext highlighter-rouge">TextInput</code>:
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">myTheme</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1">// Name of the component</span>
      <span class="na">RaTextInput</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">defaultProps</span><span class="p">:</span> <span class="p">{</span>
              <span class="na">margin</span><span class="p">:</span> <span class="dl">'</span><span class="s1">normal</span><span class="dl">'</span><span class="p">,</span>
              <span class="na">variant</span><span class="p">:</span> <span class="dl">'</span><span class="s1">outlined</span><span class="dl">'</span><span class="p">,</span>
          <span class="p">},</span>
      <span class="p">},</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="no-more-props-injection-in-simpleform-tabbedform-and-filterform">No More Props Injection In <code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;TabbedForm&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;FilterForm&gt;</code></h3>

<p>The form components used to clone their children, inspect their props to handle labels and inject the <code class="language-plaintext highlighter-rouge">margin</code> and <code class="language-plaintext highlighter-rouge">variant</code> props.</p>

<p>This is no longer the case and makes custom layout easier.</p>

<h3 id="simpleform-and-tabbedform-no-longer-clone-their-children"><code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;TabbedForm&gt;</code> No Longer Clone Their Children</h3>

<p>This makes custom layouts easier as you don’t need to worry about passing props through your intermediate components anymore:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-const LineWrapper = ({ children, ...props }) =&gt; (
-    &lt;div style="display: flex"&gt;
-        {Children.map(children, child =&gt; cloneElement(child, { ...props, ...child.props }))}
-    &lt;/div&gt;
-)
</span>
const PostCreate = () =&gt; (
    &lt;Create&gt;
        &lt;SimpleForm&gt;
<span class="gd">-            &lt;LineWrapper&gt;
</span><span class="gi">+            &lt;div style="display: flex"&gt;
</span>                 &lt;TextInput source="title" /&gt;
<span class="gd">-            &lt;/LineWrapper&gt;
</span><span class="gi">+            &lt;/div&gt;
</span>        &lt;/SimpleForm&gt;
    &lt;/Create&gt;
<span class="err">)</span>
</code></pre></div></div>

<h3 id="field-components-must-be-wrapped-with-labeled-in-simpleform">Field components must be wrapped with <code class="language-plaintext highlighter-rouge">&lt;Labeled&gt;</code> in <code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code></h3>

<p>Field components don’t have a label by default anymore and must be wrapped with <code class="language-plaintext highlighter-rouge">&lt;Labeled&gt;</code> when used within a <code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostEdit = () =&gt; (
</span>    &lt;Edit&gt;
        &lt;SimpleForm&gt;
	    &lt;TextInput source="title"&gt;
<span class="gd">-	    &lt;ReferenceField source="author_id" reference="users"&gt;
-	        &lt;TextField source="username" /&gt;
-	    &lt;/ReferenceField&gt;
</span><span class="gi">+           &lt;Labeled label="Author"&gt;
+	        &lt;ReferenceField source="author_id" reference="users"&gt;
+	            &lt;TextField source="username" /&gt;
+	        &lt;/ReferenceField&gt;
+           &lt;/Labeled&gt;
</span>        &lt;/SimpleForm&gt;
    &lt;/Edit&gt;
<span class="err">)</span>
</code></pre></div></div>

<h3 id="simpleformiterator-does-not-accept-the-transitionprops-prop-anymore"><code class="language-plaintext highlighter-rouge">&lt;SimpleFormIterator&gt;</code> Does Not Accept the <code class="language-plaintext highlighter-rouge">TransitionProps</code> prop anymore</h3>

<p>Transitions were causing a lot of issues so we had to remove them for now, until we find a good solution.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { ArrayInput, SimpleFormIterator, TextInput } from 'react-admin';
</span>
&lt;ArrayInput source="backlinks"&gt;
<span class="gd">-    &lt;SimpleFormIterator TransitionProps={{ timeout: 400 }}&gt;
</span><span class="gi">+    &lt;SimpleFormIterator&gt;
</span>        &lt;TextInput source="title" /&gt;
    &lt;/SimpleFormIterator&gt;
<span class="gd">&lt;/ArrayInput&gt;
</span></code></pre></div></div>

<h3 id="formwithredirect-has-been-renamed-to-form"><code class="language-plaintext highlighter-rouge">&lt;FormWithRedirect&gt;</code> Has Been Renamed to <code class="language-plaintext highlighter-rouge">&lt;Form&gt;</code></h3>

<p>The form components don’t handle redirection anymore, as redirections are now handled in side effects (<code class="language-plaintext highlighter-rouge">&lt;Create mutationOptions&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;Edit mutationOptions&gt;</code>). As a consequence, the <code class="language-plaintext highlighter-rouge">&lt;FormWithRedirect&gt;</code> has been renamed to <code class="language-plaintext highlighter-rouge">&lt;Form&gt;</code>.</p>

<p>To upgrade, replace all occurrences of <code class="language-plaintext highlighter-rouge">&lt;FormWithRedirect&gt;</code> with  <code class="language-plaintext highlighter-rouge">&lt;Form&gt;</code>.</p>

<p>Also, the <code class="language-plaintext highlighter-rouge">render</code> prop has been removed, and the form content is now passed as child of the <code class="language-plaintext highlighter-rouge">&lt;Form&gt;</code> element.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- import { FormWithRedirect } from 'react-admin';
</span><span class="gi">+ import { Form } from 'react-admin';
</span>
export const MyForm = () =&gt; (
<span class="gi">+    &lt;Form&gt;
</span><span class="gd">-    &lt;FormWithRedirect
-        render={({handleSubmit}) =&gt; (
-            &lt;form onSubmit={handleSubmit}&gt;
</span>                 &lt;input type="text" id="name" name="name" /&gt;
                 &lt;button type="submit"&gt;Save&lt;/button&gt;
<span class="gd">-            &lt;/form&gt;
-        )}
-    /&gt;
</span><span class="gi">+    &lt;/Form&gt;
</span><span class="err">);</span>
</code></pre></div></div>

<p>If you need to access the form state (<code class="language-plaintext highlighter-rouge">valid</code>, <code class="language-plaintext highlighter-rouge">invalid</code>, <code class="language-plaintext highlighter-rouge">pristine</code>, <code class="language-plaintext highlighter-rouge">dirty</code>), you can call <a href="https://react-hook-form.com/docs/useformstate">the react-hook-form <code class="language-plaintext highlighter-rouge">useFormState</code> hook</a> instead:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { FormWithRedirect } from 'react-admin';
</span><span class="gi">+ import { Form } from 'react-admin';
+ import { useFormState } from 'react-hook-form';
</span>
const MyCustomForm = () =&gt; {
    return (
<span class="gd">-        &lt;FormWithRedirect
</span><span class="gi">+        &lt;Form&gt;
</span><span class="gd">-            render={({ valid, dirty, handleSubmit }) =&gt; (
-               &lt;form onSubmit={handleSubmit}&gt;
</span>                    ...
<span class="gd">-                    &lt;SubmitButton disabled={!dirty || !valid}&gt;Save&lt;/SubmitButton&gt;
</span><span class="gi">+                    &lt;SubmitButton&gt;Save&lt;/SubmitButton&gt;
</span><span class="gd">-               &lt;/form&gt;
</span>            )}
<span class="gd">-       /&gt;
</span><span class="gi">+       &lt;/Form&gt;
</span>    );
<span class="err">};</span>

<span class="gd">-const SubmitButton = ({ disabled, ...props }) =&gt; {
</span><span class="gi">+const SubmitButton = (props) =&gt; {
+    const { isDirty, isValid } = useFormState();
</span>    return (
<span class="gd">-        &lt;button disabled={disabled} {...props} /&gt;
</span><span class="gi">+        &lt;button disabled={!isDirty || !isValid} {...props} /&gt;
</span>    );
<span class="err">}</span>
</code></pre></div></div>

<p><strong>Reminder:</strong> <a href="https://react-hook-form.com/docs/useformstate/#rules">react-hook-form’s <code class="language-plaintext highlighter-rouge">formState</code> is wrapped with a Proxy</a> to improve render performance and skip extra computation if specific state is not subscribed. So, make sure you deconstruct or read the <code class="language-plaintext highlighter-rouge">formState</code> before render in order to enable the subscription.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">isDirty</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useFormState</span><span class="p">();</span> <span class="c1">// ✅</span>
<span class="kd">const</span> <span class="nx">formState</span> <span class="o">=</span> <span class="nx">useFormState</span><span class="p">();</span> <span class="c1">// ❌ should deconstruct the formState      </span>
</code></pre></div></div>

<h3 id="sanitizeemptyvalues-works-the-other-way-around"><code class="language-plaintext highlighter-rouge">sanitizeEmptyValues</code> Works the Other Way Around</h3>

<p>React-hook-form doesn’t remove empty values like react-final-fom did. Therefore, if you opted out of this behavior with <code class="language-plaintext highlighter-rouge">sanitizeEmptyValues={false}</code>, you no longer need that prop:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">export const PostEdit = () =&gt; (
</span>    &lt;Edit&gt;
<span class="gd">-       &lt;SimpleForm sanitizeEmptyValues={false}&gt;
</span><span class="gi">+       &lt;SimpleForm&gt;
</span>            &lt;TextInput source="title" /&gt;
            &lt;JsonInput source="body" /&gt;
        &lt;/SimpleForm&gt;
    &lt;/Edit&gt;
<span class="err">);</span>
</code></pre></div></div>

<p>If you actually need to remove empty values, you have to set the <code class="language-plaintext highlighter-rouge">sanitizeEmptyValues</code> prop explicitly:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">export const PostEdit = () =&gt; (
</span>    &lt;Edit&gt;
<span class="gd">-       &lt;SimpleForm&gt;
</span><span class="gi">+       &lt;SimpleForm sanitizeEmptyValues&gt;
</span>            &lt;TextInput source="title" /&gt;
            &lt;JsonInput source="body" /&gt;
        &lt;/SimpleForm&gt;
    &lt;/Edit&gt;
<span class="err">);</span>
</code></pre></div></div>

<p>If this sanitization strategy doesn’t suit your needs, you can use the <code class="language-plaintext highlighter-rouge">transform</code> prop on the <code class="language-plaintext highlighter-rouge">&lt;Create&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;Edit&gt;</code>, or <code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code> components.</p>

<h3 id="useformgroup-hook-returned-state-has-changed"><code class="language-plaintext highlighter-rouge">useFormGroup</code> Hook Returned State Has Changed</h3>

<p>The <code class="language-plaintext highlighter-rouge">useFormGroup</code> hook used to return the form group state props (<code class="language-plaintext highlighter-rouge">dirty</code>, <code class="language-plaintext highlighter-rouge">invalid</code>, <code class="language-plaintext highlighter-rouge">pristine</code>, <code class="language-plaintext highlighter-rouge">touched</code>, <code class="language-plaintext highlighter-rouge">valid</code> and <code class="language-plaintext highlighter-rouge">errors</code>). They don’t exist in <code class="language-plaintext highlighter-rouge">react-hook-form</code> so now it will return <code class="language-plaintext highlighter-rouge">isDirty</code>, <code class="language-plaintext highlighter-rouge">isValid</code>, <code class="language-plaintext highlighter-rouge">isTouched</code> and <code class="language-plaintext highlighter-rouge">errors</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const AccordionSectionTitle = ({ children, name }) =&gt; {
</span>    const formGroupState = useFormGroup(name);

    return (
<span class="gd">-      &lt;Typography color={formGroupState.invalid &amp;&amp; formGroupState.dirty ? 'error' : 'inherit'}&gt;
</span><span class="gi">+      &lt;Typography color={!formGroupState.isValid &amp;&amp; formGroupState.isDirty ? 'error' : 'inherit'}&gt;
</span>          {children}
      &lt;/Typography&gt;
    );
<span class="err">}</span>
</code></pre></div></div>

<h3 id="toolbar-props-have-changed"><code class="language-plaintext highlighter-rouge">&lt;Toolbar&gt;</code> Props Have Changed</h3>

<p>The <code class="language-plaintext highlighter-rouge">&lt;Toolbar&gt;</code> component used to receive the form state props (<code class="language-plaintext highlighter-rouge">dirty</code>, <code class="language-plaintext highlighter-rouge">invalid</code>, <code class="language-plaintext highlighter-rouge">pristine</code> and <code class="language-plaintext highlighter-rouge">valid</code>). They don’t exist in <code class="language-plaintext highlighter-rouge">react-hook-form</code> and you can get the form state with its <code class="language-plaintext highlighter-rouge">useFormState</code> hook:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import Toolbar from '@mui/material/Toolbar';
import { SaveButton, ToolbarProps } from 'react-admin';
</span><span class="gi">+import { useFormState } from 'react-hook-form';
</span>
const ReviewEditToolbar = (props: ToolbarProps&lt;Review&gt;) =&gt; {
<span class="gd">-    const { invalid, resource, saving } = props;
</span><span class="gi">+    const { resource, saving } = props;
+    const { isValid } = useFormState();
</span>
    return (
        &lt;Toolbar&gt;
            &lt;SaveButton
<span class="gd">-               invalid={invalid}
</span><span class="gi">+               invalid={!isValid}
</span>                saving={saving}
            /&gt;
        &lt;/Toolbar&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p><strong>Reminder:</strong> <a href="https://react-hook-form.com/docs/useformstate/#rules">react-hook-form’s <code class="language-plaintext highlighter-rouge">formState</code> is wrapped with a Proxy</a> to improve render performance and skip extra computation if specific state is not subscribed. So, make sure you deconstruct or read the <code class="language-plaintext highlighter-rouge">formState</code> before render in order to enable the subscription.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">isDirty</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useFormState</span><span class="p">();</span> <span class="c1">// ✅</span>
<span class="kd">const</span> <span class="nx">formState</span> <span class="o">=</span> <span class="nx">useFormState</span><span class="p">();</span> <span class="c1">// ❌ should deconstruct the formState      </span>
</code></pre></div></div>

<h3 id="toolbars-alwaysenablesavebutton-prop-has-been-removed"><code class="language-plaintext highlighter-rouge">&lt;Toolbar&gt;</code>’s <code class="language-plaintext highlighter-rouge">alwaysEnableSaveButton</code> Prop Has Been Removed</h3>

<p>This prop has been replaced by <code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code>’s <code class="language-plaintext highlighter-rouge">alwaysEnable</code> with the same logic.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { Toolbar, SaveButton } from 'react-admin';
</span>
const EditToolbar = props =&gt; (
<span class="gd">-    &lt;Toolbar {...props} alwaysEnableSaveButton /&gt;
</span><span class="gi">+    &lt;Toolbar {...props}&gt;
+        &lt;SaveButton alwaysEnable /&gt;
+    &lt;/Toolbar&gt;
</span><span class="err">);</span>
</code></pre></div></div>

<h3 id="submitonenter-prop-has-been-removed"><code class="language-plaintext highlighter-rouge">submitOnEnter</code> Prop Has Been Removed</h3>

<p>The following components no longer accept this prop:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;TabbedForm&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;Toolbar&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code></li>
</ul>

<p>By default, <code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;TabbedForm&gt;</code> submit when the user presses <code class="language-plaintext highlighter-rouge">Enter</code>. To disable this behavior, you must now turn the <code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code> (which renders as a <code class="language-plaintext highlighter-rouge">&lt;input type="submit" /&gt;</code> by default) into an <code class="language-plaintext highlighter-rouge">&lt;input type="button"&gt;</code> element, by setting the <code class="language-plaintext highlighter-rouge">type</code> prop to “button”.</p>

<p>If you didn’t have a custom form toolbar, you’ll have to create one to set the <code class="language-plaintext highlighter-rouge">&lt;SaveButton type="button" /&gt;</code> and prevent submission on enter.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { Toolbar, SimpleForm, Edit, TextInput, SaveButton, DeleteButton } from 'react-admin';
</span>
+const MyToolbar = props =&gt; (
<span class="gi">+   &lt;Toolbar {...props}&gt; 
+       &lt;SaveButton type="button" /&gt;
+       &lt;DeleteButton /&gt;
+   &lt;/Toolbar&gt;
+);
</span>
export const PostEdit = () =&gt; (
    &lt;Edit&gt;
<span class="gd">-       &lt;SimpleForm submitOnEnter&gt;
</span><span class="gi">+       &lt;SimpleForm toolbar={&lt;MyToolbar/&gt;}&gt;
</span>            &lt;TextInput source="title" /&gt;
        &lt;/SimpleForm&gt;
    &lt;/Edit&gt;
<span class="err">);</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">&lt;Toolbar&gt;</code> component used to receive the <code class="language-plaintext highlighter-rouge">width</code> prop also, that allowed to display the mobile or desktop version depending on its value. This is handled internally in version 4 and you can safely remove this prop.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { Toolbar } from 'react-admin';
</span>
const MyToolbar = () =&gt; {
    return (
<span class="gd">-       &lt;Toolbar width="xs"/&gt;
</span><span class="gi">+       &lt;Toolbar /&gt;
</span>    );
<span class="err">};</span>
</code></pre></div></div>

<h2 id="custom-forms">Custom Forms</h2>

<p>We previously had a complex solution for having multiple submit buttons: a <code class="language-plaintext highlighter-rouge">SaveContext</code> providing side effects modifiers and refs to the current ones. However, this was redundant and confusing as the <code class="language-plaintext highlighter-rouge">save</code> function provided by our mutation hooks also accept side effect override at call time.</p>

<p>We also supported a redirect prop both on the form component and on the <code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code>. It was even more confusing when adding custom or multiple <code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code> as those received two submission related functions: <code class="language-plaintext highlighter-rouge">handleSubmit</code> and <code class="language-plaintext highlighter-rouge">handleSubmitWithRedirect</code>.</p>

<p>Besides, our solution prevented the native browser submit on enter feature and this was an accessibility issue for some users such as Japanese people.</p>

<p>The new solution leverage the fact that we already have the <code class="language-plaintext highlighter-rouge">save</code> function available through context (<code class="language-plaintext highlighter-rouge">useSaveContext</code>). The following  sections explain in details the necessary changes and how to upgrade if needed.</p>

<h3 id="common-patterns-to-access-form-state-and-values-have-changed">Common Patterns To Access Form State And Values Have Changed</h3>

<p>If you used to rely on <code class="language-plaintext highlighter-rouge">react-final-form</code> hooks and components such as <code class="language-plaintext highlighter-rouge">useForm</code>, <code class="language-plaintext highlighter-rouge">useFormState</code> or <code class="language-plaintext highlighter-rouge">&lt;FormSpy&gt;</code>, you must replace them with their <code class="language-plaintext highlighter-rouge">react-hook-form</code> equivalent.</p>

<p>For instance, if you used <code class="language-plaintext highlighter-rouge">useFormState</code> in a component to show something depending on another form value, use <code class="language-plaintext highlighter-rouge">useWatch</code> instead:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useFormState } from 'react-final-form';
</span><span class="gi">+import { useWatch } from 'react-hook-form';
</span>
const CityInput = props =&gt; {
<span class="gd">-    const { values } = useFormState();
</span><span class="gi">+    const country = useWatch({ name: 'country' });
</span>    return (
        &lt;SelectInput
<span class="gd">-            choices={values.country ? toChoices(cities[values.country]) : []}
</span><span class="gi">+            choices={country ? toChoices(cities[country]) : []}
</span>            {...props}
        /&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>If you used <code class="language-plaintext highlighter-rouge">&lt;FormSpy&gt;</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { FormSpy } from 'react-final-form';
</span><span class="gi">+import { useWatch } from 'react-hook-form';
</span>
const CityInput = props =&gt; {
<span class="gi">+    const country = useWatch({ name: 'country' });
</span>    return (
<span class="gd">-        &lt;FormSpy subscription={{ values: true }}&gt;
-            {({ values }) =&gt; (
-                &lt;SelectInput
-                    choices={values.country ? toChoices(cities[values.country]) : []}
-                    {...props}
-                /&gt;
-            )}
-        &lt;/FormSpy&gt;
</span><span class="gi">+        &lt;SelectInput
+             choices={country ? toChoices(cities[country]) : []}
+             {...props}
+        /&gt;
</span>    );
<span class="err">};</span>
</code></pre></div></div>

<p>If you had a component setting a form value imperatively via <code class="language-plaintext highlighter-rouge">useForm</code>, you should use <code class="language-plaintext highlighter-rouge">useFormContext</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useForm } from 'react-final-form';
</span><span class="gi">+import { useFormContext } from 'react-hook-form';
</span>
const ClearCountry = () =&gt; {
<span class="gd">-    const { change } = useForm();
</span><span class="gi">+    const { setValue } = useFormContext();
</span>
    const handleClick = () =&gt; {
<span class="gd">-        change('country', '');
</span><span class="gi">+        setValue('country', '');
</span>    };

    return &lt;button onClick={handleClick}&gt;Clear country&lt;/button&gt;
<span class="err">}</span>
</code></pre></div></div>

<p>If you called <code class="language-plaintext highlighter-rouge">useForm</code> to access the form API, you should now call <code class="language-plaintext highlighter-rouge">useFormContext</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useForm } from 'react-final-form';
</span><span class="gi">+import { useFormContext } from 'react-hook-form';
</span>
const ResetFormButton = () =&gt; {
<span class="gd">-    const { reset } = useForm();
</span><span class="gi">+    const { reset } = useFormContext();
</span>    return &lt;Button onClick={() =&gt; reset()}&gt;Reset&lt;/Button&gt;
<span class="err">}</span>
</code></pre></div></div>

<h3 id="handlesubmitwithredirect-no-longer-exist"><code class="language-plaintext highlighter-rouge">handleSubmitWithRedirect</code> No Longer Exist</h3>

<p>If you had custom forms using <code class="language-plaintext highlighter-rouge">&lt;FormWithRedirect&gt;</code>, custom toolbars or buttons, you probably relied on either the <code class="language-plaintext highlighter-rouge">handleSubmit</code> or <code class="language-plaintext highlighter-rouge">handleSubmitWithRedirect</code> prop to submit your form (and wonder which one to use).</p>

<p>We now embrace the native behavior of html forms and their buttons. Any button with <code class="language-plaintext highlighter-rouge">type="submit"</code> will call <code class="language-plaintext highlighter-rouge">handleSubmit</code>, while buttons with <code class="language-plaintext highlighter-rouge">type="button"</code> won’t:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyForm = () =&gt; {
</span>    return (
        &lt;Create&gt;
<span class="gd">-           &lt;FormWithRedirect
</span><span class="gi">+           &lt;Form&gt;
</span><span class="gd">-                render={formProps) =&gt; (
</span>                         &lt;TextInput source="name" /&gt;
<span class="gd">-                        &lt;MySaveButton handleSubmit={handleSubmit}&gt;
</span><span class="gi">+                        &lt;MySaveButton /&gt;
</span><span class="gd">-                )}
-           /&gt;
</span><span class="gi">+           &lt;/Form&gt;
</span>        &lt;/Create&gt;
    );
<span class="err">};</span>

<span class="gd">-const MySaveButton = ({ handleSubmit }) =&gt; (
</span><span class="gi">+const MySaveButton = () =&gt; (
</span><span class="gd">-    &lt;button onClick={handleSubmit}&gt;Save&lt;/button&gt;
</span><span class="gi">+    &lt;button type="submit"&gt;Save&lt;/button&gt;
</span><span class="err">);</span>
</code></pre></div></div>

<p>If you relied on the <code class="language-plaintext highlighter-rouge">handleSubmitWithRedirect</code> to change the redirection:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyForm = () =&gt; {
</span>    return (
<span class="gd">-        &lt;Create&gt;
</span><span class="gi">+        &lt;Create redirect="show"&gt;
</span><span class="gd">-            &lt;FormWithRedirect
</span><span class="gi">+            &lt;Form&gt;
</span><span class="gd">-                render={({ handleSubmitWithRedirect, ...formProps }) =&gt; (
</span>                         &lt;TextInput source="name" /&gt;
<span class="gd">-                        &lt;MySaveButton handleSubmitWithRedirect={handleSubmitWithRedirect}&gt;
</span><span class="gi">+                        &lt;MySaveButton /&gt;
</span><span class="gd">-                )}
-            /&gt;
</span><span class="gi">+            &lt;/Form&gt;
</span>        &lt;/Create&gt;
    );
<span class="err">};</span>

<span class="gd">-const MySaveButton = ({ handleSubmitWithRedirect }) =&gt; (
</span><span class="gi">+const MySaveButton = () =&gt; {
</span>    return (
<span class="gd">-        &lt;button onClick={() =&gt; handleSubmitWithRedirect('show')}&gt;Save&lt;/button&gt;
</span><span class="gi">+        &lt;button type="submit"&gt;Save&lt;/button&gt;
</span>    );
<span class="err">);</span>
</code></pre></div></div>

<p>You can also use a function to handle the redirection target, as described in <a href="./EditTutorial.md#redirection-after-submission">the redirection after submission documentation</a>.</p>

<h3 id="savebutton-accepts-mutationoptions-instead-of-onsuccess-and-onfailure"><code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code> Accepts <code class="language-plaintext highlighter-rouge">mutationOptions</code> Instead of <code class="language-plaintext highlighter-rouge">onSuccess</code> and <code class="language-plaintext highlighter-rouge">onFailure</code></h3>

<p>The <code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code> used to accept the <code class="language-plaintext highlighter-rouge">onSuccess</code>, <code class="language-plaintext highlighter-rouge">onFailure</code> and <code class="language-plaintext highlighter-rouge">transform</code> props to handle multiple submit buttons.</p>

<p>Just like the <code class="language-plaintext highlighter-rouge">Edit</code> and <code class="language-plaintext highlighter-rouge">Create</code> components, it now accepts a <code class="language-plaintext highlighter-rouge">mutationOptions</code> prop which may contain an <code class="language-plaintext highlighter-rouge">onSuccess</code> and/or <code class="language-plaintext highlighter-rouge">onError</code> function. It still accepts a <code class="language-plaintext highlighter-rouge">transform</code> prop though.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const Toolbar = (props) =&gt; {
</span>    return (
        &lt;Toolbar&gt;
            &lt;SaveButton
<span class="gd">-                onSuccess={handleSuccess}
-                onFailure={handleFailure}
</span><span class="gi">+                mutationOptions={{ onSuccess: handleSuccess, onError: handleFailure }}
</span>            /&gt;
        &lt;/Toolbar&gt;
    );
<span class="err">}</span>
</code></pre></div></div>

<p>We removed the <code class="language-plaintext highlighter-rouge">handleSubmit</code> and <code class="language-plaintext highlighter-rouge">handleSubmitWithRedirect</code> props completely. Instead, when provided any of the side effects props, the <code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code> will render a simple button and will call the <code class="language-plaintext highlighter-rouge">save</code> function with them. It also takes care of preventing the default form submit.</p>

<p>If you relied on <code class="language-plaintext highlighter-rouge">handleSubmit</code> or <code class="language-plaintext highlighter-rouge">handleSubmitWithRedirect</code>, you can now use the <code class="language-plaintext highlighter-rouge">SaveButton</code> and override any of the side effect props: <code class="language-plaintext highlighter-rouge">onSuccess</code>, <code class="language-plaintext highlighter-rouge">onFailure</code> or <code class="language-plaintext highlighter-rouge">transform</code>.</p>

<h3 id="the-save-function-signature-changed">The <code class="language-plaintext highlighter-rouge">save</code> Function Signature Changed</h3>

<p>The <code class="language-plaintext highlighter-rouge">save</code> function signature no longer takes a redirection side effect as the second argument. Instead, it only receives the data and an options object for side effects (which was the third argument before):</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyCustomCreate = () =&gt; {
</span>    const createControllerProps = useCreateController();
    const notify = useNotify();
<span class="gi">+   const redirect = useRedirect();
</span>
    const handleSubmit = (values) =&gt; {
<span class="gd">-        createControllerProps.save(values, 'show', {
</span><span class="gi">+        createControllerProps.save(values, {
</span>            onSuccess: (data) =&gt; {
                notify('Success');
<span class="gi">+               redirect('show', '/posts', data.id);
</span>            }
        })
    }

    return (
        &lt;CreateContextProvider value={createControllerProps}&gt;
            &lt;Form onSubmit={handleSubmit}&gt;
               ...
            &lt;/Form&gt;
        &lt;/CreateContextProvider&gt;
    )
<span class="err">}</span>
</code></pre></div></div>

<h3 id="formcontext-formcontextprovider-and-useformcontext-have-been-removed"><code class="language-plaintext highlighter-rouge">&lt;FormContext&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;FormContextProvider&gt;</code> and <code class="language-plaintext highlighter-rouge">useFormContext</code> Have Been Removed</h3>

<p>These changes only concern you if you had custom forms not built with <code class="language-plaintext highlighter-rouge">&lt;FormWithRedirect&gt;</code>, or custom components relying on the form groups management (accordions or collapsible sections for instance).</p>

<p>As the <code class="language-plaintext highlighter-rouge">save</code> and <code class="language-plaintext highlighter-rouge">saving</code> properties are already available through the <code class="language-plaintext highlighter-rouge">&lt;SaveContext&gt;</code> component and its <code class="language-plaintext highlighter-rouge">useSaveContext</code> hook, we removed the <code class="language-plaintext highlighter-rouge">&lt;FormContext&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;FormContextProvider&gt;</code> components as well the <code class="language-plaintext highlighter-rouge">useFormContext</code> hook. The functions around form groups management have been extracted into the <code class="language-plaintext highlighter-rouge">&lt;FormGroupsProvider&gt;</code> component:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const CustomForm = ({ save, ...props }) =&gt; {
</span><span class="gd">-    const formContext = {
-        save,
-        saving,
-        ...form group management functions
-    }
</span>    return (
        &lt;Form
            {...props}
            onSubmit={save}
        &gt;
<span class="gd">-           &lt;FormContextProvider value={formContext}&gt;
</span><span class="gi">+           &lt;FormGroupsProvider&gt;
</span>                ...
<span class="gd">-           &lt;/FormContextProvider&gt;
</span><span class="gi">+           &lt;/FormGroupsProvider&gt;
</span>            )}
        &lt;/Form&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<h3 id="the-redirect-prop-has-been-removed-from-form-components">The <code class="language-plaintext highlighter-rouge">redirect</code> prop Has Been Removed From Form Components</h3>

<p>The <code class="language-plaintext highlighter-rouge">&lt;FormWithRedirect&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;TabbedForm&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;SaveButton&gt;</code> don’t have a <code class="language-plaintext highlighter-rouge">redirect</code> prop anymore.</p>

<p>If you had the <code class="language-plaintext highlighter-rouge">redirect</code> prop set on the form component, move it to <code class="language-plaintext highlighter-rouge">Create</code> or <code class="language-plaintext highlighter-rouge">Edit</code> component:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-&lt;Create&gt;
</span><span class="gi">+&lt;Create redirect="edit"&gt;
</span><span class="gd">-    &lt;SimpleForm redirect="edit"&gt;
</span><span class="gi">+    &lt;SimpleForm&gt;
</span>        &lt;TextInput source="name"&gt;
    &lt;/SimpleForm&gt;
<span class="gd">&lt;/Create&gt;
</span></code></pre></div></div>

<p>If you had the <code class="language-plaintext highlighter-rouge">redirect</code> prop set on the <code class="language-plaintext highlighter-rouge">SaveButton</code>, provide a <code class="language-plaintext highlighter-rouge">onSuccess</code> prop:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostCreateToolbar = props =&gt; {
</span><span class="gi">+   const notify = useNotify();
+   const redirect = useRedirect();
</span>    return (
        &lt;Toolbar {...props}&gt;
            &lt;SaveButton
                label="post.action.save_and_edit"
<span class="gd">-               redirect="edit"
</span><span class="gi">+               onSuccess={data =&gt; {
+                   notify('ra.notification.updated', {
+                       type: 'info',
+                       messageArgs: { smart_count: 1 },
+                       undoable: true,
+                   });
+                   redirect('edit', '/posts', data.id)
+               }}
</span>            /&gt;
        &lt;/Toolbar&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<h3 id="the-form-components-save-prop-has-been-renamed-to-onsubmit">The Form Components <code class="language-plaintext highlighter-rouge">save</code> Prop Has Been Renamed to <code class="language-plaintext highlighter-rouge">onSubmit</code></h3>

<p>This change only matters to you if you used the form components outside of <code class="language-plaintext highlighter-rouge">&lt;Create&gt;</code> or <code class="language-plaintext highlighter-rouge">&lt;Edit&gt;</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyComponent = () =&gt; {
</span>    const handleSave = () =&gt; {

    }

    return (
<span class="gd">-        &lt;SimpleForm save={handleSave}&gt;
</span><span class="gi">+        &lt;SimpleForm onSubmit={handleSave}&gt;
</span>            &lt;TextInput source="name" /&gt;
        &lt;/SimpleForm&gt;
    )
<span class="err">};</span>
</code></pre></div></div>

<h2 id="fields">Fields</h2>

<h3 id="the-record-prop-is-no-longer-injected">The <code class="language-plaintext highlighter-rouge">record</code> Prop Is No Longer Injected</h3>

<p>The List and Show components that took Field as children (e.g. <code class="language-plaintext highlighter-rouge">&lt;Datagrid&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;SimpleShowLayout&gt;</code>) used to clone these children a and to inject the current <code class="language-plaintext highlighter-rouge">record</code> as prop. This is no longer the case, and Field components have to “pull” the record using <code class="language-plaintext highlighter-rouge">useRecordContext</code> instead.</p>

<p>All the react-admin Field components have been updated to use the <code class="language-plaintext highlighter-rouge">useRecordContext</code> hook. But you will need to update your custom fields:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gi">+import { useRecordContext } from 'react-admin';
</span>
-const MyField = ({ record }) =&gt; {
<span class="gi">+const MyField = () =&gt; {
+   const record = useRecordContext();
</span>    return &lt;div&gt;{record ? record.title : ''}&lt;/div&gt;;
<span class="err">}</span>

<span class="p">const PostList = () =&gt; (
</span>    &lt;List&gt;
        &lt;Datagrid&gt;
            &lt;TextField source="author" /&gt;
            &lt;MyField /&gt;
        &lt;/Datagrid&gt;
    &lt;/List&gt;
<span class="err">);</span>
</code></pre></div></div>

<p>The same goes for other components that used to receive the <code class="language-plaintext highlighter-rouge">record</code> prop, like e.g. aside components:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-const Aside = ({ record }) =&gt; (
</span><span class="gi">+const Aside = () =&gt; {
+   const record = useRecordContext();
</span>    return (
        &lt;div&gt;
            &lt;Typography variant="h6"&gt;Post details&lt;/Typography&gt;
            {record &amp;&amp; (
                &lt;Typography variant="body2"&gt;
                    Creation date: {record.createdAt}
                &lt;/Typography&gt;
            )}
        &lt;/div&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p><strong>Tip</strong>: If you’re using TypeScript, you can specify the type of the record returned by the hook:</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">record</span> <span class="o">=</span> <span class="nx">useRecordContext</span><span class="o">&lt;</span><span class="nx">Customer</span><span class="o">&gt;</span><span class="p">();</span>
<span class="c1">// record is of type Customer</span>
</code></pre></div></div>

<h3 id="no-more-props-injection-in-referencefield">No More Props Injection In <code class="language-plaintext highlighter-rouge">&lt;ReferenceField&gt;</code></h3>

<p><code class="language-plaintext highlighter-rouge">&lt;ReferenceField&gt;</code> creates a <code class="language-plaintext highlighter-rouge">RecordContext</code> for the reference record, and this allows using any of react-admin’s Field components. It also used to pass many props to the underlying component (including the current <code class="language-plaintext highlighter-rouge">record</code>), but this is no longer the case. If you need to access the <code class="language-plaintext highlighter-rouge">record</code> in a child of <code class="language-plaintext highlighter-rouge">&lt;ReferenceField&gt;</code>, you need to use the <code class="language-plaintext highlighter-rouge">useRecordContext</code> hook instead.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostShow = () =&gt; (
</span>    &lt;Show&gt;
        &lt;SimpleShowLayout&gt;
            &lt;TextField source="title" /&gt;
            &lt;ReferenceField source="author_id" reference="users"&gt;
                &lt;NameField /&gt;
            &lt;/ReferenceField&gt;
        &lt;/SimpleShowLayout&gt;
    &lt;/Show&gt;
<span class="err">);</span>

<span class="gd">-const NameField = ({ record }) =&gt; {
</span><span class="gi">+const NameField = () =&gt; {
+   const { record } = useRecordContext();
</span>    return &lt;span&gt;{record?.name}&lt;/span&gt;;
<span class="err">};</span>
</code></pre></div></div>

<h3 id="addlabel-prop-no-longer-considered-for-show-labelling"><code class="language-plaintext highlighter-rouge">addLabel</code> Prop No Longer Considered For Show Labelling</h3>

<p><code class="language-plaintext highlighter-rouge">&lt;SimpleShowLayout&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;TabbedShowLayout&gt;</code> used to look for an <code class="language-plaintext highlighter-rouge">addLabel</code> prop to decide whether they needed to add a label or not. This relied on <code class="language-plaintext highlighter-rouge">defaultProps</code>, which will soon be removed from React.</p>

<p>The Show layout components now render a label for their children as soon as they have a <code class="language-plaintext highlighter-rouge">source</code> or a <code class="language-plaintext highlighter-rouge">label</code> prop. If you don’t want a field to have a label in the show view, pass the <code class="language-plaintext highlighter-rouge">label={false}</code> prop.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">PostShow</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Show</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">SimpleShowLayout</span><span class="p">&gt;</span>
            <span class="si">{</span><span class="cm">/* this field will have a Label */</span><span class="si">}</span>
            <span class="p">&lt;</span><span class="nc">TextField</span> <span class="na">source</span><span class="p">=</span><span class="s">"title"</span> <span class="p">/&gt;</span>
            <span class="si">{</span><span class="cm">/* this one will also have a Label */</span><span class="si">}</span>
            <span class="p">&lt;</span><span class="nc">TextField</span> <span class="na">label</span><span class="p">=</span><span class="s">"Author name"</span> <span class="na">source</span><span class="p">=</span><span class="s">"author"</span> <span class="p">/&gt;</span>
            <span class="si">{</span><span class="cm">/* this field will not */</span><span class="si">}</span>
            <span class="p">&lt;</span><span class="nc">TextField</span> <span class="na">label</span><span class="p">=</span><span class="si">{</span><span class="kc">false</span><span class="si">}</span> <span class="na">source</span><span class="p">=</span><span class="s">"title"</span> <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nc">SimpleShowLayout</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nc">Show</span><span class="p">&gt;</span>
<span class="p">);</span>
</code></pre></div></div>

<p>As the <code class="language-plaintext highlighter-rouge">addLabel</code> prop is now ignored in fields and inputs, you can remove it from your custom fields and inputs:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyCustomField = () =&gt; (
</span>    ... 
<span class="err">);</span>
-MyCustomField.defaultProps = {
<span class="gd">-    addLabel: true
-};
</span></code></pre></div></div>

<h3 id="arrayfield-does-not-accept-a-fieldkey-prop-anymore"><code class="language-plaintext highlighter-rouge">&lt;ArrayField&gt;</code> Does Not Accept a <code class="language-plaintext highlighter-rouge">fieldKey</code> Prop Anymore</h3>

<p>The <code class="language-plaintext highlighter-rouge">ArrayField</code> component used to accept a <code class="language-plaintext highlighter-rouge">fieldKey</code> prop, allowing to specify a record property for use as a React key, enabling some performance improvements. Moving to react-query has made this workaround unnecessary and you can safely remove this prop:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-&lt;ArrayField source="backlinks" fieldKey="uuid"&gt;
</span><span class="gi">+&lt;ArrayField source="backlinks"&gt;
</span>    &lt;Datagrid&gt;
        &lt;DateField source="date" /&gt;
        &lt;UrlField source="url" /&gt;
    &lt;/Datagrid&gt;
<span class="gd">&lt;/ArrayField&gt;
</span></code></pre></div></div>

<h2 id="inputs">Inputs</h2>

<h3 id="initalvalue-and-defaultvalue-have-been-merged-into-defaultvalue"><code class="language-plaintext highlighter-rouge">initalValue</code> and <code class="language-plaintext highlighter-rouge">defaultValue</code> Have Been Merged Into <code class="language-plaintext highlighter-rouge">defaultValue</code></h3>

<p>All React Admin inputs used to accept both a <code class="language-plaintext highlighter-rouge">initialValue</code> and a <code class="language-plaintext highlighter-rouge">defaultValue</code> prop and they had different meanings in <code class="language-plaintext highlighter-rouge">react-final-form</code>. With <code class="language-plaintext highlighter-rouge">react-hook-form</code> there’s only <code class="language-plaintext highlighter-rouge">defaultValue</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const PostCreate = () =&gt; (
</span>    &lt;Create&gt;
        &lt;SimpleForm&gt;
<span class="gd">-            &lt;TextInput source="title" initialValue="A default"&gt;
</span><span class="gi">+            &lt;TextInput source="title" defaultValue="A default"&gt;
</span>        &lt;/SimpleForm&gt;
    &lt;/Create&gt;
<span class="err">)</span>
</code></pre></div></div>

<h3 id="custom-form-inputs-must-use-usecontroller-instead-of-field">Custom Form Inputs Must Use <code class="language-plaintext highlighter-rouge">useController</code> instead of <code class="language-plaintext highlighter-rouge">&lt;Field&gt;</code></h3>

<p>To interface a custom form input with <code class="language-plaintext highlighter-rouge">react-hook-form</code>, you must use the <code class="language-plaintext highlighter-rouge">useController</code> hook instead of <code class="language-plaintext highlighter-rouge">&lt;Field&gt;</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Field } from 'react-final-form';
</span><span class="gi">+import { useController } from 'react-hook-form';
</span>
const LatLngInput = () =&gt; {
<span class="gi">+   const input1 = useController({ name: 'position.lat' });
+   const input2 = useController({ name: 'position.lng' });
</span>    
    return (
        &lt;span&gt;
<span class="gd">-           &lt;Field name="lat" component="input" type="number" placeholder="latitude" /&gt;
</span><span class="gi">+           &lt;input {...input1.field} type="number" placeholder="latitude" /&gt;
</span>            &amp;nbsp;
<span class="gd">-           &lt;Field name="lng" component="input" type="number" placeholder="longitude" /&gt;
</span><span class="gi">+           &lt;input {...input2.field} type="number" placeholder="longitude" /&gt;
</span>        &lt;/span&gt;
    );
<span class="err">);</span>
export default LatLngInput;
</code></pre></div></div>

<h3 id="useinput-signature-and-return-value-have-changed"><code class="language-plaintext highlighter-rouge">useInput</code> Signature And Return Value Have Changed</h3>

<p>Just like all inputs, <code class="language-plaintext highlighter-rouge">useInput</code> now only accept <code class="language-plaintext highlighter-rouge">defaultValue</code> and will ignore <code class="language-plaintext highlighter-rouge">initialValue</code>.</p>

<p>Besides, <code class="language-plaintext highlighter-rouge">useInput</code> used to return <code class="language-plaintext highlighter-rouge">final-form</code> properties such as <code class="language-plaintext highlighter-rouge">input</code> and <code class="language-plaintext highlighter-rouge">meta</code>. It now returns <code class="language-plaintext highlighter-rouge">field</code>, <code class="language-plaintext highlighter-rouge">fieldState</code> and <code class="language-plaintext highlighter-rouge">formState</code> (see https://react-hook-form.com/docs/usecontroller).</p>

<p>Note that the <code class="language-plaintext highlighter-rouge">error</code> returned by <code class="language-plaintext highlighter-rouge">fieldState</code> is not just a simple string anymore but an object with a <code class="language-plaintext highlighter-rouge">message</code> property.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import TextField from 'mui/material/TextField';
import { useInput, required } from 'react-admin';
</span>
const MyInput = ({ helperText, ...props }) =&gt; {
    const {
<span class="gd">-       input,
</span><span class="gi">+       field,
</span><span class="gd">-       meta: { touched, error },
</span><span class="gi">+       fieldState: { isTouched, invalid, error },
+       formState: { isSubmitted }
</span>        isRequired
    } = useInput(props);

    return (
        &lt;TextField
<span class="gd">-           {...input}
</span><span class="gi">+           {...field}
</span>            label={props.label}
<span class="gd">-           error={touched &amp;&amp; !!error}
</span><span class="gi">+           error={(isTouched || isSubmitted) &amp;&amp; invalid}
</span><span class="gd">-           helperText={touched &amp;&amp; !!error ? error : helperText}
</span><span class="gi">+           helperText={(isTouched || isSubmitted) &amp;&amp; invalid ? error?.message : helperText}
</span>            required={isRequired}
            {...rest}
        /&gt;
    );
<span class="err">};</span>

<span class="p">const UserForm = () =&gt; (
</span>    &lt;SimpleForm&gt;
<span class="gd">-       &lt;MyInput initialValue="John" /&gt;
</span><span class="gi">+       &lt;MyInput defaultValue="John" /&gt;
</span>    &lt;/SimpleForm&gt;
<span class="err">)</span>
</code></pre></div></div>

<p><strong>Reminder:</strong> <a href="https://react-hook-form.com/docs/useformstate/#rules">react-hook-form’s <code class="language-plaintext highlighter-rouge">formState</code> is wrapped with a Proxy</a> to improve render performance and skip extra computation if specific state is not subscribed. So, make sure you deconstruct or read the <code class="language-plaintext highlighter-rouge">formState</code> before render in order to enable the subscription.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">isDirty</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useFormState</span><span class="p">();</span> <span class="c1">// ✅</span>
<span class="kd">const</span> <span class="nx">formState</span> <span class="o">=</span> <span class="nx">useFormState</span><span class="p">();</span> <span class="c1">// ❌ should deconstruct the formState      </span>
</code></pre></div></div>

<h3 id="the-addlabel-prop-has-been-removed-from-all-inputs-and-fields">The <code class="language-plaintext highlighter-rouge">addLabel</code> prop Has Been Removed From All Inputs and Fields</h3>

<p>Inputs and fields used to support an <code class="language-plaintext highlighter-rouge">addLabel</code> prop that instructed components such as the <code class="language-plaintext highlighter-rouge">&lt;SimpleForm&gt;</code> to decorate the input or the field with a label. This is no longer the case as inputs are now responsible for their label display and you must wrap fields inside a <code class="language-plaintext highlighter-rouge">&lt;Labeled&gt;</code> to add a label for them.</p>

<p>If you used the <code class="language-plaintext highlighter-rouge">addLabel</code> prop to hide inputs label by passing <code class="language-plaintext highlighter-rouge">false</code>, you can pass <code class="language-plaintext highlighter-rouge">false</code> to the <code class="language-plaintext highlighter-rouge">label</code> prop instead.</p>

<h3 id="autocompleteinput-and-autocompletearrayinput-now-use-material-ui-autocomplete"><code class="language-plaintext highlighter-rouge">&lt;AutocompleteInput&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;AutocompleteArrayInput&gt;</code> Now Use Material UI Autocomplete</h3>

<p>We migrated both the <code class="language-plaintext highlighter-rouge">AutocompleteInput</code> and <code class="language-plaintext highlighter-rouge">AutocompleteArrayInput</code> components so that they leverage Material UI <a href="https://mui.com/material-ui/react-autocomplete/"><code class="language-plaintext highlighter-rouge">&lt;Autocomplete&gt;</code></a>. If you relied on <a href="https://www.downshift-js.com/">Downshift</a> options, you’ll have to update your component.</p>

<p>Besides, some props aren’t available anymore:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">allowDuplicates</code>: This is not supported by Material UI Autocomplete.</li>
  <li><code class="language-plaintext highlighter-rouge">clearAlwaysVisible</code>: the clear button is now always visible, either while hovering the input or when it has focus. You can hide it using the <code class="language-plaintext highlighter-rouge">&lt;Autocomplete&gt;</code> <code class="language-plaintext highlighter-rouge">disableClearable</code> prop though.</li>
  <li><code class="language-plaintext highlighter-rouge">resettable</code>: Removed for the same reason as <code class="language-plaintext highlighter-rouge">clearAlwaysVisible</code></li>
</ul>

<h3 id="options-element-no-longer-receive-a-record">Options element no longer receive a <code class="language-plaintext highlighter-rouge">record</code></h3>

<p><code class="language-plaintext highlighter-rouge">&lt;AutocompleteInput&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;AutocompleteArrayInput&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;SelectInput&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;SelectArrayInput&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;CheckboxGroupInput&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;RadioButtonGroupInput&gt;</code> no longer inject props to React elements passed as <code class="language-plaintext highlighter-rouge">optionText</code>.</p>

<p>To access the record, you can use the <code class="language-plaintext highlighter-rouge">useRecordContext</code> hook.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const choices = [
</span>   { id: 123, first_name: 'Leo', last_name: 'Tolstoi' },
   { id: 456, first_name: 'Jane', last_name: 'Austen' },
<span class="err">];</span>

<span class="gd">-const FullNameField = ({ record }) =&gt; {
</span><span class="gi">+const FullNameField = () =&gt; {
+    const record = useRecordContext();    
</span>    return &lt;span&gt;{record.first_name} {record.last_name}&lt;/span&gt;;
<span class="err">}</span>

<span class="p">const AuthorsInput = () =&gt; {
</span>    &lt;RadioButtonGroupInput source="authors" choices={choices} optionText={&lt;FullNameField /&gt;}/&gt;
<span class="err">}</span>
</code></pre></div></div>

<h3 id="rich-text-input-package-has-changed"><code class="language-plaintext highlighter-rouge">rich-text-input</code> Package Has Changed</h3>

<p>Our old <code class="language-plaintext highlighter-rouge">&lt;RichTextInput&gt;</code> was based on <a href="https://quilljs.com/">Quill</a> but:</p>
<ul>
  <li>it wasn’t accessible (button without labels, etc.)</li>
  <li>it wasn’t translatable (labels in Quill are in the CSS)</li>
  <li>it wasn’t using Material UI components for its UI and looked off</li>
</ul>

<p>The new <code class="language-plaintext highlighter-rouge">&lt;RichTextInput&gt;</code> uses <a href="https://github.com/ueberdosis/tiptap">TipTap</a>, a UI less library to build rich text editors. It gives us the freedom to implement the UI how we want with Material UI components. That solves all the above issues.</p>

<p>If you used the <code class="language-plaintext highlighter-rouge">&lt;RichTextInput&gt;</code> without passing Quill options such as custom toolbars, you have nothing to do.</p>

<p>If you customized the available buttons with the <code class="language-plaintext highlighter-rouge">toolbar</code> props, you can now use the components we provide:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyRichTextInput = (props) =&gt; (
</span>    &lt;RichTextInput
        {...props}
<span class="gd">-        toolbar={[ ['bold', 'italic', 'underline', 'link'] ]}
</span><span class="gi">+        toolbar={
</span>            &lt;RichTextInputToolbar&gt;
				&lt;FormatButtons size={size} /&gt;
				&lt;LinkButtons size={size} /&gt;
			&lt;/RichTextInputToolbar&gt;
        }
    /&gt;
<span class="err">)</span>
</code></pre></div></div>

<p>If you customized the Quill instance to add custom handlers, you’ll have to use <a href="https://github.com/ueberdosis/tiptap">TipTap</a> primitives.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import {
</span>	RichTextInput,
<span class="gi">+	DefaultEditorOptions,
+	RichTextInputToolbar,
+	LevelSelect,
+	FormatButtons,
+	AlignmentButtons,
+	ListButtons,
+	LinkButtons,
+	QuoteButtons,
+	ClearButtons,
</span><span class="err">}</span> from 'ra-input-rich-text';

-const configureQuill = quill =&gt; quill.getModule('toolbar').addHandler('insertSmile', function (value) {
<span class="gd">-    const { index, length } = this.quill.getSelection();
-    this.quill..insertText(index + length, ':-)', 'api');
-});
</span>
const MyRichTextInput = (props) =&gt; (
    &lt;RichTextInput
        {...props}
<span class="gd">-       configureQuill={configureQuill}
</span><span class="gi">+       toolbar={
+           &lt;RichTextInputToolbar&gt;
+               &lt;LevelSelect size={size} /&gt;
+	        &lt;FormatButtons size={size} /&gt;
+	        &lt;AlignmentButtons {size} /&gt;
+	        &lt;ListButtons size={size} /&gt;
+	        &lt;LinkButtons size={size} /&gt;
+	        &lt;QuoteButtons size={size} /&gt;
+	        &lt;ClearButtons size={size} /&gt;
+               &lt;ToggleButton
+                   aria-label="Add a smile"
+	            title="Add a smile"
+                   onClick={() =&gt; editor.insertContent(':-)')}
+	        &gt;
+                   &lt;Remove fontSize="inherit" /&gt;
+	        &lt;/ToggleButton&gt;
+           &lt;/RichTextInputToolbar&gt;
</span>	}
    /&gt;
<span class="err">}</span>
</code></pre></div></div>

<h3 id="booleaninput-change-handlers-receive-an-event-object"><code class="language-plaintext highlighter-rouge">BooleanInput</code> Change Handlers Receive an Event Object</h3>

<p>In previous versions BooleanInput’s <code class="language-plaintext highlighter-rouge">onChange</code> event handlers only received the checked state of the input. Now they receive the event object, so you have to take the checked state from there.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { BooleanInput } from 'react-admin';
</span>
&lt;BooleanInput
    label="Commentable"
    source="commentable"
<span class="gd">-   onChange={checked =&gt; { console.log(checked); }}
</span><span class="gi">+   onChange={e =&gt; { console.log(e.target.checked); }}
</span><span class="err">/&gt;</span>
</code></pre></div></div>

<h3 id="allowempty-has-been-removed"><code class="language-plaintext highlighter-rouge">allowEmpty</code> Has Been Removed</h3>

<p>The <code class="language-plaintext highlighter-rouge">&lt;SelectInput&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;SelectArrayInput&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;AutocompleteInput&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;AutocompleteArrayInput&gt;</code> components used to accept an <code class="language-plaintext highlighter-rouge">allowEmpty</code> prop. When set to <code class="language-plaintext highlighter-rouge">true</code>, a choice was added for setting the input value to an empty value (empty string by default).</p>

<p>However, the underlying Material UI components now require that the current input value has a matching choice. Those components now always accept an empty value (an empty string by default). You can safely remove this prop.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const choices = [{ id: 1, name: 'value' }, { id: 2, name: 'value 2' }]
</span>
const MyOptionalSelect = () =&gt; (
<span class="gd">-    &lt;SelectInput choices={choices} allowEmpty /&gt;
</span><span class="gi">+    &lt;SelectInput choices={choices} /&gt;
</span><span class="err">);</span>
</code></pre></div></div>

<p>If you require the input to have a non-empty value, use the <code class="language-plaintext highlighter-rouge">required</code> validation.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyRequiredSelect = () =&gt; (
</span><span class="gd">-    &lt;SelectInput choices={choices} /&gt;
</span><span class="gi">+    &lt;SelectInput choices={choices} validate={[required()]} /&gt;
</span><span class="err">);</span>
</code></pre></div></div>

<h3 id="referenceinput-and-referencearrayinput-now-provide-a-choicescontext"><code class="language-plaintext highlighter-rouge">&lt;ReferenceInput&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInput&gt;</code> Now Provide A <code class="language-plaintext highlighter-rouge">ChoicesContext</code></h3>

<p><code class="language-plaintext highlighter-rouge">&lt;ReferenceInput&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInput&gt;</code> used to inject props to their children. They now provide a <code class="language-plaintext highlighter-rouge">ChoicesContext</code> with support for sorting, paginating and filtering through methods and properties that match those of the <code class="language-plaintext highlighter-rouge">ListContext</code>. All their methods now have the same signature. As a result, several changes were made to both components:</p>

<h4 id="referenceinput-no-longer-accepts-the-filtertoquery-prop"><code class="language-plaintext highlighter-rouge">&lt;ReferenceInput&gt;</code> No Longer Accepts The <code class="language-plaintext highlighter-rouge">filterToQuery</code> Prop</h4>

<p>It is now the responsibility of the child input to call the <code class="language-plaintext highlighter-rouge">setFilters</code> function provided through the <code class="language-plaintext highlighter-rouge">ChoicesContext</code> with the expected filter. If you used the <code class="language-plaintext highlighter-rouge">filterToQuery</code> prop to convert an <code class="language-plaintext highlighter-rouge">&lt;AutocompleteInput&gt;</code> search, you’ll have to move the <code class="language-plaintext highlighter-rouge">filterToQuery</code> prop on the <code class="language-plaintext highlighter-rouge">&lt;AutocompleteInput&gt;</code> itself:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const UserListFilter = [
</span>    &lt;ReferenceInput
        source="email"
<span class="gd">-       filterToQuery={search =&gt; ({ email: search })}
</span>    &gt;
<span class="gd">-       &lt;AutocompleteInput /&gt;
</span><span class="gi">+       &lt;AutocompleteInput filterToQuery={search =&gt; ({ email: search })} /&gt;
</span>    &lt;/ReferenceInput&gt;
<span class="err">]</span>
</code></pre></div></div>

<h4 id="referenceinput-and-referencearrayinput-no-longer-accepts-common-props"><code class="language-plaintext highlighter-rouge">&lt;ReferenceInput&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInput&gt;</code> No Longer Accepts <a href="https://marmelab.com/react-admin/Inputs.html#common-input-props">Common Props</a></h4>

<p>Since these components no longer inject props to their children, you have to pass these props directly to them.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const UserInput = [
</span>    &lt;ReferenceInput
        source="email"
        reference="users"
<span class="gd">-       label="User"
-       validate={[required()]}
-       fullWidth
-       className="myCustomCLass"
-       formClassName=="myCustomFormClass"
-       helperText="Custom helper text"
</span>    &gt;
<span class="gd">-        &lt;AutocompleteInput /&gt;
</span><span class="gi">+        &lt;AutocompleteInput 
+            label="User" 
+            validate={[required()]}
+            fullWidth
+            className="myCustomClass"
+            formClassName=="myCustomFormClass"
+            helperText="Custom helper text"
+        /&gt;
</span>    &lt;/ReferenceInput&gt;
<span class="err">]</span>
</code></pre></div></div>

<p><strong>Note</strong>: <code class="language-plaintext highlighter-rouge">&lt;ReferenceInput&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInput&gt;</code> still accept the <code class="language-plaintext highlighter-rouge">label</code> prop, which is used as the Filter label when they are used in a Filter array.</p>

<h4 id="referencearrayinput-no-longer-provides-a-listcontext"><code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInput&gt;</code> No Longer Provides a <code class="language-plaintext highlighter-rouge">ListContext</code></h4>

<p>As the <code class="language-plaintext highlighter-rouge">ChoicesContext</code> now provide an API very similar to the <code class="language-plaintext highlighter-rouge">ListContext</code>, it no longer sets up a <code class="language-plaintext highlighter-rouge">ListContext</code>. If you used this to display a <code class="language-plaintext highlighter-rouge">&lt;Datagrid&gt;</code>, we will soon provide the <code class="language-plaintext highlighter-rouge">&lt;DatagridInput&gt;</code> for this purpose.</p>

<h4 id="referencearrayinputcontext-referencearrayinputcontextprovider-and-usereferencearrayinputcontext-have-been-removed"><code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInputContext&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInputContextProvider&gt;</code> And <code class="language-plaintext highlighter-rouge">useReferenceArrayInputContext</code> Have Been Removed</h4>

<p>As we now have a common interface to fetch choices related data and methods with the <code class="language-plaintext highlighter-rouge">ChoicesContext</code>, we removed the <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInputContext&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInputContextProvider&gt;</code> components as well as the <code class="language-plaintext highlighter-rouge">useReferenceArrayInputContext</code> hook.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useReferenceArrayInputContext } from 'react-admin';
-import { useChoicesContext } from 'react-admin';
</span>
const MyCustomInput = () =&gt; {
<span class="gd">-    const {
-        choices, 
-        error, 
-        warning, 
-        loaded, 
-        loading, 
-        setFilter, 
-        setPagination, 
-        setSort, 
-        setSortForList,
-    } = useReferenceArrayInputContext();
</span><span class="gi">+    const {
+        allChoices,
+        availableChoices,
+        selectedChoices,
+        filter,
+        filterValues,
+        page,
+        perPage,
+        setFilters,
+        setPage,
+        setPerPage,
+        setSort,
+        sort,
+   } = useChoicesContext();
</span>    return // ...
<span class="err">}</span>
</code></pre></div></div>

<h4 id="other-changes">Other Changes</h4>

<p>The other changes only impact you if you had a custom child component for either the <code class="language-plaintext highlighter-rouge">&lt;ReferenceInput&gt;</code> or <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInput&gt;</code>.</p>

<p>The <code class="language-plaintext highlighter-rouge">ChoicesContext</code> provides access to the choices via 3 properties:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">availableChoices</code>: The choices which are not selected but matches the parameters (sorting, pagination and filters)</li>
  <li><code class="language-plaintext highlighter-rouge">selectedChoices</code>: The selected choices.</li>
  <li><code class="language-plaintext highlighter-rouge">allChoices</code>: Merge of both available and selected choices.</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">ReferenceInput</code> and <code class="language-plaintext highlighter-rouge">ReferenceArrayInput</code> components also handled the form binding and injected final-form <code class="language-plaintext highlighter-rouge">input</code> and <code class="language-plaintext highlighter-rouge">meta</code> to their child. They don’t need to do that anymore, and simply watch the form value changes to ensure they load the required data when needed.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyCustomAutocomplete = (props) =&gt; {
</span><span class="gd">-    const { choices, input, meta, resource, setFilter, source } = props;
</span><span class="gi">+    const { allChoices, setFilters } = useChoicesContext(props); 
</span>
-    const { input, meta } = useInput({ input, meta });
<span class="gi">+    const { field, fieldState } = useInput(props);
</span>
    const handleTextInputChange = (event) =&gt; {
<span class="gd">-        setFilter(event.target.value);
</span>         // Note that we don't force you to use `q` anymore
<span class="gi">+        setFilters({ q: event.target.value });
</span>    };

    return (
        //...
    )
<span class="err">}</span>
</code></pre></div></div>

<h2 id="ui-components">UI components</h2>

<h3 id="custom-menus-should-get-resource-definition-from-context">Custom Menus Should Get Resource Definition From Context</h3>

<p>React-admin used to store the definition of each resource (its name, icon, label, etc.) in the Redux state. This is no longer the case, as the resource definition is now stored in a custom context.</p>

<p>If you relied on the <code class="language-plaintext highlighter-rouge">useResourceDefinition</code> hook, this change shouldn’t affect you.</p>

<p>If you need to access the definitions of all resources, however, you must upgrade your code, and use the new <code class="language-plaintext highlighter-rouge">useResourceDefinitions</code> hook.</p>

<p>The most common use case is when you override the default <code class="language-plaintext highlighter-rouge">&lt;Menu&gt;</code> component:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">//</span> in src/Menu.js
<span class="p">import * as React from 'react';
import { createElement } from 'react';
</span><span class="gd">-import { useSelector } from 'react-redux';
</span><span class="p">import { useMediaQuery } from '@mui/material';
</span><span class="gd">-import { DashboardMenuItem, Menu, MenuItemLink, getResources } from 'react-admin';
</span><span class="gi">+import { DashboardMenuItem, Menu, MenuItemLink, useResourceDefinitions } from 'react-admin';
</span><span class="p">import DefaultIcon from '@mui/icons-material/ViewList';
import LabelIcon from '@mui/icons-material/Label';
</span>
export const Menu = (props) =&gt; {
<span class="gd">-   const resources = useSelector(getResources);
</span><span class="gi">+   const resourcesDefinitions = useResourceDefinitions();
+   const resources = Object.keys(resourcesDefinitions).map(name =&gt; resourcesDefinitions[name]);
</span>    const open = useSelector(state =&gt; state.admin.ui.sidebarOpen);
    return (
        &lt;Menu {...props}&gt;
            &lt;DashboardMenuItem /&gt;
            {resources.map(resource =&gt; (
                &lt;MenuItemLink
                    key={resource.name}
                    to={`/${resource.name}`}
                    primaryText={
                        (resource.options &amp;&amp; resource.options.label) ||
                        resource.name
                    }
                    leftIcon={
                        resource.icon ? &lt;resource.icon /&gt; : &lt;DefaultIcon /&gt;
                    }
                    onClick={props.onMenuClick}
                    sidebarIsOpen={open}
                /&gt;
            ))}
            {/* add your custom menus here */}
        &lt;/Menu&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<h3 id="appbar-and-usermenu-no-longer-inject-props"><code class="language-plaintext highlighter-rouge">&lt;AppBar&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;UserMenu&gt;</code> No Longer Inject Props</h3>

<p>When a React element was provided as the <code class="language-plaintext highlighter-rouge">userMenu</code> prop, the <code class="language-plaintext highlighter-rouge">&lt;AppBar&gt;</code> used to clone it and inject the <code class="language-plaintext highlighter-rouge">logout</code> prop (a React element). This is no longer the case and if you provided a custom user menu, you now have to include the logout yourself.</p>

<p>Besides, the <code class="language-plaintext highlighter-rouge">&lt;UserMenu&gt;</code> used to clone its children to inject the <code class="language-plaintext highlighter-rouge">onClick</code> prop, allowing them to close the menu. It now provides a <code class="language-plaintext highlighter-rouge">onClose</code> function through a new <code class="language-plaintext highlighter-rouge">UserContext</code> accessible by calling the <code class="language-plaintext highlighter-rouge">useUserMenu</code> hook.</p>

<p>Finally, the <code class="language-plaintext highlighter-rouge">&lt;UserMenu&gt;</code> no longer accepts a <code class="language-plaintext highlighter-rouge">logout</code> prop. Instead, you should pass the <code class="language-plaintext highlighter-rouge">&lt;Logout&gt;</code> component as one of the <code class="language-plaintext highlighter-rouge">&lt;UserMenu&gt;</code> children. Besides, you should not use an <code class="language-plaintext highlighter-rouge">&lt;MenuItemLink&gt;</code> in <code class="language-plaintext highlighter-rouge">&lt;UserMenu&gt;</code> as they also close the <code class="language-plaintext highlighter-rouge">&lt;SideBar&gt;</code> on mobile:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { MenuItemLink, UserMenu } from 'react-admin';
</span><span class="gi">+import { Logout, UserMenu, useUserMenu } from 'react-admin';
</span><span class="p">import { Link } from 'react-router-dom';
</span><span class="gi">+import MenuItem from '@mui/material/MenuItem';
</span><span class="p">import ListItemIcon from '@mui/material/ListItemIcon';
import ListItemText from '@mui/material/ListItemText';
import SettingsIcon from '@mui/icons-material/Settings';
</span>
-const ConfigurationMenu = (props) =&gt; {
<span class="err">//</span> It's important to pass the ref to allow Material UI to manage the keyboard navigation
<span class="gi">+const ConfigurationMenu = forwardRef((props, ref) =&gt; {
+   const { onClose } = useUserMenu();
</span>    return (
<span class="gd">-       &lt;MenuItemLink
</span><span class="gi">+       &lt;MenuItem
+           ref={ref}
</span>            // It's important to pass the props to allow Material UI to manage the keyboard navigation
            {...props}
<span class="gi">+           component={Link}
</span>            to="/configuration"
<span class="gd">-            onClick={props.onClick}
</span><span class="gi">+            onClick={onClose}
</span>        &gt;
            &lt;ListItemIcon&gt;
                &lt;SettingsIcon /&gt;
            &lt;/ListItemIcon&gt;
            &lt;ListItemText&gt;
                Configuration
            &lt;/ListItemText&gt;
<span class="gd">-       &lt;/MenuItemLink&gt;
</span><span class="gi">+       &lt;/MenuItem&gt;
</span>    );
<span class="err">});</span>

<span class="gd">-const CustomUserMenu = (props) =&gt; (
</span><span class="gi">+const CustomUserMenu = () =&gt; (
</span><span class="gd">-    &lt;UserMenu {...props}&gt;
</span><span class="gi">+    &lt;UserMenu&gt;
</span>        &lt;ConfigurationMenu /&gt;
<span class="gi">+       &lt;Logout /&gt;
</span>    &lt;/UserMenu&gt;
<span class="err">);</span>
</code></pre></div></div>

<h3 id="menuitemlink-automatically-translates-primarytext"><code class="language-plaintext highlighter-rouge">&lt;MenuItemLink&gt;</code> Automatically Translates <code class="language-plaintext highlighter-rouge">primaryText</code></h3>

<p>You can pass a translation key directly as the <code class="language-plaintext highlighter-rouge">primaryText</code> prop for <code class="language-plaintext highlighter-rouge">&lt;MenuItemLink&gt;</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyMenuItem = forwardRef((props, ref) =&gt; {
</span><span class="gd">-    const translate = useTranslate();
</span>    return (
        &lt;MenuItemLink
            ref={ref}
            {...props}
            to="/configuration"
<span class="gd">-            primaryText={translate('pos.configuration')}
</span><span class="gi">+            primaryText="pos.configuration"
</span>            leftIcon={&lt;SettingsIcon /&gt;}
        /&gt;
    )
<span class="err">});</span>
</code></pre></div></div>

<h3 id="admin-layout-appbar-and-usermenu-no-longer-accept-a-logout-or-logoutbutton-prop"><code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;AppBar&gt;</code> And <code class="language-plaintext highlighter-rouge">&lt;UserMenu&gt;</code> No Longer Accept A <code class="language-plaintext highlighter-rouge">logout</code> Or <code class="language-plaintext highlighter-rouge">logoutButton</code> Prop</h3>

<p>As we already provide a way to override the user menu displayed in the <code class="language-plaintext highlighter-rouge">&lt;AppBar&gt;</code>, we removed the <code class="language-plaintext highlighter-rouge">logoutButton</code> prop from the <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code> component and the <code class="language-plaintext highlighter-rouge">logout</code> prop from the <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;AppBar&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;UserMenu&gt;</code> components.</p>

<p>If you passed your own logout component through this prop, you must now provide a custom user menu:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Admin, Logout } from 'react-admin';
</span><span class="gi">+import { Admin, AppBar, Layout, Logout, UserMenu } from 'react-admin';
</span>
const MyCustomLogout = () =&gt; &lt;Logout className="my-class-name" /&gt;;

+ const MyUserMenu = () =&gt; &lt;UserMenu&gt;&lt;MyCustomLogout /&gt;&lt;/UserMenu&gt;;

+ const MyAppBar = () =&gt; &lt;AppBar userMenu={&lt;MyUserMenu /&gt;} /&gt;;

+ const MyLayout = (props) =&gt; &lt;Layout {...props} appBar={MyAppBar} /&gt;;

const MyAdmin = () =&gt; (
    &lt;Admin
<span class="gd">-        logoutButton={&lt;MyCustomLogout /&gt;}
</span><span class="gi">+        layout={MyLayout}
</span>    &gt;
        // ....
    &lt;/Admin&gt;
<span class="err">)</span>
</code></pre></div></div>

<h3 id="the-material-ui-themeprovider-is-not-set-by-layout-anymore">The Material UI <code class="language-plaintext highlighter-rouge">&lt;ThemeProvider&gt;</code> is not set by <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code> anymore</h3>

<p>The <code class="language-plaintext highlighter-rouge">&lt;ThemeProvider&gt;</code> is now set by the <code class="language-plaintext highlighter-rouge">&lt;AdminContext&gt;</code> component which is rendered by <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code>.</p>

<p>This shouldn’t impact your code unless you had a completely custom <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code> component. If you do but still uses the default <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code> component, you can safely remove the <code class="language-plaintext highlighter-rouge">ThemeProvider</code> from your <code class="language-plaintext highlighter-rouge">Layout</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Container, ThemeProvider } from '@mui/material';
</span><span class="gi">+import { Container } from '@mui/material';
</span><span class="p">import { Notification, Error } from 'react-admin';
import Header from './Header';
</span>
const Layout = (props) =&gt; {
<span class="gd">-    const { children, theme } = props;
</span><span class="gi">+    const { children } = props;
</span>    return (
<span class="gd">-        &lt;ThemeProvider theme={theme}&gt;
</span><span class="gi">+        &lt;&gt;
</span>            &lt;Header /&gt;
            &lt;Container&gt;
                &lt;main id="main-content"&gt;
                    {children}
                &lt;/main&gt;
            &lt;/Container&gt;
            &lt;Notification /&gt;
<span class="gd">-        &lt;/ThemeProvider&gt;
</span><span class="gi">+        &lt;/&gt;
</span>    );
<span class="err">};</span>
</code></pre></div></div>

<h3 id="the-notification-component-is-included-by-admin-rather-than-layout">The <code class="language-plaintext highlighter-rouge">&lt;Notification&gt;</code> Component Is Included By <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code> Rather Than <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code></h3>

<p>If you customized the <code class="language-plaintext highlighter-rouge">&lt;Notification&gt;</code> component (e.g. to tweak the delay after which a notification disappears), you passed your custom notification component to the <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code> component. The <code class="language-plaintext highlighter-rouge">&lt;Notification&gt;</code> is now included by the <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code> component, which facilitates custom layouts and login screens. As a consequence, you’ll need to move your custom notification component to the <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code> component.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">//</span> in src/MyNotification.js
<span class="p">import { Notification } from 'react-admin';
</span>
export const MyNotification = props =&gt; (
    &lt;Notification {...props} autoHideDuration={5000} /&gt;
<span class="err">);</span>

<span class="err">//</span> in src/MyLayout.js
<span class="gd">-import { Layout } from 'react-admin';
-import { MyNotification } from './MyNotification';
</span>
-export const MyLayout = props =&gt; (
<span class="gd">-   &lt;Layout {...props} notification={MyNotification} /&gt;
-);
</span>
// in src/App.js
<span class="gd">-import { MyLayout } from './MyLayout';
</span><span class="gi">+import { MyNotification } from './MyNotification';
</span><span class="p">import dataProvider from './dataProvider';
</span>
const App = () =&gt; (
<span class="gd">-   &lt;Admin layout={MyLayout} dataProvider={dataProvider}&gt;
</span><span class="gi">+   &lt;Admin notification={MyNotification} dataProvider={dataProvider}&gt;
</span>        // ...
    &lt;/Admin&gt;
<span class="err">);</span>
</code></pre></div></div>

<p>If you had a custom Layout and/or Login component, you no longer need to include the <code class="language-plaintext highlighter-rouge">&lt;Notification&gt;</code> component.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Notification } from 'react-admin';
</span>
export const MyLayout = ({
    children,
    dashboard,
    logout,
    title,
<span class="err">})</span> =&gt; {
    // ...
    return (&lt;&gt;
        // ...
<span class="gd">-       &lt;Notification /&gt;
</span>    &lt;/&gt;);
<span class="err">};</span>
</code></pre></div></div>

<h3 id="renamed-usetogglesidebar-to-usesidebarstate">Renamed <code class="language-plaintext highlighter-rouge">useToggleSidebar</code> to <code class="language-plaintext highlighter-rouge">useSidebarState</code></h3>

<p>The <code class="language-plaintext highlighter-rouge">useToggleSidebar</code> hook has been renamed to <code class="language-plaintext highlighter-rouge">useSidebarState</code>. The second value returned by the hook is no longer a toggle function, but a value updater.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const MyButton = () =&gt; {
</span><span class="gd">-   const [open, toggleSidebar] = useToggleSidebar();
</span><span class="gi">+   const [open, setOpen] = useSidebarState();
</span>    return (
        &lt;Button
            color="inherit"
<span class="gd">-           onClick={() =&gt; toggleSidebar()}
</span><span class="gi">+           onClick={() =&gt; setOpen(!open)}
</span>        &gt;
            {open ? 'Open' : 'Close'}
        &lt;/Button&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<h2 id="i18n">I18n</h2>

<h3 id="changes-in-translation-messages">Changes In Translation Messages</h3>

<p>The <code class="language-plaintext highlighter-rouge">ra.navigation.prev</code> message was renamed to <code class="language-plaintext highlighter-rouge">ra.navigation.previous</code>. Update your translation files accordingly.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const messages = {
</span>    ra: {
        navigation: {
            no_results: 'No results found',
            no_more_results:
                'The page number %{page} is out of boundaries. Try the previous page.',
            page_out_of_boundaries: 'Page number %{page} out of boundaries',
            page_out_from_end: 'Cannot go after last page',
            page_out_from_begin: 'Cannot go before page 1',
            page_range_info: '%{offsetBegin}-%{offsetEnd} of %{total}',
            partial_page_range_info:
                '%{offsetBegin}-%{offsetEnd} of more than %{offsetEnd}',
            current_page: 'Page %{page}',
            page: 'Go to page %{page}',
            next: 'Go to next page',
<span class="gd">-           prev: 'Go to previous page',
</span><span class="gi">+           previous: 'Go to previous page',
</span>            page_rows_per_page: 'Rows per page:',
            skip_nav: 'Skip to content',
        },
        // ...
</code></pre></div></div>

<h3 id="renamed-translationprovider-to-i18ncontextprovider">Renamed <code class="language-plaintext highlighter-rouge">&lt;TranslationProvider&gt;</code> to <code class="language-plaintext highlighter-rouge">&lt;I18nContextProvider&gt;</code></h3>

<p>If you created a custom app (without the <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code> component), you may have used the <code class="language-plaintext highlighter-rouge">&lt;TranslationProvider&gt;</code> component. It has been renamed to <code class="language-plaintext highlighter-rouge">&lt;I18nContextProvider&gt;</code>, and accepts an <code class="language-plaintext highlighter-rouge">i18nProvider</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-&lt;TranslationProvider locale="en" i18nProvider={i18nProvider}&gt;
</span><span class="gi">+&lt;I18nContextProvider value={i18nProvider}&gt;
</span>   ...
<span class="gd">-&lt;/TranslationProvider&gt;
</span><span class="gi">+&lt;/I18nContextProvider&gt;
</span></code></pre></div></div>

<h2 id="miscellaneous">Miscellaneous</h2>

<h3 id="custom-themes-must-extend-defaulttheme">Custom Themes Must Extend <code class="language-plaintext highlighter-rouge">defaultTheme</code></h3>

<p>If you pass a custom object to <code class="language-plaintext highlighter-rouge">&lt;Admin theme&gt;</code> to change the look and feel of your application, the object must now extend the <code class="language-plaintext highlighter-rouge">defaultTheme</code> object, or the inputs will default to the <code class="language-plaintext highlighter-rouge">outlined</code> variant instead of the <code class="language-plaintext highlighter-rouge">filled</code> variant:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gi">+import { defaultTheme } from 'react-admin';
</span>
const theme = {
<span class="gi">+   ...defaultTheme,
</span>    components: {
<span class="gi">+       ...defaultTheme.components,
</span>        RaDatagrid: {
            root: {
                backgroundColor: "Lavender",
                "&amp; .RaDatagrid-headerCell": {
                    backgroundColor: "MistyRose",
                },
            }
        }
    }
<span class="err">};</span>
</code></pre></div></div>

<p>Alternately, set the default <code class="language-plaintext highlighter-rouge">variant</code>  for <code class="language-plaintext highlighter-rouge">MuiTextField</code> to <code class="language-plaintext highlighter-rouge">filled</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">const theme = {
</span>    components: {
        RaDatagrid: {
            root: {
                backgroundColor: "Lavender",
                "&amp; .RaDatagrid-headerCell": {
                    backgroundColor: "MistyRose",
                },
            }
        }
<span class="gi">+       MuiTextField: {
+           defaultProps: {
+               variant: 'filled',
+           }
+       }
</span>    }
<span class="err">};</span>
</code></pre></div></div>

<h3 id="usenotify-now-takes-an-options-object"><code class="language-plaintext highlighter-rouge">useNotify</code> Now Takes An Options Object</h3>

<p>When a component has to display a notification, developers may want to tweak the type, duration, translation arguments, or the ability to undo the action. The callback returned by <code class="language-plaintext highlighter-rouge">useNotify()</code> used to accept a long series of argument, but the syntax wasn’t very intuitive. To improve the developer experience, these options are now part of an <code class="language-plaintext highlighter-rouge">options</code> object, passed as second argument.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">```jsx</span>
import { useNotify } from 'react-admin';

const NotifyButton = () =&gt; {
    const notify = useNotify();
    const handleClick = () =&gt; {
<span class="gd">-       notify(`Comment approved`, 'success', undefined, true);
</span><span class="gi">+       notify(`Comment approved`, { type: 'success', undoable: true });
</span>    }
    return &lt;button onClick={handleClick}&gt;Notify&lt;/button&gt;;
<span class="err">};</span>
</code></pre></div></div>

<p>Check <a href="https://marmelab.com/react-admin/useNotify.html">the <code class="language-plaintext highlighter-rouge">useNotify</code> documentation</a> for more information.</p>

<h3 id="the-useversion-hook-was-removed">The <code class="language-plaintext highlighter-rouge">useVersion</code> Hook Was Removed</h3>

<p>React-admin v3 relied on a global <code class="language-plaintext highlighter-rouge">version</code> variable stored in the Redux state to force page refresh. This is no longer the case, as the refresh functionality is handled by react-query.</p>

<p>If you relied on <code class="language-plaintext highlighter-rouge">useVersion</code> to provide a component key, you can safely remove the call. The refresh button will force all components relying on a dataProvider query to re-execute.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useVersion } from 'react-admin';
</span>
const MyComponent = () =&gt; {
<span class="gd">-   const version = useVersion();
</span>    return (
<span class="gd">-       &lt;Card key={version}&gt;
</span><span class="gi">+       &lt;Card&gt;
</span>            ...
        &lt;/Card&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<p>And if you relied on a <code class="language-plaintext highlighter-rouge">version</code> prop to be available in a page context, you can safely remove it.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import { useShowContext } from 'react-admin';
</span>
const PostDetail = () =&gt; {
<span class="gd">-   const { data, version } = useShowContext();
</span><span class="gi">+   const { data } = useShowContext();
</span>    return (
<span class="gd">-       &lt;Card key={version}&gt;
</span><span class="gi">+       &lt;Card&gt;
</span>            ...
        &lt;/Card&gt;
    );
<span class="err">}</span>
</code></pre></div></div>

<h3 id="useredirect-no-longer-clears-forms-when-called-with-false"><code class="language-plaintext highlighter-rouge">useRedirect()</code> No Longer Clears Forms When Called With <code class="language-plaintext highlighter-rouge">false</code></h3>

<p>To implement a form that would reset after submittion and allow adding more data, react-admin used to encourage you to call <code class="language-plaintext highlighter-rouge">useRedirect()</code> with <code class="language-plaintext highlighter-rouge">false</code> to clear the form. This no longer works: <code class="language-plaintext highlighter-rouge">useRedirect()</code> manages redirections, not forms. You’ll have to clear the form manually in your side effect:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { useNotify, useRedirect } from 'react-admin';
</span><span class="gi">+import { useNotify } from 'react-admin';
+import { useFormContext } from 'react-hook-form';
</span>
const PostCreateToolbar = props =&gt; {
    const notify = useNotify();
<span class="gd">-   const redirect = useRedirect();
</span><span class="gi">+   const { reset } = useFormContext();
</span>
    return (
        &lt;Toolbar {...props}&gt;
<span class="gd">-           &lt;SaveButton label="Save" /&gt;
</span>            &lt;SaveButton
                label="Save and add"
                type="button"
                mutationOptions={{
                    onSuccess: () =&gt; {
<span class="gd">-                       redirect(false);
</span><span class="gi">+                       reset();
+                       window.scrollTo(0, 0);
</span>                        notify('ra.notification.created', {
                            type: 'info',
                            messageArgs: { smart_count: 1 },
                        });
                    },
                }}
            /&gt;
        &lt;/Toolbar&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<h3 id="no-more-props-injection-in-title">No More Props Injection In <code class="language-plaintext highlighter-rouge">&lt;Title&gt;</code></h3>

<p><code class="language-plaintext highlighter-rouge">&lt;Title&gt;</code> no longer clones the <code class="language-plaintext highlighter-rouge">title</code> prop and injects it to the <code class="language-plaintext highlighter-rouge">record</code>. Call the <code class="language-plaintext highlighter-rouge">useRecordContext</code> hook to get the current record.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-const PostTitle = ({ record }) =&gt; {
-const PostTitle = () =&gt; {
</span><span class="gi">+    const record = useRecordContext();
</span>    return &lt;span&gt;Post {record ? `"${record.title}"` : ''}&lt;/span&gt;;
<span class="err">};</span>

<span class="p">export const PostEdit = () =&gt; (
</span>    &lt;Edit title={&lt;PostTitle /&gt;}&gt;
        ...
    &lt;/Edit&gt;
<span class="err">);</span>
</code></pre></div></div>

<p>Use the <code class="language-plaintext highlighter-rouge">&lt;Title&gt;</code> component instead.</p>

<h3 id="removed-deprecated-elements">Removed Deprecated Elements</h3>

<ul>
  <li>Removed <code class="language-plaintext highlighter-rouge">&lt;BulkDeleteAction&gt;</code> (use <code class="language-plaintext highlighter-rouge">&lt;BulkDeleteButton&gt;</code> instead)</li>
  <li>Removed <code class="language-plaintext highlighter-rouge">&lt;ReferenceFieldController&gt;</code> (use <a href="./useGetOne.md#aggregating-getone-calls"><code class="language-plaintext highlighter-rouge">useReference</code></a> instead)</li>
  <li>Removed <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayFieldController&gt;</code> (use <code class="language-plaintext highlighter-rouge">useReferenceArrayFieldController</code> instead)</li>
  <li>Removed <code class="language-plaintext highlighter-rouge">&lt;ReferenceManyFieldController&gt;</code> (use <code class="language-plaintext highlighter-rouge">useReferenceManyFieldController</code> instead)</li>
  <li>Removed <code class="language-plaintext highlighter-rouge">&lt;ReferenceInputController&gt;</code> (use <code class="language-plaintext highlighter-rouge">useReferenceInputController</code> instead)</li>
  <li>Removed <code class="language-plaintext highlighter-rouge">&lt;ReferenceArrayInputController&gt;</code> (use <code class="language-plaintext highlighter-rouge">useReferenceArrayInputController</code> instead)</li>
  <li>Removed declarative side effects in dataProvider hooks (e.g. <code class="language-plaintext highlighter-rouge">{ onSuccess: { refresh: true } }</code>). Use function side effects instead (e.g. <code class="language-plaintext highlighter-rouge">{ onSuccess: () =&gt; { refresh(); } }</code>)</li>
  <li>Removed <code class="language-plaintext highlighter-rouge">&lt;CardActions&gt;</code> (use <code class="language-plaintext highlighter-rouge">&lt;TopToolbar&gt;</code> instead)</li>
</ul>

<h3 id="removed-deprecated-props">Removed Deprecated Props</h3>

<ul>
  <li>Removed <code class="language-plaintext highlighter-rouge">&lt;ReferenceField linkType&gt;</code> prop (use <code class="language-plaintext highlighter-rouge">&lt;ReferenceField link&gt;</code> instead)</li>
</ul>

<h3 id="removed-deprecated-hocs">Removed Deprecated HOCs</h3>

<ul>
  <li>Removed <code class="language-plaintext highlighter-rouge">withTranslate</code> HOC (use <code class="language-plaintext highlighter-rouge">useTranslate</code> hook)</li>
  <li>Removed <code class="language-plaintext highlighter-rouge">withDataProvider</code> HOC (use <code class="language-plaintext highlighter-rouge">useDataProvider</code> hook)</li>
</ul>

<h3 id="edit-successmessage-prop-was-removed"><code class="language-plaintext highlighter-rouge">&lt;Edit successMessage&gt;</code> Prop Was Removed</h3>

<p>This prop has been deprecated for a long time. Replace it with a custom success handler in the <code class="language-plaintext highlighter-rouge">mutationOptions</code>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Edit, SimpleForm } from 'react-admin';
</span><span class="gi">+import { Edit, SimpleForm, useNotify } from 'react-admin';
</span>
const PostEdit = () =&gt; {
<span class="gi">+   const notify = useNotify();
+   const onSuccess = () =&gt; notify('Post updated successfully');
</span>    return (
<span class="gd">-       &lt;Edit successMessage="Post updated successfully"&gt;
</span><span class="gi">+       &lt;Edit mutationOptions={{ onSuccess }}&gt;
</span>            &lt;SimpleForm&gt;
                ...
            &lt;/SimpleForm&gt;
        &lt;/Edit&gt;
    );
<span class="err">};</span>
</code></pre></div></div>

<h2 id="typescript">TypeScript</h2>

<h3 id="record-was-renamed-to-rarecord"><code class="language-plaintext highlighter-rouge">Record</code> Was Renamed To <code class="language-plaintext highlighter-rouge">RaRecord</code></h3>

<p>Data Provider methods used to return records with a generic <code class="language-plaintext highlighter-rouge">Record</code> type, unless you were passing an explicit type. The <code class="language-plaintext highlighter-rouge">Record</code> type conflicted with TypeScript’s native <code class="language-plaintext highlighter-rouge">Record</code> type and sometimes confused IDEs.</p>

<p>We’ve renamed that type to <code class="language-plaintext highlighter-rouge">RaRecord</code> to avoid any confusion.</p>

<p>If you’ve declared custom Record types, you’ll need to upgrade your code as follows:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { Record } from 'react-admin';
</span><span class="gi">+import { RaRecord } from 'react-admin';
</span>
-export interface Customer extends Record {
<span class="gi">+export interface Customer extends RaRecord {
</span>    id: string;
    name: string;
    email: string;
<span class="err">}</span>
</code></pre></div></div>

<h2 id="tests">Tests</h2>

<h3 id="ra-test-has-been-removed"><code class="language-plaintext highlighter-rouge">ra-test</code> Has Been Removed</h3>

<p>You no longer need a special package to unit test your components. The <code class="language-plaintext highlighter-rouge">react-admin</code> package provides all you need.</p>

<p>If you used <code class="language-plaintext highlighter-rouge">TestContext</code> from ‘ra-test’, use <code class="language-plaintext highlighter-rouge">AdminContext</code> instead:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import React from 'react';
</span><span class="gd">-import { TestContext } from 'ra-test';
</span><span class="gi">+import { AdminContext } from 'react-admin';
</span><span class="p">import { render, screen } from '@testing-library/react';
</span>
import MyComponent from './MyComponent';

test('&lt;MyComponent&gt;', async () =&gt; {
    render(
<span class="gd">-       &lt;TestContext&gt;
</span><span class="gi">+       &lt;AdminContext&gt;
</span>            &lt;MyComponent /&gt;
<span class="gd">-       &lt;/TestContext&gt;
</span><span class="gi">+       &lt;/AdminContext&gt;
</span>    );
    const items = await screen.findAllByText(/Item #[0-9]: /)
    expect(items).toHaveLength(10)
<span class="err">})</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">&lt;AdminContext&gt;</code> accepts the same props as <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code>, so you can pass a custom <code class="language-plaintext highlighter-rouge">dataProvider</code>, <code class="language-plaintext highlighter-rouge">authProvider</code>, or <code class="language-plaintext highlighter-rouge">i18nProvider</code> for testing purposes.</p>

<p>For instance, if the component to test calls the <code class="language-plaintext highlighter-rouge">useGetOne</code> hook:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AdminContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">render</span><span class="p">,</span> <span class="nx">screen</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@testing-library/react</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">MyComponent</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./MyComponent</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;MyComponent&gt;</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">AdminContext</span> <span class="na">dataProvider</span><span class="p">=</span><span class="si">{</span><span class="p">{</span>
            <span class="na">getOne</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">({</span> <span class="na">data</span><span class="p">:</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span> <span class="p">}</span> <span class="p">}),</span>
        <span class="p">}</span><span class="si">}</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nc">MyComponent</span> <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nc">AdminContext</span><span class="p">&gt;</span>
    <span class="p">);</span>
    <span class="kd">const</span> <span class="nx">items</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">findAllByText</span><span class="p">(</span><span class="sr">/Item #</span><span class="se">[</span><span class="sr">0-9</span><span class="se">]</span><span class="sr">: /</span><span class="p">)</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">items</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<p>If you used <code class="language-plaintext highlighter-rouge">renderWithRedux</code> from ‘ra-test’, replace it with react-testing-library’s <code class="language-plaintext highlighter-rouge">render</code>, and use <code class="language-plaintext highlighter-rouge">AdminContext</code> as a wrapper:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">import React from 'react';
</span><span class="gd">-import { renderWithRedux } from 'ra-test';
</span><span class="gi">+import { AdminContext } from 'react-admin';
</span><span class="p">import { render, screen } from '@testing-library/react';
</span>
import MyComponent from './MyComponent';

test('&lt;MyComponent&gt;', async () =&gt; {
<span class="gd">-   renderWithRedux(
</span><span class="gi">+   render(
+       &lt;AdminContext&gt;
</span>            &lt;MyComponent /&gt;
<span class="gi">+       &lt;/AdminContext&gt;
</span>    );
    const items = await screen.findAllByText(/Item #[0-9]: /)
    expect(items).toHaveLength(10)
<span class="err">})</span>
</code></pre></div></div>

<p>If you used <code class="language-plaintext highlighter-rouge">renderHook</code> from ‘ra-test’, replace it with <a href="https://react-hooks-testing-library.com/">react-testing-library’s <code class="language-plaintext highlighter-rouge">renderHook</code></a>:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-import { renderHook } from 'ra-test'
</span><span class="gi">+import { renderHook } from '@testing-library/react-hooks'
</span><span class="p">import useCounter from './useCounter'
</span>
test('should use counter', () =&gt; {
<span class="gd">-   const { hookValue } = renderHook(() =&gt; useCounter())
</span><span class="gi">+   const { result } = renderHook(() =&gt; useCounter())
</span>
-   expect(hookValue.count).toBe(0)
<span class="gi">+   expect(result.current.count).toBe(0)
</span><span class="err">})</span>
</code></pre></div></div>

<h3 id="unit-tests-for-data-provider-dependent-components-need-a-queryclientcontext">Unit Tests for Data Provider Dependent Components Need A QueryClientContext</h3>

<p>If you were using components dependent on the dataProvider hooks in isolation (e.g. in unit or integration tests), you now need to wrap them inside a <code class="language-plaintext highlighter-rouge">&lt;QueryClientContext&gt;</code> component, to let the access react-query’s <code class="language-plaintext highlighter-rouge">QueryClient</code> instance.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gi">+import { QueryClientProvider, QueryClient } from 'react-query';
</span>
// this component relies on dataProvider hooks
<span class="p">const BookDetail = ({ id }) =&gt; {
</span>    const { data, error, isLoading } = useGetOne('books', { id });
    if (isLoading) {
        return &lt;Loading /&gt;;
    }
    if (error) {
        return &lt;Error error={error} /&gt;;
    }
    if (!data) {
        return null;
    }
    return (
        &lt;div&gt;
            &lt;h1&gt;{data.book.title}&lt;/h1&gt;
            &lt;p&gt;{data.book.author.name}&lt;/p&gt;
        &lt;/div&gt;
    );
<span class="err">};</span>

<span class="p">test('MyComponent', () =&gt; {
</span>    render(
<span class="gi">+       &lt;QueryClientProvider client={new QueryClient()}&gt;
</span>            &lt;BookDetail id={1} /&gt;
<span class="gi">+       &lt;/QueryClientProvider&gt;
</span>    );
    // ...
<span class="err">});</span>
</code></pre></div></div>

                        </div>
                    </div>
                    <div class="col hide-on-small-only m3 toc-container">
                        <div class="toc"></div>
                    </div>
                </div>
            </div>
        </main>

        <script src="/js/materialize.min.js"></script>
        <script src="/js/prism.js"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.min.js"
            defer
            integrity="sha512-oD3xGN8YTxenx6tdS4D/RKqO4OtORBQtAb2/FseM17GGMIi6jMwKUBc8duX4A5RwMOGGXoFBZrsqbOk8GpXFgQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <script src="/js/ra-doc-exec.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
        
        <script type="text/javascript">
            docsearch({
                container: '#docsearch',
                appId: 'QY9T9CVM2N',
                indexName: 'marmelab-react-admin',
                apiKey: '75332227370be3dc35777cee6244881a',
                searchParameters: { facetFilters: ['version:  latest'] },
            });
        </script>

        <!--
        React-admin protects your privacy!
        We use our own self-hosted tracking solution to collect some raw metrics,
        like page views, device type (mobile, desktop, etc.) or country.
        We don't track any personal information about our visitors.
    -->
        <script
            async
            defer
            data-website-id="ef7f8242-2808-4cbf-9dff-564daa515bbd"
            src="https://analytics.marmelab.com/umami.js"
        ></script>

        <!-- Newsletter form -->
        <script>
            window.REQUIRED_CODE_ERROR_MESSAGE = 'Please choose a country code';
            window.LOCALE = 'en';
            window.GENERIC_INVALID_MESSAGE = window.EMAIL_INVALID_MESSAGE = window.SMS_INVALID_MESSAGE =
                'The information provided is invalid. Please review the field format and try again.';
            window.REQUIRED_ERROR_MESSAGE = 'This field is required.';

            var AUTOHIDE = Boolean(0);
        </script>

        <script
            async
            defer
            src="https://unpkg.com/typescript@5.1.3/lib/typescript.js"
        ></script>
        <script
            async
            defer
            src="https://unpkg.com/prettier@2.8.8/standalone.js"
        ></script>
        <script
            async
            defer
            src="https://unpkg.com/prettier@2.8.8/parser-babel.js"
        ></script>
    </body>
</html>
